{
    "version": "https://jsonfeed.org/version/1",
    "title": "ä¸‰åƒç¾Šæ¯›",
    "subtitle": "ä»¥å·±ä¸ºå‰‘ æ–©å°½è¯¸é™©",
    "icon": "https://to-ywz.github.io/images/favicon.ico",
    "description": "ç¬”è®°&åˆ†äº«",
    "home_page_url": "https://to-ywz.github.io",
    "items": [
        {
            "id": "https://to-ywz.github.io/tool/VSCode%E4%BD%BF%E7%94%A8%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95/",
            "url": "https://to-ywz.github.io/tool/VSCode%E4%BD%BF%E7%94%A8%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95/",
            "title": "VSCodeä½¿ç”¨é—®é¢˜è®°å½•",
            "date_published": "2023-07-11T09:59:07.000Z",
            "content_html": "<h4 id=\"å†™åœ¨å‰é¢\"><a class=\"anchor\" href=\"#å†™åœ¨å‰é¢\">#</a> å†™åœ¨å‰é¢</h4>\n<p>è¿™ç¯‡åšå®¢ç”¨äºè®°å½•æˆ‘ä½¿ç”¨ vscode è¿‡ç¨‹ä¸­å‡ºç°çš„é—®é¢˜ï¼Œä»¥åŠè§£å†³æ–¹æ³•<br />\nå¹çˆ† vscode</p>\n<h2 id=\"bracket-pair-colorizer-2-ä¸ç»´æŠ¤\"><a class=\"anchor\" href=\"#bracket-pair-colorizer-2-ä¸ç»´æŠ¤\">#</a> Bracket Pair Colorizer 2 ä¸ç»´æŠ¤</h2>\n<p>ä»Šå¤©æ‰“å¼€æˆ‘çš„ç”Ÿäº§åŠ›çš„æ—¶å€™å‘ç°ï¼Œä¸€å¤§å †æ’ä»¶è¦æ›´æ–° (å¿™äºå…¶å®ƒäº‹æƒ…ï¼Œä¸€ç›´æ²¡ç”¨è¿™å°ç”µè„‘), çªç„¶å°±å‘ç°  <code>Bracket Pair Colorizer 2</code>  å®ƒä¸ç»´æŠ¤äº†<br />\nè¢«åˆ’äº†åˆ é™¤çº¿ï¼Œæ’ä»¶å›¾æ ‡éƒ½å˜ç°äº†<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.7hrpunjly9c0.webp\" alt=\"image\" /><br />\n è¿™ä¸ªæ’ä»¶å¯ä»¥æŠŠä¸åŒåµŒå¥—å±‚çº§çš„å„ç§ç±»å‹çš„æ‹¬å·ï¼Œç”¨ä¸åŒçš„é¢œè‰²æ ‡æ³¨å‡ºæ¥<br />\n (âŠ™oâŠ™)ï¼Ÿæˆ‘å’Œæ—¶ä»£è„±è½¨äº†ï¼Œè¿™å¯æ˜¯ VSCode å¿…è£…çš„ç¥çº§æ’ä»¶å•Šï¼Œå±…ç„¶ä¸ç»´æŠ¤äº†ï¼æ²¡å¤©ç†äº†å•Š</p>\n<p>æˆ‘å»äº†å®˜ç½‘ä¹‹åå‘ç°ï¼Œä¸ç»´æŠ¤çš„åŸå› æ˜¯ VSCode å†…ç½®äº†è¿™ä¸ªåŠŸèƒ½ï¼Œè¿™é‡Œæ˜¯ä½œè€…åŸè¯</p>\n<blockquote>\n<p>This project started on 3 Dec 2016. Now 5 years later, <strong>it has become a native feature in VSCode.</strong></p>\n<p>This extension has seen wilder success then I could over ever dreamed of, with over 10M+ downloads.</p>\n<p>I'm glad so many people found it useful, however it no longer has a purpose entering 2022 so development will no longer continue.</p>\n<p>If you enjoyed it, a coffee donation is appreciated:</p>\n<p>ğŸ <span class=\"exturl\" data-url=\"aHR0cHM6Ly9rby1maS5jb20vYnJhY2tldHBhaXJjb2xvcml6ZXI=\">Donate</span> ğŸ</p>\n</blockquote>\n<p>å¤§è‡´æ„æ€å°±æ˜¯è‡´è°¢ç„¶åè¯´ä¸å†ç»´æŠ¤ï¼Œç„¶åé‡ç‚¹æ˜¯æˆ‘åŠ ç²—çš„é‚£å¥ &quot;å·²ç»æˆä¸ºå†…éƒ¨åŠŸèƒ½&quot;, å¹¶ä¸”ä½œè€…ä¹Ÿç»™å‡ºäº†å¦‚ä½•å¼€å¯å†…éƒ¨æ‹¬å·åŒ¹é…çš„æ–¹æ³•</p>\n<h3 id=\"è§£å†³æ–¹æ³•\"><a class=\"anchor\" href=\"#è§£å†³æ–¹æ³•\">#</a> è§£å†³æ–¹æ³•</h3>\n<p>åœ¨ setting.json æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç </p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token property\">\"editor.bracketPairColorization.enabled\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token property\">\"editor.guides.bracketPairs\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"active\"</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>å½“ç„¶ï¼Œæ·»åŠ åˆ°å…¨å±€çš„ setting æ–‡ä»¶ä¸­è‚¯å®šæ¯”è¾ƒå¥½ä¸€äº›<br />\n ---------2022 å¹´ 11 æœˆ -----------------</p>\n<h2 id=\"è®¾ç½®é»˜è®¤ç»ˆç«¯\"><a class=\"anchor\" href=\"#è®¾ç½®é»˜è®¤ç»ˆç«¯\">#</a> è®¾ç½®é»˜è®¤ç»ˆç«¯</h2>\n<p>ä¸€èˆ¬æ¥è¯´ï¼Œæ–°å»ºçš„ç»ˆç«¯éƒ½ä¼šæ˜¯ powershell, ä½†æ˜¯åœ¨ä½¿ç”¨ makfile çš„æ—¶å€™æˆ‘è¿˜æ˜¯æ›´å–œæ¬¢ä½¿ç”¨ git bash</p>\n<p>ä½†æ¯æ¬¡éƒ½éœ€è¦é€šè¿‡ç‚¹  <code>+</code>  æ—è¾¹çš„æ›´å¤šç¬¦å·æ‰‹åŠ¨é€‰æ‹© git bash å°±å¾ˆä¸çˆ½</p>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.12pa5ujcgzkw.jpg\" alt=\"image\" /></p>\n<p>ä¸ºäº†åœ¨å¿«æ·é”®å”¤å‡ºçš„ç»ˆç«¯å°±æ˜¯ git bash, è¿™å°±éœ€è¦æ¶‰åŠåˆ°ä¿®æ”¹é»˜è®¤ç»ˆç«¯</p>\n<p>å¾ˆç®€å•ï¼Œåœ¨  <code>.vsocde</code>  æ–°å»ºä¸€ä¸ª  <code>settings.json</code>  æ–‡ä»¶ (å¦‚æœæœ‰åˆ™ä¸ç”¨)</p>\n<p>ç„¶åæ·»åŠ ä¸‹é¢è¿™æ®µä»£ç å³å¯</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token property\">\"terminal.integrated.defaultProfile.windows\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Git Bash\"</span></pre></td></tr></table></figure><p>è¦æ³¨æ„çš„æ˜¯ï¼Œä¸‹é¢è¿™ä¸ªé…ç½®é€‰é¡¹å·²ç»è¢« VSCode åºŸå¼ƒäº†ï¼Œå¦‚æœæ‰¾åšå®¢å‘ç°äº†è¿™ä¸ªæ¨èåæœ‰å…«ä¹å°±æ˜¯è¿‡æ—¶å•¦</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token property\">\"terminal.integrated.shell.windows\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"D:/Git/bin/bash.exe\"</span><span class=\"token punctuation\">,</span></pre></td></tr></table></figure><p>---------2023 å¹´ 7 æœˆ -----------------</p>\n<hr />\n<p>å¤§é“äº”åï¼Œå¤©è¡å››åä¹ï¼Œäººéå…¶ä¸€ï¼</p>\n",
            "tags": [
                "å¼€å‘å·¥å…·",
                "VSCode",
                "VScode"
            ]
        },
        {
            "id": "https://to-ywz.github.io/English/2006%E5%B9%B4%E8%8B%B1%E8%AF%AD%E7%9C%9F%E9%A2%98/",
            "url": "https://to-ywz.github.io/English/2006%E5%B9%B4%E8%8B%B1%E8%AF%AD%E7%9C%9F%E9%A2%98/",
            "title": "2006å¹´è‹±è¯­çœŸé¢˜",
            "date_published": "2023-07-10T23:51:33.000Z",
            "content_html": "<h1 id=\"text1\"><a class=\"anchor\" href=\"#text1\">#</a> TEXT1</h1>\n<p>ä¸»è¯­: <ins>ä¸»è¯­</ins><br />\nè°“è¯­: <ins class=\"dot warning\">è°“è¯­</ins><br />\nå®¾è¯­: <ins class=\"wavy\">å®¾è¯­</ins><br />\nå®šè¯­: <mark>å®šè¯­</mark><br />\nçŠ¶è¯­: <ins class=\"primary\">çŠ¶è¯­</ins></p>\n<h2 id=\"æ®µè½1\"><a class=\"anchor\" href=\"#æ®µè½1\">#</a> æ®µè½ 1</h2>\n<h3 id=\"è¯­å¥1\"><a class=\"anchor\" href=\"#è¯­å¥1\">#</a> è¯­å¥ 1</h3>\n<p>In spite of &quot;endless talk of difference&quot;, American society is an amazing machine for homogenizing people.</p>\n<h4 id=\"è¯­æ³•\"><a class=\"anchor\" href=\"#è¯­æ³•\">#</a> è¯­æ³•</h4>\n<p><ins class=\"primary\">In spite of &quot;endless talk of difference&quot;</ins>, <ins>American society</ins> <ins class=\"dot warning\">is</ins> <ins class=\"wavy\">an amazing machine</ins> <mark>for homogenizing</mark> people.</p>\n<p>çŠ¶è¯­: In spite of &quot;endless talk of difference&quot;<br />\n ä¸»è¯­: society<br />\n è°“è¯­:  is<br />\n å®¾è¯­: machine</p>\n<h4 id=\"è¯æ±‡\"><a class=\"anchor\" href=\"#è¯æ±‡\">#</a> è¯æ±‡</h4>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">è¯æ±‡</th>\n<th style=\"text-align:left\">è¯æ€§</th>\n<th style=\"text-align:left\">ä¸­æ–‡</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">in spite of</td>\n<td style=\"text-align:left\">phere</td>\n<td style=\"text-align:left\">è™½ç„¶â€¦â€¦ ä½†æ˜¯</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">homogenizing</td>\n<td style=\"text-align:left\">v</td>\n<td style=\"text-align:left\">ä½¿.. å‡åŒ€ï¼›ä½¿.. ç»Ÿä¸€</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"ç¿»è¯‘\"><a class=\"anchor\" href=\"#ç¿»è¯‘\">#</a> ç¿»è¯‘</h4>\n<p>è™½ç„¶ &quot;å·®å¼‚çš„äº‰è®ºæ°¸æ— æ­¢å¢ƒ&quot;, ä½†æ˜¯ç¾å›½ç¤¾ä¼šæ˜¯ä¸€ä¸ªåŒåŒ–äººçš„å¥‡è¿¹æœºå™¨.</p>\n<h4 id=\"æ ‡å‡†ç¿»è¯‘\"><a class=\"anchor\" href=\"#æ ‡å‡†ç¿»è¯‘\">#</a> æ ‡å‡†ç¿»è¯‘</h4>\n<p>å°½ç®¡ï¼Œâ€œäººä»¬æ— ä¼‘æ­¢åœ°è°ˆè®ºç¾å›½ç¤¾ä¼šçš„å·®å¼‚â€ï¼Œä½†æ˜¯ï¼Œç¾å›½ç¤¾ä¼šæ˜¯ä¸€å°å°†äººä»¬éƒ½åŒåŒ–çš„ç¥å¥‡æœºå™¨</p>\n<h3 id=\"è¯­å¥2\"><a class=\"anchor\" href=\"#è¯­å¥2\">#</a> è¯­å¥ 2</h3>\n<p>There is â€œthe democratizing uniformity of dress and discourse, and the casualness and absence of deferenceâ€ characteristic of popular culture.</p>\n<h4 id=\"è¯­æ³•-2\"><a class=\"anchor\" href=\"#è¯­æ³•-2\">#</a> è¯­æ³•</h4>\n<p><ins>There</ins> <ins class=\"dot warning\">is</ins> â€œ<mark>the democratizing uniformity of</mark> dress and discourse, and <mark>the casualness and absence of</mark> deferenceâ€ <mark>characteristic of</mark> <ins class=\"wavy\">popular culture</ins>.</p>\n<p>ä¸»è¯­: There<br />\n è°“è¯­: is<br />\n å®¾è¯­: culture</p>\n<h4 id=\"è¯æ±‡-2\"><a class=\"anchor\" href=\"#è¯æ±‡-2\">#</a> è¯æ±‡</h4>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">è¯æ±‡</th>\n<th style=\"text-align:left\">è¯æ€§</th>\n<th style=\"text-align:left\">ä¸­æ–‡</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">dress</td>\n<td style=\"text-align:left\">n</td>\n<td style=\"text-align:left\">æœè£…</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">democratizing</td>\n<td style=\"text-align:left\">v</td>\n<td style=\"text-align:left\">ä½¿... æ°‘ä¸»åŒ–</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">uniform</td>\n<td style=\"text-align:left\">n</td>\n<td style=\"text-align:left\">æ ¡æœï¼›åˆ¶æœï¼›</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">adj</td>\n<td style=\"text-align:left\">ç»Ÿä¸€çš„ï¼›ä¸€æ ·çš„</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">uniformity</td>\n<td style=\"text-align:left\">n</td>\n<td style=\"text-align:left\">ç»Ÿä¸€æ€§ï¼›ä¸€è‡´ï¼›ä¸€æ ·</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">discourse</td>\n<td style=\"text-align:left\">n</td>\n<td style=\"text-align:left\">è°ˆè¯ï¼›è¯è¯­</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">casualness</td>\n<td style=\"text-align:left\">n</td>\n<td style=\"text-align:left\">éšæ„ï¼›æ¼«ä¸ç»å¿ƒï¼›å¶ç„¶</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">absence</td>\n<td style=\"text-align:left\">n</td>\n<td style=\"text-align:left\">ç¼ºå¸­ï¼›ä¸å­˜åœ¨</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">in the absence of</td>\n<td style=\"text-align:left\">phere</td>\n<td style=\"text-align:left\">ï¼ˆäººï¼‰ä¸åœ¨æ—¶</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"ç¿»è¯‘-2\"><a class=\"anchor\" href=\"#ç¿»è¯‘-2\">#</a> ç¿»è¯‘</h4>\n<p>è¿™é‡Œçš„æµè¡Œæ–‡åŒ–æµè¡Œæ–‡åŒ–é‡Œæœ‰ï¼Œæœè£…å’Œè°ˆè¯çš„ä¸€æ ·çš„æ°‘ä¸»åŒ–å’Œç»Ÿä¸€æ€§ï¼Œæ¾æ•£ä¸”ç¼ºå°‘ä¸åŒ</p>\n<h4 id=\"æ ‡å‡†ç¿»è¯‘-2\"><a class=\"anchor\" href=\"#æ ‡å‡†ç¿»è¯‘-2\">#</a> æ ‡å‡†ç¿»è¯‘</h4>\n<p>ç¾å›½ç¤¾ä¼šçš„æµè¡Œæ–‡åŒ–ä¸­ï¼Œæœ‰ç€æœè£…å’Œè¯è¯­ï¼ˆç”¨è¯­ï¼‰å¹³æ°‘åŒ–ã€ç»Ÿä¸€åŒ–ã€è‡ªç”±éšæ„å’Œä¸æ‹˜å°èŠ‚ç­‰ç‰¹ç‚¹ã€‚</p>\n<h3 id=\"è¯­å¥3\"><a class=\"anchor\" href=\"#è¯­å¥3\">#</a> è¯­å¥ 3</h3>\n<p>People are absorbed into &quot;a culture of consumption&quot; launched by the 19th-century department stores that offered &quot;vast arrays of goods in an elegant atmosphere.</p>\n<h4 id=\"è¯­æ³•-3\"><a class=\"anchor\" href=\"#è¯­æ³•-3\">#</a> è¯­æ³•</h4>\n<p><ins>People</ins> <ins>are absorbed into</ins>.{.dot .warning} &quot;a culture of consumption&quot; <ins class=\"wavy\">launched by the 19th-century department stores</ins> [that <ins class=\"dot warning\">offered</ins> <mark>vast arrays of</mark> goods in <ins class=\"wavy\">an elegant atmosphere</ins>].{aqua}.</p>\n<p>ä¸»è¯­: People<br />\n è°“è¯­: are absorbed into<br />\n å®¾è¯­: culture</p>\n<p>å®šä»: that offered &quot;vast arrays of goods in an elegant atmosphere</p>\n<h4 id=\"è¯æ±‡-3\"><a class=\"anchor\" href=\"#è¯æ±‡-3\">#</a> è¯æ±‡</h4>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">è¯æ±‡</th>\n<th style=\"text-align:left\">è¯æ€§</th>\n<th style=\"text-align:left\">ä¸­æ–‡</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">be absorbed into sth</td>\n<td style=\"text-align:left\">phere</td>\n<td style=\"text-align:left\">ä½¿å¹¶å…¥</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">vast array of</td>\n<td style=\"text-align:left\">phere</td>\n<td style=\"text-align:left\">å¤§é‡çš„ï¼›å¤šç§å¤šæ ·çš„</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">consumption</td>\n<td style=\"text-align:left\">n</td>\n<td style=\"text-align:left\">æ¶ˆè´¹</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">department stores</td>\n<td style=\"text-align:left\">n</td>\n<td style=\"text-align:left\">ç™¾è´§å•†åº—ï¼›ç™¾è´§å…¬å¸</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"ç¿»è¯‘-3\"><a class=\"anchor\" href=\"#ç¿»è¯‘-3\">#</a> ç¿»è¯‘</h4>\n<p>äººä»¬ [å¸æ”¶æ¥è‡ª].{.red} ç™¾è´§å…¬å¸æ¨è¡Œçš„ä¸€ç§ &quot;æ¶ˆè´¹æ–‡åŒ–&quot;, åœ¨ä¸€ä¸ªä¼˜é›…çš„æ°›å›´ä¸‹æä¾›å¤§é‡çš„å•†å“.</p>\n<p><strong>åˆ†æ:</strong> be done ... by è¢«åŠ¨è¯­å¥</p>\n<h4 id=\"æ ‡å‡†ç¿»è¯‘-3\"><a class=\"anchor\" href=\"#æ ‡å‡†ç¿»è¯‘-3\">#</a> æ ‡å‡†ç¿»è¯‘</h4>\n<p>äººä»¬è¢« 19 ä¸–çºªç™¾è´§å…¬å¸æ‰€å¼€åˆ›çš„ â€œæ¶ˆè´¹æ–‡åŒ–â€ æ‰€å¸å¼•ï¼Œè¿™äº›ç™¾è´§å…¬å¸ â€œåœ¨è£…é¥°ä¼˜é›…çš„è´§æ¶ä¸Šï¼Œæä¾›äº†ç³ç…æ»¡ç›®çš„å•†å“â€ã€‚</p>\n<h3 id=\"è¯­å¥4\"><a class=\"anchor\" href=\"#è¯­å¥4\">#</a> è¯­å¥ 4</h3>\n<p>Instead of intimate shops catering to a knowledgeable elite,â€ these were stores â€œanyone could enter, regardless of class or background.</p>\n<h4 id=\"è¯­æ³•-4\"><a class=\"anchor\" href=\"#è¯­æ³•-4\">#</a> è¯­æ³•</h4>\n<p><ins class=\"primary\">Instead of intimate shops catering to a knowledgeable elite</ins>, <ins>these</ins> <ins>were</ins>++.{.dot .warning} +stores++{.wavy} [<ins>anyone</ins> <ins>could enter</ins>.{.dot .warming}, <mark>regardless of class or background</mark>].{aqua}.</p>\n<p>çŠ¶è¯­: Instead of intimate shops catering to a knowledgeable elit</p>\n<p>ä¸»å¥: these were stores</p>\n<ul>\n<li>ä¸»è¯­: these</li>\n<li>è°“è¯­: were</li>\n<li>å®¾è¯­: stores</li>\n</ul>\n<p>å®šä»: anyone could enter, regardless of class or background</p>\n<ul>\n<li>ä¸»è¯­: anyone</li>\n<li>è°“è¯­: could enter</li>\n<li>çŠ¶è¯­: regardless of class or background</li>\n</ul>\n<h4 id=\"è¯æ±‡-4\"><a class=\"anchor\" href=\"#è¯æ±‡-4\">#</a> è¯æ±‡</h4>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">è¯æ±‡</th>\n<th style=\"text-align:left\">è¯æ€§</th>\n<th style=\"text-align:left\">ä¸­æ–‡</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">intimate</td>\n<td style=\"text-align:left\">adj</td>\n<td style=\"text-align:left\">äº²å¯†çš„ï¼ˆæŒ‡èº«ä½“çš„æ¥è§¦ï¼‰ï¼›éšç§çš„ï¼›æ¸©é¦¨çš„ï¼›ç²¾é€šçš„ï¼›æš§æ˜§çš„</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">cater to</td>\n<td style=\"text-align:left\">phere</td>\n<td style=\"text-align:left\">è¿åˆ</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Instead of</td>\n<td style=\"text-align:left\">phere</td>\n<td style=\"text-align:left\">è€Œä¸æ˜¯</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">department stores</td>\n<td style=\"text-align:left\">n</td>\n<td style=\"text-align:left\">ç™¾è´§å•†åº—ï¼›ç™¾è´§å…¬å¸</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"ç¿»è¯‘-4\"><a class=\"anchor\" href=\"#ç¿»è¯‘-4\">#</a> ç¿»è¯‘</h4>\n<p>ä¸é‚£äº›è¿åˆçŸ¥è¯†æ¸Šåšçš„ç²¾è‹±é˜¶çº§çš„ [ç§äºº].{red} å•†åº—ä¸åŒï¼Œè¿™äº›ç™¾è´§å…¬å¸æ— è®ºä»€ä¹ˆèƒŒæ™¯å’Œé˜¶çº§éƒ½å¯ä»¥è¿›å…¥</p>\n<p>** åˆ†æ:** ä¸è¦å°‘ç¿»è¯‘å•è¯</p>\n<h4 id=\"æ ‡å‡†ç¿»è¯‘-4\"><a class=\"anchor\" href=\"#æ ‡å‡†ç¿»è¯‘-4\">#</a> æ ‡å‡†ç¿»è¯‘</h4>\n<p>ä¸é‚£äº›é¢å‘çŸ¥è¯†ç²¾è‹±çš„ç§äººå•†åº—ä¸åŒï¼Œè¿™äº›å•†åº—æ˜¯ä»»ä½•äººéƒ½å¯ä»¥è¿›å…¥çš„ï¼Œæ— è®ºä»–æ˜¯ä»»ä½•é˜¶çº§æˆ–èƒŒæ™¯çš„äºº</p>\n<h3 id=\"è¯­å¥-5\"><a class=\"anchor\" href=\"#è¯­å¥-5\">#</a> è¯­å¥ 5</h3>\n<p>This turned shopping into a public and democratic act.</p>\n<h4 id=\"è¯­æ³•-5\"><a class=\"anchor\" href=\"#è¯­æ³•-5\">#</a> è¯­æ³•</h4>\n<p><ins>This</ins> <ins>turned shopping into</ins>.{.dot .warming} <ins>a public and democratic act</ins>.{wavy}.</p>\n<ul>\n<li>ä¸»è¯­: This</li>\n<li>è°“è¯­: turned A into B</li>\n<li>å®¾è¯­: a public and democratic act</li>\n</ul>\n<h4 id=\"è¯æ±‡-5\"><a class=\"anchor\" href=\"#è¯æ±‡-5\">#</a> è¯æ±‡</h4>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">è¯æ±‡</th>\n<th style=\"text-align:left\">è¯æ€§</th>\n<th style=\"text-align:left\">ä¸­æ–‡</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">turn A into B</td>\n<td style=\"text-align:left\">phere</td>\n<td style=\"text-align:left\">æŠŠ A å˜æˆ B</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">democratic</td>\n<td style=\"text-align:left\">adj</td>\n<td style=\"text-align:left\">å¤§ä¼—çš„ï¼Œå°±æ˜¯ public çš„æ„æ€</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"ç¿»è¯‘-5\"><a class=\"anchor\" href=\"#ç¿»è¯‘-5\">#</a> ç¿»è¯‘</h4>\n<p>è¿™å°†è´­ç‰©è½¬æ¢ä¸ºå…¬å¼€çš„ï¼Œå¤§ä¼—çš„è¡Œä¸º</p>\n<h4 id=\"æ ‡å‡†ç¿»è¯‘-5\"><a class=\"anchor\" href=\"#æ ‡å‡†ç¿»è¯‘-5\">#</a> æ ‡å‡†ç¿»è¯‘</h4>\n<p>è¿™ä½¿å¾—è´­ç‰©æˆä¸ºä¸€ç§å…¬å¼€çš„ã€å¤§ä¼—çš„è¡Œä¸º</p>\n<h3 id=\"è¯­å¥-6\"><a class=\"anchor\" href=\"#è¯­å¥-6\">#</a> è¯­å¥ 6</h3>\n<p>The mass media, advertising and sports are other forces for homogenization.</p>\n<h4 id=\"è¯­æ³•-6\"><a class=\"anchor\" href=\"#è¯­æ³•-6\">#</a> è¯­æ³•</h4>\n<p><ins>The mass media, advertising and sports</ins> <ins>are</ins>.{.dot .warming} <ins>other forces</ins>.{wavy} <ins class=\"primary\">for homogenization</ins>.</p>\n<p>ä¸»è¯­: The mass media, advertising and sports<br />\n è°“è¯­: are<br />\n å®¾è¯­: other forces</p>\n<h4 id=\"è¯æ±‡-6\"><a class=\"anchor\" href=\"#è¯æ±‡-6\">#</a> è¯æ±‡</h4>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">è¯æ±‡</th>\n<th style=\"text-align:left\">è¯æ€§</th>\n<th style=\"text-align:left\">ä¸­æ–‡</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">intimate</td>\n<td style=\"text-align:left\">adj</td>\n<td style=\"text-align:left\">äº²å¯†çš„ï¼ˆæŒ‡èº«ä½“çš„æ¥è§¦ï¼‰ï¼›éšç§çš„ï¼›æ¸©é¦¨çš„ï¼›ç²¾é€šçš„ï¼›æš§æ˜§çš„</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">cater to</td>\n<td style=\"text-align:left\">phere</td>\n<td style=\"text-align:left\">è¿åˆ</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Instead of</td>\n<td style=\"text-align:left\">phere</td>\n<td style=\"text-align:left\">è€Œä¸æ˜¯</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">department stores</td>\n<td style=\"text-align:left\">n</td>\n<td style=\"text-align:left\">ç™¾è´§å•†åº—ï¼›ç™¾è´§å…¬å¸</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"ç¿»è¯‘-6\"><a class=\"anchor\" href=\"#ç¿»è¯‘-6\">#</a> ç¿»è¯‘</h4>\n<p>å¤§ä¼—åª’ä½“ï¼Œå¹¿å‘Šï¼Œè¿åŠ¨ éƒ½æ˜¯ä¸ºäº†åŒåŒ–çš„å…¶å®ƒåŠ›é‡</p>\n<h4 id=\"æ ‡å‡†ç¿»è¯‘-6\"><a class=\"anchor\" href=\"#æ ‡å‡†ç¿»è¯‘-6\">#</a> æ ‡å‡†ç¿»è¯‘</h4>\n<p>å¤§ä¼—åª’ä½“ã€å¹¿å‘Šå’Œä½“è‚²ä¹Ÿæ˜¯æ¨åŠ¨åŒåŒ–çš„å…¶ä»–åŠ›é‡</p>\n<h2 id=\"ç¬¬äºŒæ®µ\"><a class=\"anchor\" href=\"#ç¬¬äºŒæ®µ\">#</a> ç¬¬äºŒæ®µ</h2>\n<h3 id=\"è¯­å¥-1\"><a class=\"anchor\" href=\"#è¯­å¥-1\">#</a> è¯­å¥ 1</h3>\n<p>Immigrants are quickly fitting into this common culture, which may not be altogether elevating but is hardly poisonous.</p>\n<h4 id=\"è¯­æ³•-7\"><a class=\"anchor\" href=\"#è¯­æ³•-7\">#</a> è¯­æ³•</h4>\n<p><ins>Immigrants</ins> <ins>are quickly fitting into</ins>.{.dot .warming} <ins>this common culture</ins>.{.wavy}, [which may not be altogether elevating but is hardly poisonous].{.aqua}.</p>\n<p>çŠ¶è¯­: Immigrants are quickly fitting into this common culture,</p>\n<p>ä¸»å¥: Immigrants</p>\n<ul>\n<li>ä¸»è¯­: Immigrants</li>\n<li>è°“è¯­: are quickly fitting into</li>\n<li>å®¾è¯­: this common culture</li>\n</ul>\n<p>åŒä½è¯­: which may not be altogether elevating but is hardly poisonous</p>\n<ul>\n<li>ä¸»è¯­: Immigrants</li>\n<li>è°“è¯­: may not be; is</li>\n<li>çŠ¶è¯­: altogether elevating; poisonous</li>\n</ul>\n<h4 id=\"è¯æ±‡-7\"><a class=\"anchor\" href=\"#è¯æ±‡-7\">#</a> è¯æ±‡</h4>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">è¯æ±‡</th>\n<th style=\"text-align:left\">è¯æ€§</th>\n<th style=\"text-align:left\">ä¸­æ–‡</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">elevating</td>\n<td style=\"text-align:left\">adj</td>\n<td style=\"text-align:left\">æœ‰è¶£çš„ï¼›å‘äººæ·±çœçš„ï¼›å¯å‘çš„</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"ç¿»è¯‘-7\"><a class=\"anchor\" href=\"#ç¿»è¯‘-7\">#</a> ç¿»è¯‘</h4>\n<p>ç§»æ°‘è€…å¿«é€Ÿçš„èå…¥å¤§ä¼—æ–‡åŒ–ï¼Œå¯èƒ½æ²¡æœ‰æœ‰è¶£ä½†ä¹Ÿæ²¡æœ‰é‚£ä¹ˆæœ‰å®³</p>\n<h4 id=\"æ ‡å‡†ç¿»è¯‘-7\"><a class=\"anchor\" href=\"#æ ‡å‡†ç¿»è¯‘-7\">#</a> æ ‡å‡†ç¿»è¯‘</h4>\n<p>ç§»æ°‘ä»¬å¾ˆå¿«å°±èå…¥äº†è¿™ç§å…±åŒçš„æ–‡åŒ–ï¼Œè¿™ç§æ–‡åŒ–ä¹Ÿè®¸æ²¡æœ‰é‚£ä¹ˆé«˜å°šï¼Œä½†ä¹Ÿæ²¡æœ‰é‚£ä¹ˆæœ‰å®³ã€‚</p>\n<h3 id=\"è¯­å¥-2\"><a class=\"anchor\" href=\"#è¯­å¥-2\">#</a> è¯­å¥ 2</h3>\n<p>Writing for the National Immigration Forum, Gregory Rodriguez reports that today's immigration is neither at unprecedented levels nor resistant to assimilation</p>\n<h4 id=\"è¯­æ³•-8\"><a class=\"anchor\" href=\"#è¯­æ³•-8\">#</a> è¯­æ³•</h4>\n<p class=\"red\"><ins class=\"primary\">Writing for the National Immigration Forum,</ins><br />\n<ins>Gregory Rodriguez</ins> <ins>reports</ins>.{.dot .warming}<br />\n[that <ins>today's immigration</ins> <ins>is</ins>.{.dot .warming} neither at unprecedented levels nor resistant to assimilation].</p>\n<p>çŠ¶è¯­: Writing for the National Immigration Forum</p>\n<p>ä¸»å¥: Gregory Rodriguez reports</p>\n<ul>\n<li>ä¸»è¯­: Gregory Rodriguez</li>\n<li>è°“è¯­: reports</li>\n</ul>\n<p>å®¾ä»:  that today's immigration is neither at unprecedented levels nor resistant to assimilation</p>\n<ul>\n<li>ä¸»è¯­: today's immigration</li>\n<li>è°“è¯­: is</li>\n<li>çŠ¶è¯­: neither at unprecedented levels nor resistant to assimilation</li>\n</ul>\n<h4 id=\"è¯æ±‡-8\"><a class=\"anchor\" href=\"#è¯æ±‡-8\">#</a> è¯æ±‡</h4>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">è¯æ±‡</th>\n<th style=\"text-align:left\">è¯æ€§</th>\n<th style=\"text-align:left\">ä¸­æ–‡</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">unprecedented</td>\n<td style=\"text-align:left\">adj</td>\n<td style=\"text-align:left\">å²æ— å‰ä¾‹çš„</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">resistant</td>\n<td style=\"text-align:left\">phere</td>\n<td style=\"text-align:left\">è¿åˆ</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">neither...nor...</td>\n<td style=\"text-align:left\">phere</td>\n<td style=\"text-align:left\">ï¼šæ—¢ä¸... ä¹Ÿä¸...</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"ç¿»è¯‘-8\"><a class=\"anchor\" href=\"#ç¿»è¯‘-8\">#</a> ç¿»è¯‘</h4>\n<p>å¦‚å›½å®¶ç§»æ°‘å±€æ‰€å†™çš„ï¼Œä¹”æ ¼é‡Œãƒ»ç½—å¾·ç‘æ–¯ æŠ¥é“çš„ï¼Œå¦‚ä»Šçš„ç§»æ°‘æ—¢ä¸æ˜¯ç©ºå‰çš„æ°´å¹³ä¹Ÿä¸æ²¡æœ‰æŠµæŠ—åŒåŒ–</p>\n<p><strong>åˆ†æ:</strong> ving + for è¡¨ç›®çš„ï¼ŒçŠ¶è¯­</p>\n<h4 id=\"æ ‡å‡†ç¿»è¯‘-8\"><a class=\"anchor\" href=\"#æ ‡å‡†ç¿»è¯‘-8\">#</a> æ ‡å‡†ç¿»è¯‘</h4>\n<p>ä¸ºå›½å®¶ç§»æ°‘è®ºå›æ’°æ–‡çš„æ ¼é›·æˆˆé‡Œãƒ»ç½—å¾·é‡Œæ ¼æ–¯æŒ‡å‡ºï¼Œä»Šå¤©çš„ç§»æ°‘æ—¢æ²¡æœ‰è¾¾åˆ°å‰æ‰€æœªæœ‰çš„æ°´å¹³ï¼Œä¹Ÿæ²¡æœ‰æŠµåˆ¶åŒåŒ–ã€‚</p>\n<h3 id=\"è¯­å¥-3\"><a class=\"anchor\" href=\"#è¯­å¥-3\">#</a> è¯­å¥ 3</h3>\n<p>In 1998 immigrants were 9.8 percent of the population; in 1900, 13.6 percent</p>\n<h4 id=\"è¯­æ³•-9\"><a class=\"anchor\" href=\"#è¯­æ³•-9\">#</a> è¯­æ³•</h4>\n<p class=\"wavy\"><ins class=\"primary\">In 1998</ins> <ins>immigrants</ins> <ins>were</ins>.{.dot .warming} <ins>9.8 percent of population</ins>.{. wavy}; <ins class=\"primary\">in 1900</ins>, <ins>13.6 percent</ins>.</p>\n<p>çŠ¶è¯­: In 1998; in 1900</p>\n<p>ä¸»å¥: In 1998 immigrants were 9.8 percent of the population</p>\n<ul>\n<li>ä¸»è¯­: immigrants</li>\n<li>è°“è¯­: were</li>\n<li>å®¾è¯­: 9.8 percent of the population</li>\n</ul>\n<p>çœç•¥å¥ï¼š13.6 percent</p>\n<ul>\n<li>ä¸»è¯­: immigrants</li>\n<li>è°“è¯­: were</li>\n<li>å®¾è¯­: 13.6 percent</li>\n</ul>\n<h4 id=\"è¯æ±‡-9\"><a class=\"anchor\" href=\"#è¯æ±‡-9\">#</a> è¯æ±‡</h4>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">è¯æ±‡</th>\n<th style=\"text-align:left\">è¯æ€§</th>\n<th style=\"text-align:left\">ä¸­æ–‡</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"ç¿»è¯‘-9\"><a class=\"anchor\" href=\"#ç¿»è¯‘-9\">#</a> ç¿»è¯‘</h4>\n<p>1998 å¹´ [ç§»æ°‘].{.red} æ˜¯äººå£çš„ 9.8%, è€Œ 1900 å¹´æ˜¯ 13.6%</p>\n<p><strong>åˆ†æ:</strong> ç¿»è¯‘ä¸è¦å°‘ä¸»è¯­</p>\n<h4 id=\"æ ‡å‡†ç¿»è¯‘-9\"><a class=\"anchor\" href=\"#æ ‡å‡†ç¿»è¯‘-9\">#</a> æ ‡å‡†ç¿»è¯‘</h4>\n<p>998 å¹´ï¼Œç§»æ°‘å äººå£çš„ 9.8%ï¼›1900 å¹´æ˜¯ 13.6%</p>\n<h3 id=\"è¯­å¥-4\"><a class=\"anchor\" href=\"#è¯­å¥-4\">#</a> è¯­å¥ 4</h3>\n<p>In the 10 years prior to 1990, 3.1 immigrants arrived for every 1,000 residents;</p>\n<h4 id=\"è¯­æ³•-10\"><a class=\"anchor\" href=\"#è¯­æ³•-10\">#</a> è¯­æ³•</h4>\n<p>In the 10 years prior to 1990, 3.1 immigrants arrived for every 1,000 residents;in the 10 years prior to 1890, 9.2 for every 1,000.</p>\n<p>çŠ¶è¯­: In the 10 years prior to 1990</p>\n<ul>\n<li>ä¸»è¯­: immigrants</li>\n<li>è°“è¯­: arrived for</li>\n<li>å®¾è¯­: every 1,000 residents</li>\n</ul>\n<h4 id=\"è¯æ±‡-10\"><a class=\"anchor\" href=\"#è¯æ±‡-10\">#</a> è¯æ±‡</h4>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">è¯æ±‡</th>\n<th style=\"text-align:left\">è¯æ€§</th>\n<th style=\"text-align:left\">ä¸­æ–‡</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">prior to</td>\n<td style=\"text-align:left\">phere</td>\n<td style=\"text-align:left\">åœ¨å‰é¢çš„</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"ç¿»è¯‘-10\"><a class=\"anchor\" href=\"#ç¿»è¯‘-10\">#</a> ç¿»è¯‘</h4>\n<p>åœ¨ 1990 å¹´çš„å‰ 10 å¹´ï¼Œæ¯ 1000 ä¸ªå±…æ°‘ä¸­æœ‰ 3.1 ä¸ªç§»æ°‘ï¼›åœ¨ 1890 çš„å‰ 10 å¹´ï¼Œæ¯ 1000 ä¸ªå±…æ°‘ä¸­æœ‰ 9.2 ä¸ªç§»æ°‘è€…</p>\n<h4 id=\"æ ‡å‡†ç¿»è¯‘-10\"><a class=\"anchor\" href=\"#æ ‡å‡†ç¿»è¯‘-10\">#</a> æ ‡å‡†ç¿»è¯‘</h4>\n<p>åœ¨ 1990 å¹´ä¹‹å‰çš„ 10 å¹´é‡Œï¼Œæ¯ 1000 ä¸ªå±…æ°‘ä¸­å°±æœ‰ 3.1 ä¸ªç§»æ°‘ï¼›åœ¨ 1890 å¹´ä¹‹å‰çš„ 10 å¹´é‡Œï¼Œæ¯ 1000 äººä¸­å°±æœ‰ 9.2 äºº</p>\n<h3 id=\"è¯­å¥-5-2\"><a class=\"anchor\" href=\"#è¯­å¥-5-2\">#</a> è¯­å¥ 5</h3>\n<p>Now, consider three indices of assimilation language, home ownership and intermarriage</p>\n<h4 id=\"è¯­æ³•-11\"><a class=\"anchor\" href=\"#è¯­æ³•-11\">#</a> è¯­æ³•</h4>\n<p>Now, consider three indices of assimilation language, home ownership and intermarriage.</p>\n<ul>\n<li>è°“è¯­: consider</li>\n<li>å®¾è¯­: three indices of assimilationâ€”language, home ownership and intermarriage</li>\n</ul>\n<h4 id=\"è¯æ±‡-11\"><a class=\"anchor\" href=\"#è¯æ±‡-11\">#</a> è¯æ±‡</h4>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">è¯æ±‡</th>\n<th style=\"text-align:left\">è¯æ€§</th>\n<th style=\"text-align:left\">ä¸­æ–‡</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">indices</td>\n<td style=\"text-align:left\">n</td>\n<td style=\"text-align:left\">æŒ‡æ•°</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">ownership</td>\n<td style=\"text-align:left\">phere</td>\n<td style=\"text-align:left\">æ‰€æœ‰æƒï¼›äº§æƒï¼›ç‰©ä¸»èº«ä»½</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">intermarriage.</td>\n<td style=\"text-align:left\">n</td>\n<td style=\"text-align:left\">é€šå©š</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"ç¿»è¯‘-11\"><a class=\"anchor\" href=\"#ç¿»è¯‘-11\">#</a> ç¿»è¯‘</h4>\n<p>ç°åœ¨ï¼Œè€ƒè™‘åŒåŒ–çš„ä¸‰ä¸ªæŒ‡æ•°ï¼šè¯­è¨€ï¼Œæ‰€æœ‰æƒå’Œé€šå©š</p>\n<p>** åˆ†æ:** æ‰€æœ‰æƒï¼Œä¹Ÿå¯¹ï¼Œä½†æ˜¯è¿™é‡Œæ›´åå‘äº§æƒ</p>\n<h4 id=\"æ ‡å‡†ç¿»è¯‘-11\"><a class=\"anchor\" href=\"#æ ‡å‡†ç¿»è¯‘-11\">#</a> æ ‡å‡†ç¿»è¯‘</h4>\n<p>ç°åœ¨ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹åŒåŒ–çš„ä¸‰ä¸ªæŒ‡æ ‡ â€”â€” è¯­è¨€ã€æˆ¿å±‹æ‰€æœ‰æƒå’Œé€šå©š</p>\n<h2 id=\"ç¬¬ä¸‰æ®µ\"><a class=\"anchor\" href=\"#ç¬¬ä¸‰æ®µ\">#</a> ç¬¬ä¸‰æ®µ</h2>\n<h3 id=\"è¯­å¥-1-2\"><a class=\"anchor\" href=\"#è¯­å¥-1-2\">#</a> è¯­å¥ 1</h3>\n<p>The 1990 Census revealed that â€œa majority of immigrants from each of the fifteen most common countries of origin spoke English â€˜wellâ€™ or â€˜very wellâ€™ after ten years of residence.â€</p>\n<h4 id=\"è¯­æ³•-12\"><a class=\"anchor\" href=\"#è¯­æ³•-12\">#</a> è¯­æ³•</h4>\n<p>The 1990 <ins>Census</ins> <ins>revealed</ins>.{.dot .warming}<br />\n[that â€œa majority of <ins>immigrants</ins> from each of the fifteen most common countries of origin {spoke}.{.dot .warming}  English â€˜wellâ€™ or â€˜very wellâ€™ <ins class=\"primary\">after ten years of residence</ins>.].{.qoua}â€</p>\n<p>çŠ¶è¯­:</p>\n<p>ä¸»å¥: The 1990 Census revealed</p>\n<ul>\n<li>ä¸»è¯­: Census</li>\n<li>è°“è¯­: revealed</li>\n</ul>\n<p>å®¾ä»: a majority of immigrants <mark>from each of the fifteen most common countries of origin</mark> spoke English â€˜wellâ€™ or â€˜very wellâ€™ after ten years of residence</p>\n<ul>\n<li>ä¸»è¯­: immigrants</li>\n<li>è°“è¯­: spoke</li>\n<li>çŠ¶è¯­: English â€˜wellâ€™ or â€˜very wellâ€™</li>\n</ul>\n<h4 id=\"è¯æ±‡-12\"><a class=\"anchor\" href=\"#è¯æ±‡-12\">#</a> è¯æ±‡</h4>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">è¯æ±‡</th>\n<th style=\"text-align:left\">è¯æ€§</th>\n<th style=\"text-align:left\">ä¸­æ–‡</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">revealed</td>\n<td style=\"text-align:left\">vt.</td>\n<td style=\"text-align:left\">æ­ç¤ºï¼›æ­éœ²</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"ç¿»è¯‘-12\"><a class=\"anchor\" href=\"#ç¿»è¯‘-12\">#</a> ç¿»è¯‘</h4>\n<p>1990 å¹´çš„äººå£æ™®æŸ¥æ˜¾ç¤ºï¼Œ&quot;åœ¨å±…ä½ 10 å¹´åï¼Œæ¥è‡ª 15 ä¸ªä¸€èˆ¬å›½å®¶çš„å¤§éƒ¨åˆ†çš„ç§»æ°‘è€…è¯´è‹±è¯­&quot; å¾ˆå¥½ &quot;æˆ–è€…&quot; éå¸¸å¥½ &quot;</p>\n<p><strong>åˆ†æ:</strong></p>\n<ul>\n<li>æ™®éè¦æ¯”ä¸€èˆ¬æ›´å¥½</li>\n<li>from each of the fifteen most common countries of origin åšåç½®å®šè¯­</li>\n<li>after ten years of residence çŠ¶è¯­</li>\n</ul>\n<h4 id=\"æ ‡å‡†ç¿»è¯‘-12\"><a class=\"anchor\" href=\"#æ ‡å‡†ç¿»è¯‘-12\">#</a> æ ‡å‡†ç¿»è¯‘</h4>\n<p>1990 å¹´çš„äººå£æ™®æŸ¥æ˜¾ç¤ºï¼Œâ€œæ¥è‡ª 15 ä¸ªæœ€æ™®éçš„åŸç±å›½å®¶çš„å¤§å¤šæ•°ç§»æ°‘åœ¨å±…ä½ 10 å¹´åï¼Œè‹±è¯­éƒ½ä¼šè¯´å¾—ä¸é”™ï¼Œæˆ–è€…æ˜¯ç›¸å½“å¥½ã€‚â€</p>\n<h3 id=\"è¯­å¥-2-2\"><a class=\"anchor\" href=\"#è¯­å¥-2-2\">#</a> è¯­å¥ 2</h3>\n<p>The children of immigrants tend to be bilingual and proficient in English</p>\n<h4 id=\"è¯­æ³•-13\"><a class=\"anchor\" href=\"#è¯­æ³•-13\">#</a> è¯­æ³•</h4>\n<p><ins>The children of immigrants</ins> <ins>tend to be</ins>.{.dot, .warming} <ins>bilingual and proficient</ins> <ins wavy=\"\">in English.</ins></p>\n<ul>\n<li>ä¸»è¯­: The children of immigrants</li>\n<li>è°“è¯­: are quickly fitting into</li>\n<li>å®¾è¯­: this common culture</li>\n</ul>\n<h4 id=\"è¯æ±‡-13\"><a class=\"anchor\" href=\"#è¯æ±‡-13\">#</a> è¯æ±‡</h4>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">è¯æ±‡</th>\n<th style=\"text-align:left\">è¯æ€§</th>\n<th style=\"text-align:left\">ä¸­æ–‡</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">bilingual</td>\n<td style=\"text-align:left\">adj</td>\n<td style=\"text-align:left\">åŒè¯­çš„ï¼›ä½¿ç”¨ä¸¤ç§è¯­è¨€çš„</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">proficient (in)</td>\n<td style=\"text-align:left\">adj</td>\n<td style=\"text-align:left\">ç†Ÿç»ƒçš„ï¼›ç²¾é€šçš„</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"ç¿»è¯‘-13\"><a class=\"anchor\" href=\"#ç¿»è¯‘-13\">#</a> ç¿»è¯‘</h4>\n<p>ç§»æ°‘è€…çš„å­©å­å¾€å¾€æ˜¯åŒè¯­çš„è€Œä¸”ç†Ÿç»ƒè‹±è¯­</p>\n<p>** åˆ†æ:**proficient ä¿®é¥° English</p>\n<h4 id=\"æ ‡å‡†ç¿»è¯‘-13\"><a class=\"anchor\" href=\"#æ ‡å‡†ç¿»è¯‘-13\">#</a> æ ‡å‡†ç¿»è¯‘</h4>\n<p>ç§»æ°‘çš„å­©å­å¾€å¾€ä¼šè¯´ä¸¤ç§è¯­è¨€ï¼Œç²¾é€šè‹±è¯­ã€‚</p>\n<h3 id=\"è¯­å¥-3-2\"><a class=\"anchor\" href=\"#è¯­å¥-3-2\">#</a> è¯­å¥ 3</h3>\n<p>â€œBy the third generation, the original language is lost in the majority of immigrant families.â€</p>\n<h4 id=\"è¯­æ³•-14\"><a class=\"anchor\" href=\"#è¯­æ³•-14\">#</a> è¯­æ³•</h4>\n<p>â€œ<ins>By the third generation</ins>.{.primary}, <ins>the original language</ins> <ins>is</ins>.{.dot .warming} lost <mark>in the majority of immigrant families.â€</mark></p>\n<p>çŠ¶è¯­: By the third generation</p>\n<ul>\n<li>ä¸»è¯­: the original language</li>\n<li>è°“è¯­: is</li>\n<li>å®¾è¯­: lost in the majority of immigrant families</li>\n</ul>\n<h4 id=\"è¯æ±‡-14\"><a class=\"anchor\" href=\"#è¯æ±‡-14\">#</a> è¯æ±‡</h4>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">è¯æ±‡</th>\n<th style=\"text-align:left\">è¯æ€§</th>\n<th style=\"text-align:left\">ä¸­æ–‡</th>\n</tr>\n</thead>\n</table>\n<h4 id=\"ç¿»è¯‘-14\"><a class=\"anchor\" href=\"#ç¿»è¯‘-14\">#</a> ç¿»è¯‘</h4>\n<p>åˆ°äº†ç¬¬ä¸‰ä»£ï¼Œå¤§éƒ¨åˆ†ç§»æ°‘å®¶åº­ä¸­æ¯è¯­å·²ç»æ¶ˆå¤±</p>\n<h4 id=\"æ ‡å‡†ç¿»è¯‘-14\"><a class=\"anchor\" href=\"#æ ‡å‡†ç¿»è¯‘-14\">#</a> æ ‡å‡†ç¿»è¯‘</h4>\n<p>â€œåˆ°äº†ç¬¬ä¸‰ä»£ï¼Œå¤§å¤šæ•°ç§»æ°‘å®¶åº­çš„æ¯è¯­å°±æ¶ˆå¤±äº†ã€‚â€</p>\n<h3 id=\"è¯­å¥-4-2\"><a class=\"anchor\" href=\"#è¯­å¥-4-2\">#</a> è¯­å¥ 4</h3>\n<p>Hence the description of America as a â€œgraveyardâ€ for languages.</p>\n<h4 id=\"è¯­æ³•-15\"><a class=\"anchor\" href=\"#è¯­æ³•-15\">#</a> è¯­æ³•</h4>\n<p>Hence the description of America as a â€œgraveyardâ€ for languages.</p>\n<ul>\n<li>ä¸»è¯­: the description of America</li>\n<li>è°“è¯­: as</li>\n<li>å®¾è¯­: a â€œgraveyardâ€ for languages</li>\n</ul>\n<h4 id=\"è¯æ±‡-15\"><a class=\"anchor\" href=\"#è¯æ±‡-15\">#</a> è¯æ±‡</h4>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">è¯æ±‡</th>\n<th style=\"text-align:left\">è¯æ€§</th>\n<th style=\"text-align:left\">ä¸­æ–‡</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">elevating</td>\n<td style=\"text-align:left\">adj</td>\n<td style=\"text-align:left\">æœ‰è¶£çš„ï¼›å‘äººæ·±çœçš„ï¼›å¯å‘çš„</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"ç¿»è¯‘-15\"><a class=\"anchor\" href=\"#ç¿»è¯‘-15\">#</a> ç¿»è¯‘</h4>\n<p>å› æ­¤ï¼Œç¾å›½è¢«æè¿°ä¸ºè¯­è¨€çš„ &quot;å¢“åœ°&quot;</p>\n<h4 id=\"æ ‡å‡†ç¿»è¯‘-15\"><a class=\"anchor\" href=\"#æ ‡å‡†ç¿»è¯‘-15\">#</a> æ ‡å‡†ç¿»è¯‘</h4>\n<p>å› æ­¤ï¼Œç¾å›½è¢«æè¿°ä¸ºè¯­è¨€çš„ â€œå¢“åœ°â€ã€‚</p>\n<h2 id=\"ç¬¬å››æ®µ\"><a class=\"anchor\" href=\"#ç¬¬å››æ®µ\">#</a> ç¬¬å››æ®µ</h2>\n<h3 id=\"è¯­å¥-1-3\"><a class=\"anchor\" href=\"#è¯­å¥-1-3\">#</a> è¯­å¥ 1</h3>\n<p>By 1996 foreign-born immigrants [who had arrived before 1970].{.aquo} <ins>had</ins>.{.wavy} <ins>a home ownership rate of 75.6 percent</ins>.{.wavy},<br />\nhigher than the 69.8 percent rate among native-born Americans</p>\n<h4 id=\"è¯­æ³•-16\"><a class=\"anchor\" href=\"#è¯­æ³•-16\">#</a> è¯­æ³•</h4>\n<p>By 1996 foreign-born immigrants who had arrived before 1970 had a home ownership rate of 75.6 percent, higher than the 69.8 percent rate among native-born Americans</p>\n<p>çŠ¶è¯­: Immigrants are quickly fitting into this common culture,</p>\n<p>ä¸»å¥: By 1996 foreign-born immigrants had a home ownership rate of 75.6 percent</p>\n<ul>\n<li>ä¸»è¯­: By 1996 foreign-born immigrants</li>\n<li>è°“è¯­: had</li>\n<li>å®¾è¯­: home ownership rate of 75.6 percent</li>\n</ul>\n<p>åŒä½è¯­: which may not be altogether elevating but is hardly poisonous</p>\n<ul>\n<li>ä¸»è¯­: Immigrants</li>\n<li>è°“è¯­: may not be; is</li>\n<li>çŠ¶è¯­: altogether elevating; poisonous</li>\n</ul>\n<h4 id=\"è¯æ±‡-16\"><a class=\"anchor\" href=\"#è¯æ±‡-16\">#</a> è¯æ±‡</h4>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">è¯æ±‡</th>\n<th style=\"text-align:left\">è¯æ€§</th>\n<th style=\"text-align:left\">ä¸­æ–‡</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">elevating</td>\n<td style=\"text-align:left\">adj</td>\n<td style=\"text-align:left\">æœ‰è¶£çš„ï¼›å‘äººæ·±çœçš„ï¼›å¯å‘çš„</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"ç¿»è¯‘-16\"><a class=\"anchor\" href=\"#ç¿»è¯‘-16\">#</a> ç¿»è¯‘</h4>\n<p>ç§»æ°‘è€…å¿«é€Ÿçš„èå…¥å¤§ä¼—æ–‡åŒ–ï¼Œå¯èƒ½æ²¡æœ‰æœ‰è¶£ä½†ä¹Ÿæ²¡æœ‰é‚£ä¹ˆæœ‰å®³</p>\n<p>** åˆ†æ:** ä¸è¦å°‘ç¿»è¯‘å•è¯</p>\n<h4 id=\"æ ‡å‡†ç¿»è¯‘-16\"><a class=\"anchor\" href=\"#æ ‡å‡†ç¿»è¯‘-16\">#</a> æ ‡å‡†ç¿»è¯‘</h4>\n<p>ç§»æ°‘ä»¬å¾ˆå¿«å°±èå…¥äº†è¿™ç§å…±åŒçš„æ–‡åŒ–ï¼Œè¿™ç§æ–‡åŒ–ä¹Ÿè®¸æ²¡æœ‰é‚£ä¹ˆé«˜å°šï¼Œä½†ä¹Ÿæ²¡æœ‰é‚£ä¹ˆæœ‰å®³ã€‚</p>\n<h3 id=\"è¯­å¥-1-4\"><a class=\"anchor\" href=\"#è¯­å¥-1-4\">#</a> è¯­å¥ 1</h3>\n<p>Immigrants are quickly fitting into this common culture, which may not be altogether elevating but is hardly poisonous.</p>\n<h4 id=\"è¯­æ³•-17\"><a class=\"anchor\" href=\"#è¯­æ³•-17\">#</a> è¯­æ³•</h4>\n<p><ins>Immigrants</ins> <ins>are quickly fitting into</ins>.{.dot .warming} <ins>this common culture</ins>.{.wavy}, [which may not be altogether elevating but is hardly poisonous].{.aqua}.</p>\n<p>çŠ¶è¯­: Immigrants are quickly fitting into this common culture,</p>\n<p>ä¸»å¥: Immigrants</p>\n<ul>\n<li>ä¸»è¯­: Immigrants</li>\n<li>è°“è¯­: are quickly fitting into</li>\n<li>å®¾è¯­: this common culture</li>\n</ul>\n<p>åŒä½è¯­: which may not be altogether elevating but is hardly poisonous</p>\n<ul>\n<li>ä¸»è¯­: Immigrants</li>\n<li>è°“è¯­: may not be; is</li>\n<li>çŠ¶è¯­: altogether elevating; poisonous</li>\n</ul>\n<h4 id=\"è¯æ±‡-17\"><a class=\"anchor\" href=\"#è¯æ±‡-17\">#</a> è¯æ±‡</h4>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">è¯æ±‡</th>\n<th style=\"text-align:left\">è¯æ€§</th>\n<th style=\"text-align:left\">ä¸­æ–‡</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">elevating</td>\n<td style=\"text-align:left\">adj</td>\n<td style=\"text-align:left\">æœ‰è¶£çš„ï¼›å‘äººæ·±çœçš„ï¼›å¯å‘çš„</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"ç¿»è¯‘-17\"><a class=\"anchor\" href=\"#ç¿»è¯‘-17\">#</a> ç¿»è¯‘</h4>\n<p>ç§»æ°‘è€…å¿«é€Ÿçš„èå…¥å¤§ä¼—æ–‡åŒ–ï¼Œå¯èƒ½æ²¡æœ‰æœ‰è¶£ä½†ä¹Ÿæ²¡æœ‰é‚£ä¹ˆæœ‰å®³</p>\n<p>** åˆ†æ:** ä¸è¦å°‘ç¿»è¯‘å•è¯</p>\n<h4 id=\"æ ‡å‡†ç¿»è¯‘-17\"><a class=\"anchor\" href=\"#æ ‡å‡†ç¿»è¯‘-17\">#</a> æ ‡å‡†ç¿»è¯‘</h4>\n<p>ç§»æ°‘ä»¬å¾ˆå¿«å°±èå…¥äº†è¿™ç§å…±åŒçš„æ–‡åŒ–ï¼Œè¿™ç§æ–‡åŒ–ä¹Ÿè®¸æ²¡æœ‰é‚£ä¹ˆé«˜å°šï¼Œä½†ä¹Ÿæ²¡æœ‰é‚£ä¹ˆæœ‰å®³ã€‚</p>\n<h3 id=\"è¯­å¥-1-5\"><a class=\"anchor\" href=\"#è¯­å¥-1-5\">#</a> è¯­å¥ 1</h3>\n<p>Immigrants are quickly fitting into this common culture, which may not be altogether elevating but is hardly poisonous.</p>\n<h4 id=\"è¯­æ³•-18\"><a class=\"anchor\" href=\"#è¯­æ³•-18\">#</a> è¯­æ³•</h4>\n<p><ins>Immigrants</ins> <ins>are quickly fitting into</ins>.{.dot .warming} <ins>this common culture</ins>.{.wavy}, [which may not be altogether elevating but is hardly poisonous].{.aqua}.</p>\n<p>çŠ¶è¯­: Immigrants are quickly fitting into this common culture,</p>\n<p>ä¸»å¥: Immigrants</p>\n<ul>\n<li>ä¸»è¯­: Immigrants</li>\n<li>è°“è¯­: are quickly fitting into</li>\n<li>å®¾è¯­: this common culture</li>\n</ul>\n<p>åŒä½è¯­: which may not be altogether elevating but is hardly poisonous</p>\n<ul>\n<li>ä¸»è¯­: Immigrants</li>\n<li>è°“è¯­: may not be; is</li>\n<li>çŠ¶è¯­: altogether elevating; poisonous</li>\n</ul>\n<h4 id=\"è¯æ±‡-18\"><a class=\"anchor\" href=\"#è¯æ±‡-18\">#</a> è¯æ±‡</h4>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">è¯æ±‡</th>\n<th style=\"text-align:left\">è¯æ€§</th>\n<th style=\"text-align:left\">ä¸­æ–‡</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">elevating</td>\n<td style=\"text-align:left\">adj</td>\n<td style=\"text-align:left\">æœ‰è¶£çš„ï¼›å‘äººæ·±çœçš„ï¼›å¯å‘çš„</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"ç¿»è¯‘-18\"><a class=\"anchor\" href=\"#ç¿»è¯‘-18\">#</a> ç¿»è¯‘</h4>\n<p>ç§»æ°‘è€…å¿«é€Ÿçš„èå…¥å¤§ä¼—æ–‡åŒ–ï¼Œå¯èƒ½æ²¡æœ‰æœ‰è¶£ä½†ä¹Ÿæ²¡æœ‰é‚£ä¹ˆæœ‰å®³</p>\n<p>** åˆ†æ:** ä¸è¦å°‘ç¿»è¯‘å•è¯</p>\n<h4 id=\"æ ‡å‡†ç¿»è¯‘-18\"><a class=\"anchor\" href=\"#æ ‡å‡†ç¿»è¯‘-18\">#</a> æ ‡å‡†ç¿»è¯‘</h4>\n<p>ç§»æ°‘ä»¬å¾ˆå¿«å°±èå…¥äº†è¿™ç§å…±åŒçš„æ–‡åŒ–ï¼Œè¿™ç§æ–‡åŒ–ä¹Ÿè®¸æ²¡æœ‰é‚£ä¹ˆé«˜å°šï¼Œä½†ä¹Ÿæ²¡æœ‰é‚£ä¹ˆæœ‰å®³ã€‚</p>\n<h3 id=\"è¯­å¥-1-6\"><a class=\"anchor\" href=\"#è¯­å¥-1-6\">#</a> è¯­å¥ 1</h3>\n<p>Immigrants are quickly fitting into this common culture, which may not be altogether elevating but is hardly poisonous.</p>\n<h4 id=\"è¯­æ³•-19\"><a class=\"anchor\" href=\"#è¯­æ³•-19\">#</a> è¯­æ³•</h4>\n<p><ins>Immigrants</ins> <ins>are quickly fitting into</ins>.{.dot .warming} <ins>this common culture</ins>.{.wavy}, [which may not be altogether elevating but is hardly poisonous].{.aqua}.</p>\n<p>çŠ¶è¯­: Immigrants are quickly fitting into this common culture,</p>\n<p>ä¸»å¥: Immigrants</p>\n<ul>\n<li>ä¸»è¯­: Immigrants</li>\n<li>è°“è¯­: are quickly fitting into</li>\n<li>å®¾è¯­: this common culture</li>\n</ul>\n<p>åŒä½è¯­: which may not be altogether elevating but is hardly poisonous</p>\n<ul>\n<li>ä¸»è¯­: Immigrants</li>\n<li>è°“è¯­: may not be; is</li>\n<li>çŠ¶è¯­: altogether elevating; poisonous</li>\n</ul>\n<h4 id=\"è¯æ±‡-19\"><a class=\"anchor\" href=\"#è¯æ±‡-19\">#</a> è¯æ±‡</h4>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">è¯æ±‡</th>\n<th style=\"text-align:left\">è¯æ€§</th>\n<th style=\"text-align:left\">ä¸­æ–‡</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">elevating</td>\n<td style=\"text-align:left\">adj</td>\n<td style=\"text-align:left\">æœ‰è¶£çš„ï¼›å‘äººæ·±çœçš„ï¼›å¯å‘çš„</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"ç¿»è¯‘-19\"><a class=\"anchor\" href=\"#ç¿»è¯‘-19\">#</a> ç¿»è¯‘</h4>\n<p>ç§»æ°‘è€…å¿«é€Ÿçš„èå…¥å¤§ä¼—æ–‡åŒ–ï¼Œå¯èƒ½æ²¡æœ‰æœ‰è¶£ä½†ä¹Ÿæ²¡æœ‰é‚£ä¹ˆæœ‰å®³</p>\n<p>** åˆ†æ:** ä¸è¦å°‘ç¿»è¯‘å•è¯</p>\n<h4 id=\"æ ‡å‡†ç¿»è¯‘-19\"><a class=\"anchor\" href=\"#æ ‡å‡†ç¿»è¯‘-19\">#</a> æ ‡å‡†ç¿»è¯‘</h4>\n<p>ç§»æ°‘ä»¬å¾ˆå¿«å°±èå…¥äº†è¿™ç§å…±åŒçš„æ–‡åŒ–ï¼Œè¿™ç§æ–‡åŒ–ä¹Ÿè®¸æ²¡æœ‰é‚£ä¹ˆé«˜å°šï¼Œä½†ä¹Ÿæ²¡æœ‰é‚£ä¹ˆæœ‰å®³ã€‚</p>\n<hr />\n<p>å¤§é“äº”åï¼Œå¤©è¡å››åä¹ï¼Œäººéå…¶ä¸€ï¼</p>\n",
            "tags": [
                "è€ƒç ”è‹±è¯­",
                "2006"
            ]
        },
        {
            "id": "https://to-ywz.github.io/Embedded/Linux/Makefile%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/",
            "url": "https://to-ywz.github.io/Embedded/Linux/Makefile%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/",
            "title": "MakefileåŸºæœ¬ä½¿ç”¨",
            "date_published": "2023-07-02T22:31:44.000Z",
            "content_html": "<h1 id=\"å¼•å…¥makefileçš„åŸå› \"><a class=\"anchor\" href=\"#å¼•å…¥makefileçš„åŸå› \">#</a> å¼•å…¥ Makefile çš„åŸå› </h1>\n<p>åœ¨ä½¿ç”¨ å„ç§å„æ ·çš„ IDE çš„æ—¶å€™å¾€å¾€åªéœ€è¦ç‚¹å‡»ä¸€ä¸ªç¼–è¯‘æŒ‰é”®å°±å¯ä»¥å®ç°ç¼–è¯‘</p>\n<p>ä½†å¦‚æœä½¿ç”¨è‡ªç»„çš„ç¼–è¯‘é“¾ï¼Œç¼–è¯‘ä¸€ä¸ªæ–‡ä»¶å°±éœ€è¦æ‰§è¡Œä¸€æ¡ä¸‹é¢è¿™ä¸ªè¯­å¥</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>gcc <span class=\"token parameter variable\">-o</span> c c.c</pre></td></tr></table></figure><p>ä½†æ˜¯ï¼ŒåµŒå…¥å¼å¼€å‘å¾€å¾€æœ‰å¤§é‡çš„æ–‡ä»¶ï¼Œæ€»ä¸èƒ½ä¸€ä¸ªä¸ªæ–‡ä»¶ç½—åˆ—<br />\nè€Œä¸”å¤§é‡çš„æ–‡ä»¶ä¸ä»…å®¹æ˜“å°‘å†™ï¼Œè€Œä¸”ä¼šå ç”¨å¤§é‡çš„ç¼–è¯‘æ—¶é—´ï¼Œæ¯æ¬¡æ¯ä¸ªæ–‡ä»¶éƒ½è¦é‡æ–°ç¼–è¯‘</p>\n<p>å› æ­¤ ä¸€å¥—ç”¨äº è§„å®š å¦‚ä½•ç¼–è¯‘çš„è§„åˆ™ â€”â€”Makefile å°±åº”è¿è€Œç”Ÿå•¦</p>\n<h2 id=\"ä¸€ä¸ªcè¯­è¨€ä¾‹å­\"><a class=\"anchor\" href=\"#ä¸€ä¸ªcè¯­è¨€ä¾‹å­\">#</a> ä¸€ä¸ª C è¯­è¨€ä¾‹å­</h2>\n<p>b.c</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token function\">call_b</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"CC\\r\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>c.c</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">call_b</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"BBB\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>å¯¹äºè¿™ä¸ªç¨‹åºï¼Œç¼–è¯‘æ–‡ä»¶éœ€è¦æ‰§è¡Œä¸‹é¢çš„è¯­å¥ï¼Œå°±å¯ä»¥å®ç°ç¼–è¯‘<br />\næ­£å¸¸æ¥è¯´ .c ç¨‹åº ==&gt; å¾—åˆ°å¯æ‰§è¡Œç¨‹åº å®ƒä»¬ä¹‹é—´è¦ç»è¿‡å››ä¸ªæ­¥éª¤:</p>\n<ul>\n<li>1. é¢„å¤„ç†</li>\n<li>2. ç¼–è¯‘</li>\n<li>3. æ±‡ç¼–</li>\n<li>4. é“¾æ¥</li>\n</ul>\n<p>äº‹å®ä¸Šæˆ‘ä»¬å¸¸æŠŠå‰ä¸‰ä¸ªæ­¥éª¤ç§°ä¸ºç¼–è¯‘ï¼Œå„ç§.o æ–‡ä»¶çš„æ‹¼æ¥ç§°ä¸ºé“¾æ¥<br />\nåœ¨ gcc ä¸­ç›¸å…³å‘½ä»¤ä¸º<br />\nç¼–è¯‘</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>gcc <span class=\"token parameter variable\">-o</span> c.o c.c</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>gcc <span class=\"token parameter variable\">-o</span> b.o b.c</pre></td></tr></table></figure><p>é“¾æ¥</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>gcc <span class=\"token parameter variable\">-o</span> mian c.o b.o</pre></td></tr></table></figure><h1 id=\"makfile-çš„åŸºæœ¬è§„åˆ™\"><a class=\"anchor\" href=\"#makfile-çš„åŸºæœ¬è§„åˆ™\">#</a> Makfile çš„åŸºæœ¬è§„åˆ™</h1>\n<h2 id=\"å¦‚ä½•å‡å°‘ç¼–è¯‘æ—¶é—´\"><a class=\"anchor\" href=\"#å¦‚ä½•å‡å°‘ç¼–è¯‘æ—¶é—´\">#</a> å¦‚ä½•å‡å°‘ç¼–è¯‘æ—¶é—´</h2>\n<p>ä¸Šé¢è¯´åˆ° ç¼–è¯‘å¤šä¸ªæ–‡ä»¶çš„æ—¶å€™ï¼Œå¯èƒ½åªä¿®æ”¹äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œè¿™æ ·å¯ä»¥å¤§å¤§çš„å‡å°‘ç¼–è¯‘æ—¶é—´</p>\n<p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼ŒMakefile æ˜¯å¦‚ä½•çŸ¥é“å“ªäº›æ–‡ä»¶è¢«æ›´æ–°äº†å‘¢ï¼Ÿ</p>\n<p>å…¶å®å¾ˆç®€å•ï¼Œå› ä¸ºæ¯æ¬¡ç¼–è¯‘éƒ½ä¼šç”Ÿæˆ .o æ–‡ä»¶ï¼Œå°†.o æ–‡ä»¶å’Œ ç›¸å¯¹åº”çš„.c æ–‡ä»¶è¿›è¡Œæ—¶é—´æ¯”è¾ƒï¼Œå¦‚æœ.c æ›´æ–°åˆ™ç¼–è¯‘.<br />\n æ‰€æœ‰çš„.o éƒ½å’Œæœ€ç»ˆçš„äºŒè¿›åˆ¶æ–‡ä»¶æ¯”è¾ƒï¼Œè¦æ˜¯æœ‰æ›´æ–°çš„.o å°±äº§ç”Ÿé“¾æ¥</p>\n<h2 id=\"åŸºæœ¬è¯­æ³•\"><a class=\"anchor\" href=\"#åŸºæœ¬è¯­æ³•\">#</a> åŸºæœ¬è¯­æ³•</h2>\n<h3 id=\"è§„åˆ™\"><a class=\"anchor\" href=\"#è§„åˆ™\">#</a> è§„åˆ™</h3>\n<p>Makfile æœ€åŸºæœ¬çš„è¯­æ³•æ˜¯è§„åˆ™ï¼Œè§„åˆ™:</p>\n<pre><code class=\"language-Makefile\">ç›®æ ‡ : ä¾èµ–1 ä¾èµ–2 ...\n[TAB]å‘½ä»¤\n</code></pre>\n<p>å½“ä¾èµ–æ¯”ç›®æ ‡æ–°çš„æ—¶å€™ï¼Œæ‰§è¡Œç›®æ ‡ä¸‹é¢å¯¹åº”çš„ä¾èµ–å‘½ä»¤ï¼Œå¹¶ä¸” æ‰€æœ‰ç›®æ ‡éƒ½å¯ä»¥å•ç‹¬æ‰§è¡Œ</p>\n<p>ä¾‹å¦‚ï¼Œä¸Šé¢çš„ C è¯­è¨€ä¾‹å­ï¼Œç¼–è¯‘ è¿‡ç¨‹å†™æˆ Makefile</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># å½“ main.o æˆ– func.o æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªæ¯” test æ–°çš„æ—¶å€™ä¼šæ‰§ å½“å‰ç›®æ ‡ä¸‹é¢çš„è¯­å¥</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>test: main.o func.o</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\tgcc <span class=\"token parameter variable\">-o</span> <span class=\"token builtin class-name\">test</span> main.o func.o</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># å½“ main.c æ¯” main.o æ–°</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>main.o: main.c</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\tgcc <span class=\"token parameter variable\">-c</span> <span class=\"token parameter variable\">-o</span> main.o main.c</pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\"># func.c æ¯” func.o åˆ™æ›´æ–° func.o</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>func.o: func.c</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\tgcc <span class=\"token parameter variable\">-c</span> <span class=\"token parameter variable\">-o</span> func.o func.c</pre></td></tr></table></figure><p>æ‰§è¡Œåä¼šåœ¨ç»ˆç«¯æ˜¾ç¤ºä¸‹é¢çš„å†…å®¹ï¼Œå½“ç„¶æ–‡ä»¶åå´å†³äºè‡ªå·±å†™çš„æ–‡ä»¶</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ <span class=\"token function\">make</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>gcc <span class=\"token parameter variable\">-c</span> <span class=\"token parameter variable\">-o</span> main.o main.c</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>gcc <span class=\"token parameter variable\">-c</span> <span class=\"token parameter variable\">-o</span> func.o func.c</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>gcc <span class=\"token parameter variable\">-o</span> <span class=\"token builtin class-name\">test</span> main.o func.o</pre></td></tr></table></figure><p>å½“æˆ‘ä»¬ä¿®æ”¹  <code>main.c</code>  æ–‡ä»¶æ—¶ï¼Œå†æ¬¡æ‰§è¡Œ make, å°±ä¼šå‘ç°åªæœ‰ ç¬¬ä¸€å’Œç¬¬äºŒä¸ªè§„åˆ™è¢«æ‰§è¡Œäº†</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ <span class=\"token function\">make</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>gcc <span class=\"token parameter variable\">-c</span> <span class=\"token parameter variable\">-o</span> main.o main.c</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>gcc <span class=\"token parameter variable\">-o</span> <span class=\"token builtin class-name\">test</span> main.o func.o</pre></td></tr></table></figure><p>å¦‚æœåŒæ—¶ä¿®æ”¹  <code>main.c</code>  å’Œ  <code>func.c</code>  å°±ä¼šç¼–è¯‘ä¸¤ä¸ªæ–‡ä»¶ï¼Œç»ˆç«¯å’Œä¸€å¼€å§‹çš„ç•Œé¢ç±»ä¼¼</p>\n<p>å½“æ‰§è¡Œ make å‘½ä»¤æ—¶ï¼Œmake ä¼šä¼˜å…ˆæŸ¥æ‰¾å½“å‰ç›®å½•ä¸‹åä¸º Makefile çš„æ–‡ä»¶ï¼Œç„¶åæ ¹æ®è§„åˆ™æ¥æ‰§è¡Œåˆ¤æ–­å’Œå‘½ä»¤</p>\n<h3 id=\"é€šé…ç¬¦\"><a class=\"anchor\" href=\"#é€šé…ç¬¦\">#</a> é€šé…ç¬¦</h3>\n<p>åœ¨ä¸Šé¢æˆ‘ä»¬åªæœ‰ä¸¤ä¸ªæ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„ç›®æ ‡æ‰€éœ€çš„ä¾èµ–å¯ä»¥æ‰‹åŠ¨åˆ—å‡º.<br />\n ä½†è¿™ååˆ†ä¸åˆç†ï¼Œå‡å¦‚ä¸€ä¸ªç›®æ ‡æ–‡ä»¶æ‰€ä¾èµ–çš„ä¾èµ–æ–‡ä»¶å¾ˆå¤šï¼Œé‚£æ ·å²‚ä¸æ˜¯è¦å†™å¾ˆå¤šè§„åˆ™</p>\n<p>Makefile æä¾›äº†é€šé…ç¬¦çš„è¯­æ³•ï¼Œæ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¸‹é¢æ—¶å¸¸è§çš„çš„</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">ç¬¦å·</th>\n<th style=\"text-align:left\">ä½œç”¨</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">%.o</td>\n<td style=\"text-align:left\">è¡¨ç¤ºæ‰€ç”¨çš„.o æ–‡ä»¶</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">%.c</td>\n<td style=\"text-align:left\">è¡¨ç¤ºæ‰€æœ‰çš„.c æ–‡ä»¶</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">$@</td>\n<td style=\"text-align:left\">è¡¨ç¤ºç›®æ ‡</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">$&lt;</td>\n<td style=\"text-align:left\">è¡¨ç¤ºç¬¬ 1 ä¸ªä¾èµ–æ–‡ä»¶</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">$^</td>\n<td style=\"text-align:left\">è¡¨ç¤ºæ‰€æœ‰ä¾èµ–æ–‡ä»¶</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">$?</td>\n<td style=\"text-align:left\">è¡¨ç¤ºæ¯”ç›®æ ‡è¿˜è¦æ–°çš„ä¾èµ–æ–‡ä»¶åˆ—è¡¨</td>\n</tr>\n</tbody>\n</table>\n<p>è¿ç”¨ä¸Šé¢çš„è¯­æ³•æ¥æ”¹å†™ä¸€ä¸‹ä¸Šé¢çš„ Makefile</p>\n<p>åœ¨æ­¤ä¹‹å‰å…ˆæ·»åŠ ä¸€ä¸ª fun_b.c çš„æ–‡ä»¶</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">fun_b</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"This is fun_b\\r\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥å¯¹ Makefile è¿›è¡Œæ”¹é€ </p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># å½“ main.o æˆ– func.o æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªæ¯” test æ–°çš„æ—¶å€™ä¼šæ‰§ å½“å‰ç›®æ ‡ä¸‹é¢çš„è¯­å¥</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>test: main.o func.o fun_b.o</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\tgcc <span class=\"token parameter variable\">-o</span> <span class=\"token builtin class-name\">test</span> $^</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># å½“ä»»ä¸€ .c æ¯” å¯¹åº”çš„ .o æ–° å°±æ›´æ–° </span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>%.o: %.c</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\tgcc <span class=\"token parameter variable\">-c</span> <span class=\"token parameter variable\">-o</span> <span class=\"token variable\">$@</span> $<span class=\"token operator\">&lt;</span></pre></td></tr></table></figure><p>æ‰§è¡Œåç»ˆç«¯ç»“æœä¸º</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ <span class=\"token function\">make</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>gcc <span class=\"token parameter variable\">-c</span> <span class=\"token parameter variable\">-o</span> main.o main.c</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>gcc <span class=\"token parameter variable\">-c</span> <span class=\"token parameter variable\">-o</span> func.o func.c</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>gcc <span class=\"token parameter variable\">-c</span> <span class=\"token parameter variable\">-o</span> fun_b.o fun_b.c</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>gcc <span class=\"token parameter variable\">-o</span> <span class=\"token builtin class-name\">test</span> main.o func.o fun_b.o</pre></td></tr></table></figure><h3 id=\"å‡æƒ³ç›®æ ‡-phony\"><a class=\"anchor\" href=\"#å‡æƒ³ç›®æ ‡-phony\">#</a> å‡æƒ³ç›®æ ‡ .PHONY</h3>\n<p>å½“æˆ‘ä»¬ç¼–è¯‘ä¹‹åä¼šäº§ç”Ÿå¤§é‡çš„  <code>.o</code>  æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢è¿™æ¡å‘½ä»¤è¿›è¡Œåˆ é™¤</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">rm</span> <span class=\"token parameter variable\">-rf</span> *.o</pre></td></tr></table></figure><p>ä½†æ˜¯æ¯æ¬¡éƒ½è¾“å…¥è¿˜è¦è¾“å…¥ä¸€æ¬¡ï¼Œè€Œä¸”å¯èƒ½è¿˜ä¼šæœ‰å…¶å®ƒåç¼€çš„æ–‡ä»¶ï¼Œæœ‰å¯èƒ½è¯¯åˆ æˆ–è€…å°‘åˆ </p>\n<p>æˆ‘ä»¬è¯•æƒ³ä¸€ä¸‹ï¼ŒMakefile æ˜¯é€šè¿‡æŸ¥è¯¢ç›®æ ‡æ–‡ä»¶æ˜¯å¦å­˜åœ¨æ¥åˆ¤æ–­æ˜¯å¦è¦æ‰§è¡Œç”Ÿæˆä¾èµ–çš„å‘½ä»¤<br />\nå¹¶ä¸”ï¼ŒMakfile æœ¬è´¨ä¹Ÿæ˜¯å°†å‘½ä»¤å‘åˆ° bash ä¸­æ‰§è¡Œï¼Œé‚£ä¹ˆå¯ä»¥ä¹Ÿå¯ä»¥å‘é€ <code>rm -rf *.o</code>  æŒ‡ä»¤<br />\né‚£ä¹ˆå¦‚æœ å®šä¹‰ä¸€ä¸ªç›®æ ‡ï¼Œä½†æ˜¯å¯¹åº”çš„ç”Ÿæˆä¾èµ–çš„å‘½ä»¤è¡Œä¸ç”Ÿæˆä¾èµ–æ–‡ä»¶ï¼Œå°±å¯ä»¥åå¤è°ƒç”¨</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># å½“ main.o æˆ– func.o æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªæ¯” test æ–°çš„æ—¶å€™ä¼šæ‰§ å½“å‰ç›®æ ‡ä¸‹é¢çš„è¯­å¥</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>test: main.o func.o fun_b.o</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\tgcc <span class=\"token parameter variable\">-o</span> <span class=\"token builtin class-name\">test</span> $^</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># å½“ä»»ä¸€ .c æ¯” å¯¹åº”çš„ .o æ–° å°±æ›´æ–° </span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>%.o: %.c</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\tgcc <span class=\"token parameter variable\">-c</span> <span class=\"token parameter variable\">-o</span> <span class=\"token variable\">$@</span> $<span class=\"token operator\">&lt;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>clean:</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t<span class=\"token function\">rm</span> <span class=\"token parameter variable\">-rf</span> *.o *.exe</pre></td></tr></table></figure><p>æ‰§è¡ŒæŸä¸ªç›®æ ‡éœ€è¦ä½¿ç”¨ <strong> <code>make [ç›®æ ‡]</code> </strong> æ¥å®ç°ï¼Œå¦‚æœæ·»åŠ ç›®æ ‡ï¼Œé»˜è®¤ä¸ºç¬¬ä¸€ä¸ªç›®æ ‡<br />\nå½“æˆ‘ä»¬æ‰§è¡Œ  <code>make clean</code>  æ—¶ï¼Œmakefile æ£€æµ‹ä¸åˆ° clean æ–‡ä»¶ï¼Œç„¶åå°±ä¼šæ‰§è¡Œå¯¹åº”çš„åˆ é™¤è¯­å¥</p>\n<p>ä½†æ˜¯è¿™ä¸ªé€»è¾‘è¿˜å­˜åœ¨ä¸€ä¸ªé—®é¢˜ã€‚å¦‚æœï¼Œæ–‡ä»¶å¤¹ä¸‹å­˜åœ¨åä¸º clean çš„æ–‡ä»¶ï¼Œé‚£ä¹ˆ <code>make clean</code>  å°†æ— æ³•é¡ºåˆ©æ‰§è¡Œ<br />\næˆ‘ä»¬åœ¨è¯¥ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º â€œcleanâ€ çš„æ–‡ä»¶ï¼Œç„¶åé‡æ–°æ‰§è¡Œ:  <code>make</code>  ç„¶å  <code>make clean</code> <br />\n ç»“æœ (ä¼šæœ‰ä¸‹é¢çš„æç¤º):</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>make: <span class=\"token string\">'clean'</span> is up to date.</pre></td></tr></table></figure><p>å…¶å®å¯ä»¥ç†è§£ï¼Œä¸ºä»€ä¹ˆå­˜åœ¨ clean æ–‡ä»¶çš„æ—¶å€™ä¼šæ‰§è¡Œå¤±è´¥ï¼Œå½“æ–‡ä»¶å­˜åœ¨å¹¶ä¸”æ²¡æœ‰ä¾èµ–æ–‡ä»¶ï¼ŒMakfile å°±æ²¡æœ‰åŠæ³•åˆ¤æ–­æ–‡ä»¶çš„æ–°æ—§<br />\nè¦è§£å†³è¿™ä¸ªé—®é¢˜å°±éœ€è¦ä½¿ç”¨åˆ° <code>.PHONY</code>  å…³é”®å­—ï¼Œè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªå‡è±¡ç›®æ ‡ï¼Œä¸ä¼šå»å¯¹æ¯”å’Œæ£€æµ‹æ–‡ä»¶è€Œæ˜¯ç›´æ¥æ‰§è¡Œ</p>\n<figure class=\"highlight makefile\"><figcaption data-lang=\"makefile\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin-target builtin\">.PHONY</span><span class=\"token punctuation\">:</span> clean <span class=\"token comment\"># æŠŠ clean å®šä¹‰ä¸ºå‡è±¡ç›®æ ‡.</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># å°±ä¸ä¼šåˆ¤æ–­åä¸º â€œcleanâ€ çš„æ–‡ä»¶æ˜¯å¦å­˜åœ¨</span></pre></td></tr></table></figure><h3 id=\"å…³é”®å­—\"><a class=\"anchor\" href=\"#å…³é”®å­—\">#</a> å…³é”®å­—</h3>\n<h4 id=\"vpath\"><a class=\"anchor\" href=\"#vpath\">#</a> vpath</h4>\n<p>ä½œç”¨ï¼šç”¨äºå®šä¹‰ make çš„æŸ¥æ‰¾è·¯å¾„.</p>\n<p>make çš„æŸ¥æ‰¾è·¯å¾„é»˜è®¤ä¸ºå½“å‰è·¯å¾„ï¼Œè€Œåœ¨æˆ‘ä»¬çš„å·¥ç¨‹ä¸­é€šå¸¸ä¼šæŠŠåŸæ–‡ä»¶æ”¾ç½®äºä¸åŒçš„ç›®å½•ä¸‹.<br />\n è¿™ä½¿å¾—å¦‚æœè¦å¼•ç”¨æŸä¸ªæ–‡ä»¶ï¼Œæˆ‘ä»¬å°±éœ€è¦è¿åŒæ–‡ä»¶çš„ç›®å½•ä¸€å—ç»™å‡ºï¼Œè¿™å°±å¾ˆç§‘å­¦.<br />\n ä¾‹å¦‚ï¼Œæˆ‘ä»¬æŠŠæŸä¸ªæ–‡ä»¶ç§»åŠ¨åˆ°äº†å…¶ä»–çš„ç›®å½•ä¸‹ï¼Œæˆ‘ä»¬å°±éœ€è¦å»ä¿®æ”¹ makefile<br />\n å…³é”®å­— <code>vpath</code>  å°±å¯ä»¥å®ç°è¿™ä¸ªåŠŸèƒ½</p>\n<h5 id=\"è¯­æ³•\"><a class=\"anchor\" href=\"#è¯­æ³•\">#</a> è¯­æ³•</h5>\n<p>1. <code>vpath &lt;pattern&gt; &lt;directories&gt;</code>  ä¸ºç¬¦åˆ pattern çš„æ–‡ä»¶æŒ‡å®š directories çš„æœç´¢è·¯å¾„ï¼›<br />\n2. <code>vpath &lt;pattern&gt;</code>  æ¸…é™¤ç¬¦åˆ pattern æ–‡ä»¶çš„æœç´¢è·¯å¾„ï¼›<br />\n3. <code>vpath</code>  æ¸…é™¤æ‰€æœ‰å·²è®¾ç½®å¥½çš„æœç´¢è·¯å¾„ã€‚</p>\n<h3 id=\"å˜é‡\"><a class=\"anchor\" href=\"#å˜é‡\">#</a> å˜é‡</h3>\n<p>Makefile æ˜¯ä¸€ç§è„šæœ¬è¯­è¨€ï¼Œæ‰€ä»¥å¿…ç„¶å°±ä¼šæœ‰å˜é‡</p>\n<p>Makefile å˜é‡åˆ†ä¸ºä¸¤ç§ å³æ—¶å˜é‡å’Œå»¶æ—¶å˜é‡</p>\n<h4 id=\"å³æ—¶å˜é‡\"><a class=\"anchor\" href=\"#å³æ—¶å˜é‡\">#</a> å³æ—¶å˜é‡</h4>\n<p>è¯­æ³•:  <code>A := xxx</code></p>\n<p>å¯¹äºå³ä½¿å˜é‡ä½¿ç”¨  <code>:=</code>  è¡¨ç¤ºï¼Œå®ƒçš„å€¼åœ¨å®šä¹‰çš„æ—¶å€™å·²ç»è¢«ç¡®å®šäº†</p>\n<h4 id=\"å»¶æ—¶å˜é‡\"><a class=\"anchor\" href=\"#å»¶æ—¶å˜é‡\">#</a> å»¶æ—¶å˜é‡</h4>\n<p>è¯­æ³•:  <code>B = xxx</code></p>\n<p>å¯¹äºå»¶æ—¶å˜é‡ä½¿ç”¨ <code>=</code>  è¡¨ç¤ºã€‚å®ƒåªæœ‰åœ¨ä½¿ç”¨åˆ°çš„æ—¶å€™æ‰ç¡®å®šï¼Œåœ¨å®šä¹‰ <code>/</code>  ç­‰äºæ—¶å¹¶æ²¡æœ‰ç¡®å®šä¸‹æ¥</p>\n<p>æƒ³ä½¿ç”¨å˜é‡çš„æ—¶å€™ä½¿ç”¨ <code>$</code>  æ¥å¼•ç”¨ï¼Œå¦‚æœä¸æƒ³çœ‹åˆ°å‘½ä»¤æ˜¯ï¼Œå¯ä»¥åœ¨å‘½ä»¤çš„å‰é¢åŠ ä¸Š <code>@</code> ç¬¦å·ï¼Œå°±ä¸ä¼šæ˜¾ç¤ºå‘½ä»¤æœ¬èº«.</p>\n<p>å½“æˆ‘ä»¬æ‰§è¡Œ make å‘½ä»¤çš„æ—¶å€™ï¼Œmake è¿™ä¸ªæŒ‡ä»¤æœ¬èº«ï¼Œä¼šæŠŠæ•´ä¸ª Makefile è¯»è¿›å»ï¼Œè¿›è¡Œå…¨éƒ¨åˆ†æï¼Œç„¶åè§£æé‡Œé¢çš„å˜é‡.</p>\n<h4 id=\"å¸¸ç”¨å˜é‡\"><a class=\"anchor\" href=\"#å¸¸ç”¨å˜é‡\">#</a> å¸¸ç”¨å˜é‡</h4>\n<p>å¸¸ç”¨çš„å˜é‡çš„å®šä¹‰å¦‚ä¸‹</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">å…³é”®å­—</th>\n<th style=\"text-align:left\">ä½œç”¨</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">:=</td>\n<td style=\"text-align:left\">å³æ—¶å˜é‡</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">=</td>\n<td style=\"text-align:left\">å»¶æ—¶å˜é‡</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">+=</td>\n<td style=\"text-align:left\">é™„åŠ ï¼Œå®ƒæ˜¯å³æ—¶å˜é‡è¿˜æ˜¯å»¶æ—¶å˜é‡å–å†³äºå‰é¢çš„å®šä¹‰</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">?=:</td>\n<td style=\"text-align:left\">å¦‚æœè¿™ä¸ªå˜é‡åœ¨å‰é¢å·²ç»è¢«å®šä¹‰äº†ï¼Œè¿™å¥è¯å°±ä¼šä¸ä¼šèµ·æ•ˆæœï¼Œ</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"ä¾‹å¦‚\"><a class=\"anchor\" href=\"#ä¾‹å¦‚\">#</a> ä¾‹å¦‚</h4>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>A :<span class=\"token operator\">=</span> <span class=\"token variable\"><span class=\"token variable\">$(</span>C<span class=\"token variable\">)</span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>B <span class=\"token operator\">=</span> <span class=\"token variable\"><span class=\"token variable\">$(</span>C<span class=\"token variable\">)</span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>C <span class=\"token operator\">=</span> abc</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>D <span class=\"token operator\">=</span> D</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>D ?<span class=\"token operator\">=</span> DD</pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>all:</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t@echo A <span class=\"token operator\">=</span> <span class=\"token variable\"><span class=\"token variable\">$(</span>A<span class=\"token variable\">)</span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t@echo B <span class=\"token operator\">=</span> <span class=\"token variable\"><span class=\"token variable\">$(</span>B<span class=\"token variable\">)</span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t@echo D <span class=\"token operator\">=</span> <span class=\"token variable\"><span class=\"token variable\">$(</span>D<span class=\"token variable\">)</span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>C <span class=\"token operator\">+=</span> <span class=\"token number\">123</span></pre></td></tr></table></figure><p>è®©æˆ‘ä»¬åˆ†æä¸€ä¸‹ç›¸å…³çš„é€»è¾‘:</p>\n<p>é¦–å…ˆ <code>A</code>  ä¸ºå³æ—¶å˜é‡ï¼Œåœ¨å®šä¹‰æœŸé—´ç¡®å®šï¼Œå¼€å§‹æ—¶  <code>C</code>  å€¼ä¸º ç©ºï¼Œæ‰€ä»¥  <code>A</code>  å€¼å¿…ä¸ºç©º</p>\n<p><code>B</code>  ä¸ºå»¶æ—¶å˜é‡ï¼Œåªæœ‰å½“ä½¿ç”¨åˆ°æ—¶å®ƒæ‰ä¼šè¢«ç¡®å®š.<br />\n åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­ï¼Œå½“æ‰§è¡Œ make æ—¶ï¼Œä¼šè§£æ Makefile é‡Œé¢çš„æ‰€ç”¨å˜é‡ï¼Œé¦–å…ˆä¼šè§£æåˆ°  <code>C=abc</code> , ç„¶åå†è§£æåˆ° <code>C+=123</code> <br />\n æ­¤æ—¶ <code>C=abc 123</code> , å½“æ‰§è¡Œåˆ° <code>@echo B = $(B)</code>  æ—¶ï¼Œ <code>B</code>  çš„å€¼ä¸º abc 123</p>\n<p><code>D ?= DD</code> ,  <code>D</code>  å˜é‡åœ¨å‰é¢å®šä¹‰äº† <code>D=D</code> , æ‰€ä»¥ <code>D</code>  çš„å€¼ä¸º <code>D</code> <br />\n å¦‚æœå†å‰é¢å»æ‰ <code>D=D</code>  è¿™å¥è¯ï¼Œé‚£ä¹ˆ <code>D</code>  çš„å€¼æœ€åä¸º <code>DD</code></p>\n<p>ä½¿ç”¨  <code>make</code>  æŒ‡ä»¤ï¼Œæ‰§è¡Œåå‘½ä»¤è¡Œç»ˆç«¯æ˜¾ç¤ºå¦‚ä¸‹</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ <span class=\"token function\">make</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>A <span class=\"token operator\">=</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>B <span class=\"token operator\">=</span> abc <span class=\"token number\">123</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>D <span class=\"token operator\">=</span> D</pre></td></tr></table></figure><h3 id=\"å‡½æ•°\"><a class=\"anchor\" href=\"#å‡½æ•°\">#</a> å‡½æ•°</h3>\n<p>Makefile å†…ç½®å¾ˆå¤šå‡½æ•°ï¼Œä½¿ç”¨ <code>$</code>  æ¥å¼•ç”¨å‡½æ•°ï¼Œæ¥ä¸‹å»ä»‹ç»å‡ ä¸ªå¸¸ç”¨çš„å‡½æ•°</p>\n<h4 id=\"foreach\"><a class=\"anchor\" href=\"#foreach\">#</a> foreach</h4>\n<p>è¯­æ³•:</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token variable\"><span class=\"token variable\">$(</span>foreach var,list,text<span class=\"token variable\">)</span></span></pre></td></tr></table></figure><p>å‰ä¸¤ä¸ªå‚æ•°ï¼Œ <code>var</code>  å’Œ <code>list</code> , å°†é¦–å…ˆæ‰©å±•ï¼Œæ³¨æ„æœ€åä¸€ä¸ªå‚æ•°  <code>text</code>  æ­¤æ—¶ä¸æ‰©å±•<br />\næ¥ç€ï¼Œå¯¹æ¯ä¸€ä¸ª  <code>list</code>  æ‰©å±•äº§ç”Ÿçš„å­—ï¼Œå°†ç”¨æ¥ä¸º  <code>var</code>  æ‰©å±•åå‘½åçš„å˜é‡èµ‹å€¼<br />\nç„¶å  <code>text</code>  å¼•ç”¨è¯¥å˜é‡æ‰©å±•ï¼›å› æ­¤å®ƒæ¯æ¬¡æ‰©å±•éƒ½ä¸ç›¸åŒã€‚ç»“æœæ˜¯ç”±ç©ºæ ¼éš”å¼€çš„  <code>text</code></p>\n<h5 id=\"ç¤ºä¾‹\"><a class=\"anchor\" href=\"#ç¤ºä¾‹\">#</a> ç¤ºä¾‹</h5>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>filenames <span class=\"token operator\">=</span> main func fun_b</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>objs <span class=\"token operator\">=</span> <span class=\"token variable\"><span class=\"token variable\">$(</span>foreach f, <span class=\"token operator\">&amp;</span><span class=\"token punctuation\">(</span>filenames<span class=\"token punctuation\">)</span>, <span class=\"token punctuation\">$(</span>f<span class=\"token punctuation\">)</span>.o<span class=\"token variable\">)</span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>all:</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t@echo objs <span class=\"token operator\">=</span> <span class=\"token variable\"><span class=\"token variable\">$(</span>objs<span class=\"token variable\">)</span></span></pre></td></tr></table></figure><p>æ‰§è¡Œç»“æœ</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>objs <span class=\"token operator\">=</span> main.o func.o fun_b.o</pre></td></tr></table></figure><h4 id=\"filterfilter-out\"><a class=\"anchor\" href=\"#filterfilter-out\">#</a> filter/filter-out</h4>\n<p>è¯­æ³•:</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token variable\"><span class=\"token variable\">$(</span>filter pattern<span class=\"token punctuation\">..</span>.,text<span class=\"token variable\">)</span></span>     <span class=\"token comment\"># åœ¨ text ä¸­å–å‡ºç¬¦åˆ patten æ ¼å¼çš„å€¼</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token variable\"><span class=\"token variable\">$(</span>filter-out pattern<span class=\"token punctuation\">..</span>.,text<span class=\"token variable\">)</span></span> <span class=\"token comment\"># åœ¨ text ä¸­å–å‡ºä¸ç¬¦åˆ patten æ ¼å¼çš„å€¼</span></pre></td></tr></table></figure><h5 id=\"ç¤ºä¾‹-2\"><a class=\"anchor\" href=\"#ç¤ºä¾‹-2\">#</a> ç¤ºä¾‹</h5>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">file</span> <span class=\"token operator\">=</span> a b c d/</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>D <span class=\"token operator\">=</span> <span class=\"token variable\"><span class=\"token variable\">$(</span>filter %/, <span class=\"token punctuation\">$(</span>C<span class=\"token punctuation\">)</span><span class=\"token variable\">)</span></span> <span class=\"token comment\"># é€‰å‡º æœ‰ / ç¬¦å·çš„éƒ¨åˆ†è¾“å‡º</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>E <span class=\"token operator\">=</span> <span class=\"token variable\"><span class=\"token variable\">$(</span>filter-out %/, <span class=\"token punctuation\">$(</span>C<span class=\"token punctuation\">)</span><span class=\"token variable\">)</span></span> <span class=\"token comment\"># é€‰å‡º æ²¡æœ‰  / ç¬¦å·çš„éƒ¨åˆ†è¾“å‡º</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>all:</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        @echo D <span class=\"token operator\">=</span> <span class=\"token variable\"><span class=\"token variable\">$(</span>D<span class=\"token variable\">)</span></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        @echo E <span class=\"token operator\">=</span> <span class=\"token variable\"><span class=\"token variable\">$(</span>E<span class=\"token variable\">)</span></span></pre></td></tr></table></figure><p>æ‰§è¡Œç»“æœ</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>D <span class=\"token operator\">=</span> d/</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>E <span class=\"token operator\">=</span> a b c</pre></td></tr></table></figure><h4 id=\"wildcard\"><a class=\"anchor\" href=\"#wildcard\">#</a> wildcard</h4>\n<p>è¯­æ³•å¦‚ä¸‹</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token variable\"><span class=\"token variable\">$(</span>wildcard pattern<span class=\"token variable\">)</span></span> <span class=\"token comment\"># pattern å®šä¹‰äº†æ–‡ä»¶åçš„æ ¼å¼ï¼Œwildcard å–å‡ºå…¶ä¸­å­˜åœ¨çš„æ–‡ä»¶</span></pre></td></tr></table></figure><h5 id=\"ç¤ºä¾‹-3\"><a class=\"anchor\" href=\"#ç¤ºä¾‹-3\">#</a> ç¤ºä¾‹</h5>\n<p>åœ¨æ‰§è¡Œç¤ºä¾‹ä¹‹å‰ï¼Œéœ€å°†åœ¨è¯¥ç›®å½•ä¸‹åˆ›å»ºä¸‰ä¸ªæ–‡ä»¶: a.c b.c c.c</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>files <span class=\"token operator\">=</span> <span class=\"token variable\"><span class=\"token variable\">$(</span>wildcard *.c<span class=\"token variable\">)</span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>all:</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    @echo files <span class=\"token operator\">=</span> <span class=\"token variable\"><span class=\"token variable\">$(</span>files<span class=\"token variable\">)</span></span></pre></td></tr></table></figure><p>æ‰§è¡Œç»“æœ:</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>files <span class=\"token operator\">=</span> a.c b.c c.c</pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥ç”¨ wildcard å‡½æ•°æ¥åˆ¤æ–­ï¼ŒçœŸå®å­˜åœ¨çš„æ–‡ä»¶<br />\nè¿™æ ·å¯ä»¥é¿å…å‡ºç°ç¼–è¯‘åˆ°ä¸å­˜åœ¨çš„æ–‡ä»¶ç„¶åæŠ¥é”™</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>files2 <span class=\"token operator\">=</span> a.c b.c c.c d.c e.c  abc</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>files3 <span class=\"token operator\">=</span> <span class=\"token variable\"><span class=\"token variable\">$(</span>wildcard <span class=\"token punctuation\">$(</span>files2<span class=\"token punctuation\">)</span><span class=\"token variable\">)</span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>all:</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    @echo files3 <span class=\"token operator\">=</span> <span class=\"token variable\"><span class=\"token variable\">$(</span>files3<span class=\"token variable\">)</span></span></pre></td></tr></table></figure><h4 id=\"patsubst\"><a class=\"anchor\" href=\"#patsubst\">#</a> patsubst</h4>\n<h5 id=\"ç¤ºä¾‹-4\"><a class=\"anchor\" href=\"#ç¤ºä¾‹-4\">#</a> ç¤ºä¾‹</h5>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>files2  <span class=\"token operator\">=</span> a.c b.c c.c d.c e.c abc</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>dep_files <span class=\"token operator\">=</span> <span class=\"token variable\"><span class=\"token variable\">$(</span>patsubst %.c,%.d,<span class=\"token punctuation\">$(</span>files2<span class=\"token punctuation\">)</span><span class=\"token variable\">)</span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>all:</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    @echo dep_files <span class=\"token operator\">=</span> <span class=\"token variable\"><span class=\"token variable\">$(</span>dep_files<span class=\"token variable\">)</span></span></pre></td></tr></table></figure><p>æ‰§è¡Œç»“æœ:</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>dep_files <span class=\"token operator\">=</span> a.d b.d c.d d.d e.d abc</pre></td></tr></table></figure><h4 id=\"addprefix\"><a class=\"anchor\" href=\"#addprefix\">#</a> addprefix</h4>\n<p>è¯­æ³•:  <code>$(addprefix &lt;prefix&gt;, &lt;name-1&gt;, &lt;name-2&gt;...&lt;name-n&gt;)</code></p>\n<p>ä½œç”¨ï¼šæŠŠå‰ç¼€ prefix åŠ åˆ° name å‰é¢</p>\n<p>ä¾‹å¦‚ï¼Œä¸‹é¢è¿™æ®µä»£ç ï¼Œæœ€ç»ˆ  <code>OBJECTS = build/main.o</code></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>BUILD_DIR <span class=\"token operator\">=</span> build</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>OBJECTS <span class=\"token operator\">=</span> <span class=\"token variable\"><span class=\"token variable\">$(</span>addprefix <span class=\"token punctuation\">$(</span>BUILD_DIR<span class=\"token punctuation\">)</span>/, main.o<span class=\"token variable\">)</span></span></pre></td></tr></table></figure><h4 id=\"notdir\"><a class=\"anchor\" href=\"#notdir\">#</a> notdir</h4>\n<p>è¯­æ³•:  <code>$(notdir , &lt;name-1&gt;, &lt;name-2&gt;...&lt;name-n&gt; )</code></p>\n<p>ä½œç”¨ï¼šå­—ç¬¦ä¸²ä¸­çš„è·¯å¾„å»æ‰</p>\n<p>ä¾‹å¦‚ï¼Œä¸‹é¢è¿™æ®µä»£ç ï¼Œæœ€ç»ˆ  <code>OBJECTS = main.c</code></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>C_SOURCES <span class=\"token operator\">=</span> src/main.c</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>OBJECTS <span class=\"token operator\">=</span> <span class=\"token variable\"><span class=\"token variable\">$(</span>notdir<span class=\"token punctuation\">$(</span>C_SOURCES<span class=\"token punctuation\">)</span><span class=\"token variable\">)</span></span></pre></td></tr></table></figure><h4 id=\"dir\"><a class=\"anchor\" href=\"#dir\">#</a> dir</h4>\n<p>è¯­æ³•:  <code>$(dir Name)</code></p>\n<p>ä½œç”¨ï¼šä»æ–‡ä»¶ååºåˆ— <code>NAMESâ€¦</code>  ä¸­å–å‡ºå„ä¸ªæ–‡ä»¶åçš„ç›®å½•éƒ¨ï¼ŒåŒ…å« <code>/</code></p>\n<p>ä¾‹å¦‚ï¼Œä¸‹é¢è¿™æ®µä»£ç ï¼Œæœ€ç»ˆ <code>OBJECTS=06_example/src/</code></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>OBJECTS <span class=\"token operator\">=</span>   <span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">dir</span>  06_example/src/main.c<span class=\"token variable\">)</span></span></pre></td></tr></table></figure><h4 id=\"sort\"><a class=\"anchor\" href=\"#sort\">#</a> sort</h4>\n<p>è¯­æ³•:  <code>$(sort &lt;List&gt;)</code></p>\n<p>ä½œç”¨ï¼šç»™å­—ä¸² â€œLISTâ€ ä¸­çš„å•è¯ä»¥é¦–å­—æ¯ä¸ºå‡†è¿›è¡Œæ’åº (å‡åº), å¹¶ä¸”å»é™¤é‡å¤</p>\n<p>ä¾‹å¦‚ï¼Œä¸‹é¢è¿™æ®µä»£ç ï¼Œæœ€ç»ˆ <code>OBJECTS=06_example/src/</code></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>C_SOURCE <span class=\"token operator\">=</span> 06_example/src/main.c \t<span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>06_example/src/func_a.c \t<span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>06_example/src/func_b.c \t</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>OBJECTS <span class=\"token operator\">=</span>   <span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">sort</span> <span class=\"token punctuation\">$(</span>dir <span class=\"token punctuation\">$(</span>C_SOURCE<span class=\"token punctuation\">)</span><span class=\"token variable\">)</span></span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h2 id=\"ä¸€ä¸ªmakefileä¾‹å­\"><a class=\"anchor\" href=\"#ä¸€ä¸ªmakefileä¾‹å­\">#</a> ä¸€ä¸ª Makefile ä¾‹å­</h2>\n<p>çœ‹äº†è¿™ä¹ˆå¤šï¼Œæ¥è¯•ç€å†™ä¸€ä»½ makefile</p>\n<p>å’±ä»¬è§„å®š æ‰€æœ‰çš„  <code>.c</code>  éƒ½å­˜æ”¾åœ¨  <code>src</code>  æ–‡ä»¶å¤¹ä¸­ï¼›æ‰€æœ‰çš„  <code>.h</code>  æ–‡ä»¶éƒ½å­˜æ”¾åœ¨  <code>inc</code>  æ–‡ä»¶å¤¹ä¸­ï¼›æ‰€æœ‰ ç¼–è¯‘ç”Ÿæˆçš„ æ–‡ä»¶éƒ½è¦å­˜æ”¾åœ¨  <code>obj</code>  ä¸­</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">######################################</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># target</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">######################################</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># ä½ çš„é¡¹ç›®</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>TARGET <span class=\"token operator\">=</span> <span class=\"token builtin class-name\">test</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">#######################################</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\"># paths</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\">#######################################</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\"># è¿‡ç¨‹æ–‡ä»¶çš„å­˜æ”¾è·¯å¾„ï¼Œä»¥åŠ.exe</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>BUILD_DIR <span class=\"token operator\">=</span> build</pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\">######################################</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\"># source</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\">######################################</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token comment\">#.c æºç </span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token comment\"># C sources</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>C_SOURCES <span class=\"token operator\">=</span>  <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>src/main.c\t<span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>src/func_a.c <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>src/func_b.c <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>src/func_c.c </pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token comment\">#######################################</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token comment\"># ç¼–è¯‘å™¨</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token comment\">#######################################</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>CC <span class=\"token operator\">=</span> gcc</pre></td></tr><tr><td data-num=\"29\"></td><td><pre></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token comment\">#######################################</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token comment\"># CFLAGS</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token comment\">#######################################</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token comment\"># å¤´æ–‡ä»¶ -I ä¸èƒ½çœç•¥</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token comment\"># C includes</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>C_INCLUDES <span class=\"token operator\">=</span>  <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token parameter variable\">-IInc</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre></pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token comment\"># ä¼˜åŒ–ç­‰çº§</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>OPT <span class=\"token operator\">=</span> <span class=\"token parameter variable\">-O0</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre></pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token comment\"># ç»Ÿä¸€ç”Ÿæˆé…ç½®å˜é‡</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>CFLAGS <span class=\"token operator\">=</span>  <span class=\"token variable\"><span class=\"token variable\">$(</span>C_INCLUDES<span class=\"token variable\">)</span></span> <span class=\"token variable\"><span class=\"token variable\">$(</span>OPT<span class=\"token variable\">)</span></span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre></pre></td></tr><tr><td data-num=\"44\"></td><td><pre><span class=\"token comment\"># æœ€ç»ˆç›®æ ‡æ–‡ä»¶</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>all: <span class=\"token variable\"><span class=\"token variable\">$(</span>BUILD_DIR<span class=\"token variable\">)</span></span>/<span class=\"token variable\"><span class=\"token variable\">$(</span>TARGET<span class=\"token variable\">)</span></span>.exe</pre></td></tr><tr><td data-num=\"46\"></td><td><pre></pre></td></tr><tr><td data-num=\"47\"></td><td><pre><span class=\"token comment\">#######################################</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre><span class=\"token comment\"># ç¼–è¯‘åº”ç”¨</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre><span class=\"token comment\">#######################################</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre><span class=\"token comment\"># .o æ–‡ä»¶åˆ—è¡¨</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre><span class=\"token comment\"># addprefix è´Ÿè´£ç»™ æ¯ä¸ªå¯¹åº”çš„.c ç”Ÿæˆçš„.o ä¾èµ–æ–‡ä»¶æ·»åŠ ä¸Šå­˜å‚¨è·¯å¾„</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre><span class=\"token comment\"># C_SOURCES é‡Œæ‰€æœ‰ä»¥.c ç»“å°¾çš„æ–‡ä»¶æ›¿æ¢ä¸º.o ç»“å°¾çš„æ–‡ä»¶</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre><span class=\"token comment\"># main.c -> build/main.o</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>OBJECTS <span class=\"token operator\">=</span> <span class=\"token variable\"><span class=\"token variable\">$(</span>addprefix <span class=\"token punctuation\">$(</span>BUILD_DIR<span class=\"token punctuation\">)</span>/,<span class=\"token punctuation\">$(</span>notdir <span class=\"token punctuation\">$(</span>C_SOURCES:.c<span class=\"token operator\">=</span>.o<span class=\"token punctuation\">)</span><span class=\"token variable\">)</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre><span class=\"token comment\"># å°† .c æ–‡ä»¶ æ‰€åœ¨çš„ç›®å½•è¿›è¡Œæ±‡æ€»å’Œå»é‡ï¼Œæ·»åŠ åˆ°æŸ¥æ‰¾è·¯å¾„ä¸­</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>vpath %.c <span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">sort</span> <span class=\"token punctuation\">$(</span>dir <span class=\"token punctuation\">$(</span>C_SOURCES<span class=\"token punctuation\">)</span><span class=\"token variable\">)</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre></pre></td></tr><tr><td data-num=\"58\"></td><td><pre><span class=\"token variable\"><span class=\"token variable\">$(</span>BUILD_DIR<span class=\"token variable\">)</span></span>/%.o: %.c Makefile <span class=\"token operator\">|</span> <span class=\"token variable\"><span class=\"token variable\">$(</span>BUILD_DIR<span class=\"token variable\">)</span></span> </pre></td></tr><tr><td data-num=\"59\"></td><td><pre>\t<span class=\"token variable\"><span class=\"token variable\">$(</span>CC<span class=\"token variable\">)</span></span> <span class=\"token variable\"><span class=\"token variable\">$(</span>CFLAGS<span class=\"token variable\">)</span></span> <span class=\"token parameter variable\">-c</span>  $<span class=\"token operator\">&lt;</span> <span class=\"token parameter variable\">-o</span> <span class=\"token variable\">$@</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre></pre></td></tr><tr><td data-num=\"61\"></td><td><pre></pre></td></tr><tr><td data-num=\"62\"></td><td><pre><span class=\"token variable\"><span class=\"token variable\">$(</span>BUILD_DIR<span class=\"token variable\">)</span></span>/<span class=\"token variable\"><span class=\"token variable\">$(</span>TARGET<span class=\"token variable\">)</span></span>.exe: <span class=\"token variable\"><span class=\"token variable\">$(</span>OBJECTS<span class=\"token variable\">)</span></span> Makefile</pre></td></tr><tr><td data-num=\"63\"></td><td><pre>\t<span class=\"token variable\"><span class=\"token variable\">$(</span>CC<span class=\"token variable\">)</span></span> <span class=\"token variable\"><span class=\"token variable\">$(</span>CFLAGS<span class=\"token variable\">)</span></span> <span class=\"token variable\"><span class=\"token variable\">$(</span>OBJECTS<span class=\"token variable\">)</span></span> <span class=\"token parameter variable\">-o</span> <span class=\"token variable\">$@</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>\t</pre></td></tr><tr><td data-num=\"65\"></td><td><pre>\t</pre></td></tr><tr><td data-num=\"66\"></td><td><pre><span class=\"token variable\"><span class=\"token variable\">$(</span>BUILD_DIR<span class=\"token variable\">)</span></span><span class=\"token builtin class-name\">:</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>\t<span class=\"token function\">mkdir</span> <span class=\"token variable\">$@</span>\t\t</pre></td></tr><tr><td data-num=\"68\"></td><td><pre></pre></td></tr><tr><td data-num=\"69\"></td><td><pre><span class=\"token comment\">#######################################</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre><span class=\"token comment\"># clean up</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre><span class=\"token comment\">#######################################</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>.PHONY:</pre></td></tr><tr><td data-num=\"73\"></td><td><pre>clean:</pre></td></tr><tr><td data-num=\"74\"></td><td><pre>\t<span class=\"token parameter variable\">-rm</span> <span class=\"token parameter variable\">-fR</span> <span class=\"token variable\"><span class=\"token variable\">$(</span>BUILD_DIR<span class=\"token variable\">)</span></span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre></pre></td></tr><tr><td data-num=\"76\"></td><td><pre><span class=\"token comment\"># *** EOF ***</span></pre></td></tr></table></figure><hr />\n<p>å¤§é“äº”åï¼Œå¤©è¡å››åä¹ï¼Œäººéå…¶ä¸€ï¼</p>\n",
            "tags": [
                "Makefile",
                "Makefile"
            ]
        },
        {
            "id": "https://to-ywz.github.io/Embedded/STM32/GCC%E7%BC%96%E8%AF%91%E8%BF%87%E7%A8%8B/",
            "url": "https://to-ywz.github.io/Embedded/STM32/GCC%E7%BC%96%E8%AF%91%E8%BF%87%E7%A8%8B/",
            "title": "GCCç¼–è¯‘è¿‡ç¨‹",
            "date_published": "2023-07-02T15:33:07.000Z",
            "content_html": "<h1 id=\"gcc-ç¼–è¯‘è¿‡ç¨‹\"><a class=\"anchor\" href=\"#gcc-ç¼–è¯‘è¿‡ç¨‹\">#</a> GCC ç¼–è¯‘è¿‡ç¨‹</h1>\n<h2 id=\"ç¼–è¯‘æ­¥éª¤\"><a class=\"anchor\" href=\"#ç¼–è¯‘æ­¥éª¤\">#</a> ç¼–è¯‘æ­¥éª¤</h2>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/001_4_steps.3jiznekrxq2.jpg\" alt=\"001_4_steps\" /></p>\n<p>ä¸€èˆ¬æ¥è¯´ï¼Œç¼–è¯‘æ­¥éª¤åˆ†ä¸º</p>\n<ol>\n<li>é¢„å¤„ç†ï¼šå°†å¤´æ–‡ä»¶å’Œå®è¿›è¡Œæ›¿æ¢</li>\n<li>ç¼–è¯‘ï¼šå°†é¢„ç¼–è¯‘åçš„ C è¯­è¨€æ–‡ä»¶ï¼Œç¼–è¯‘ä¸ºæ±‡ç¼–æ–‡ä»¶</li>\n<li>æ±‡ç¼–ï¼šå°†æ±‡ç¼–æ–‡ä»¶ç¼–è¯‘ä¸º n ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶</li>\n<li>é“¾æ¥ï¼šå°†äºŒè¿›åˆ¶æ–‡ä»¶é“¾æ¥ä¸ºä¸€ä¸ª</li>\n</ol>\n<h2 id=\"gcc-çš„ä½¿ç”¨æ–¹æ³•\"><a class=\"anchor\" href=\"#gcc-çš„ä½¿ç”¨æ–¹æ³•\">#</a> GCC çš„ä½¿ç”¨æ–¹æ³•</h2>\n<figure class=\"highlight makefile\"><figcaption data-lang=\"makefile\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>gcc [option] filename</pre></td></tr></table></figure><h3 id=\"21-gccä½¿ç”¨ç¤ºä¾‹\"><a class=\"anchor\" href=\"#21-gccä½¿ç”¨ç¤ºä¾‹\">#</a> 2.1 gcc ä½¿ç”¨ç¤ºä¾‹</h3>\n<p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬è¦ ç¼–è¯‘ä¸€ä¸ª</p>\n<pre><code>gcc main.c                   // è¾“å‡ºä¸€ä¸ªåä¸ºa.outçš„å¯æ‰§è¡Œç¨‹åº, ç„¶åå¯ä»¥æ‰§è¡Œ./a.out\ngcc -o hello main.c          // è¾“å‡ºåä¸ºhelloçš„å¯æ‰§è¡Œç¨‹åº, ç„¶åå¯ä»¥æ‰§è¡Œ./hello\ngcc -o hello main.c -static  // é™æ€é“¾æ¥\n\ngcc -c -o hello.o main.c  // å…ˆç¼–è¯‘(ä¸é“¾æ¥)\ngcc -o hello hello.o       // å†é“¾æ¥\n</code></pre>\n<p>é™æ€é“¾æ¥ä¼šå°†æ¶‰åŠåˆ°çš„åº“  <code>.os</code>  æ–‡ä»¶éƒ½è£…è½½åˆ°äºŒè¿›åˆ¶æ–‡ä»¶ä¸­ï¼Œæ‰€ä»¥æ–‡ä»¶ä¼šç›¸å¯¹çš„å¤§å¾—å¤š<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.47ptc5o31xq0.jpg\" alt=\"image\" /><br />\n ä½†æ˜¯åœ¨ windows, åŠ¨æ€ç¼–è¯‘å’Œé™æ€ç¼–è¯‘æ–‡ä»¶å¤§å°ä¸€è‡´ï¼Œå¯èƒ½å’Œåº“æ–‡ä»¶çš„æ„æˆç›¸å…³<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.28wduvqtc49w.jpg\" alt=\"image\" /></p>\n<h3 id=\"gcc-å¸¸ç”¨é€‰é¡¹\"><a class=\"anchor\" href=\"#gcc-å¸¸ç”¨é€‰é¡¹\">#</a> gcc å¸¸ç”¨é€‰é¡¹</h3>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">é€‰é¡¹</th>\n<th style=\"text-align:center\">åŠŸèƒ½</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">-v</td>\n<td style=\"text-align:center\">æŸ¥çœ‹ gcc ç¼–è¯‘å™¨çš„ç‰ˆæœ¬ï¼Œæ˜¾ç¤º gcc æ‰§è¡Œæ—¶çš„è¯¦ç»†è¿‡ç¨‹</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">-o <code>&lt;file&gt;</code></td>\n<td style=\"text-align:center\">æŒ‡å®šè¾“å‡ºæ–‡ä»¶åä¸º file, è¿™ä¸ªåç§°ä¸èƒ½è·Ÿæºæ–‡ä»¶ååŒå</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">-E</td>\n<td style=\"text-align:center\">åªé¢„å¤„ç†ï¼Œä¸ä¼šç¼–è¯‘ã€æ±‡ç¼–ã€é“¾æ¥ t</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">-S</td>\n<td style=\"text-align:center\">åªç¼–è¯‘ï¼Œä¸ä¼šæ±‡ç¼–ã€é“¾æ¥</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">-c</td>\n<td style=\"text-align:center\">ç¼–è¯‘å’Œæ±‡ç¼–ï¼Œä¸ä¼šé“¾æ¥</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"æ‰‹åŠ¨ç¼–è¯‘æµç¨‹\"><a class=\"anchor\" href=\"#æ‰‹åŠ¨ç¼–è¯‘æµç¨‹\">#</a> æ‰‹åŠ¨ç¼–è¯‘æµç¨‹</h4>\n<p>å¦‚ä¸€å¼€å§‹æ‰€è¯´çš„ä¸€ä¸ª c/c++ æ–‡ä»¶è¦ç»è¿‡ é¢„å¤„ç† ã€ ç¼–è¯‘ ã€ æ±‡ç¼– å’Œ é“¾æ¥ æ‰èƒ½å˜æˆå¯æ‰§è¡Œæ–‡ä»¶</p>\n<h5 id=\"é¢„å¤„ç†\"><a class=\"anchor\" href=\"#é¢„å¤„ç†\">#</a> é¢„å¤„ç†</h5>\n<p>åœ¨ C/C++ æºæ–‡ä»¶ä¸­ï¼Œä»¥ â€œ#â€ å¼€å¤´çš„è¯­å¥è¢«ç§°ä¸ºé¢„å¤„ç†å‘½ä»¤<br />\nä¾‹å¦‚ï¼ŒåŒ…å«å‘½ä»¤ â€œ#includeâ€ã€å®å®šä¹‰å‘½ä»¤ â€œ#defineâ€ã€æ¡ä»¶ç¼–è¯‘å‘½ä»¤ â€œ#ifâ€ã€â€œ#ifdefâ€ ç­‰</p>\n<p>é¢„å¤„ç†å°±æ˜¯å°†è¦åŒ…å« (include) çš„æ–‡ä»¶æ’å…¥åŸæ–‡ä»¶ä¸­ã€å°†å®å®šä¹‰å±•å¼€ã€æ ¹æ®æ¡ä»¶ç¼–è¯‘å‘½ä»¤é€‰æ‹©è¦ä½¿ç”¨çš„ä»£ç ï¼Œæœ€åå°†è¿™äº›ä¸œè¥¿è¾“å‡ºåˆ°ä¸€ä¸ª â€œ.iâ€ æ–‡ä»¶ä¸­ç­‰å¾…è¿›ä¸€æ­¥å¤„ç†<br />\nåœ¨è¿™ä¸€æ­¥ä¸æ£€æµ‹è¯­æ³•é”™è¯¯ï¼Œåœ¨é¢„å¤„ç†ä¹‹åæ–‡ä»¶è¿˜æ˜¯  <code>C</code>  æ–‡ä»¶</p>\n<p>å¯¹åº”çš„æŒ‡ä»¤ä¸º</p>\n<pre><code>gcc -E -o filename.i filename.c\n```makefile\n\nç¼–è¯‘å‰çš„æºæ–‡ä»¶\n```C\n#include &lt;stdio.h&gt;\n\n#define MAX_VALUE 10\n\nint main(int argc, char const *argv[])\n&#123;\n    printf(&quot;%d\\r\\n&quot;, MAX_VALUE);\n\n    return 0;\n&#125;\n\n</code></pre>\n<p>ç¼–è¯‘åï¼Œå¯ä»¥çœ‹åˆ°  <code>printf</code>  ä¸­çš„  <code>MAX_VALUE</code>  è¢«æ›¿æ¢ä¸º 10<br />\n è€Œä¸”ä»£ç é‡æ˜æ˜¾å¤šäº†å¾ˆå¤šä¸œè¥¿ï¼Œè¿™äº›å¤§éƒ¨åˆ†éƒ½æ˜¯  <code>stdio</code>  å†…éƒ¨çš„æ–‡ä»¶<br />\nè¿™ä¹Ÿå‘Šè¯‰æˆ‘ä»¬ï¼Œä¸€å¥è¾“å‡ºå¹¶æ²¡æœ‰æƒ³è±¡çš„é‚£ä¹ˆç®€å•ï¼Œæœºå™¨èƒŒååšäº†å¾ˆå¤šçš„ä»»åŠ¡<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.1o2aauvs9nkw.jpg\" alt=\"image\" /></p>\n<h5 id=\"ç¼–è¯‘\"><a class=\"anchor\" href=\"#ç¼–è¯‘\">#</a> ç¼–è¯‘</h5>\n<p>ç¼–è¯‘æ˜¯å°†é¢„å¤„ç†è¿‡çš„ C/C++ ä»£ç  (ä¾‹å¦‚ä¸Šè¿°çš„ â€œ.iâ€ æ–‡ä»¶)â€œç¿»è¯‘â€ æˆæ±‡ç¼–ä»£ç <br />\nç¿»è¯‘çš„ä»£ç é•¿çŸ­å’Œå†…å­˜å¤§å°ï¼Œå–å†³äºä¼˜åŒ–ç­‰çº§å’Œç¼–è¯‘å™¨çš„ç®—æ³•<br />\nåœ¨è¿™ä¸€æ­¥å°±ä¼šè¿›è¡Œè¯­æ³•æ£€æµ‹ï¼Œæ¯•ç«Ÿæ˜¯ä¸€ç§è¯­è¨€ç¿»è¯‘ä¸ºå¦ä¸€ç§è¯­è¨€ï¼Œå…ˆå¾—æ£€æµ‹è¯æ³•ã€è¯­æ³•ä»¥åŠè¯­æ„ï¼Œç¡®ä¿åŸè¯­è¨€æ²¡æœ‰é”™è¯¯ä¹‹åæ‰èƒ½è¿›è¡Œç¿»è¯‘</p>\n<p>å¯¹åº”çš„æŒ‡ä»¤:</p>\n<figure class=\"highlight makefile\"><figcaption data-lang=\"makefile\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>gcc -S -o filename.s filename.i</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>// æˆ–</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>gcc -S -o filename.s filename.c</pre></td></tr></table></figure><p>ç¼–è¯‘åä¸Šé¢çš„.i æ–‡ä»¶å˜æˆï¼Œå°†ä¼šç”Ÿæˆå¯¹åº”çš„æ±‡ç¼–æ–‡ä»¶<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.1215pjqeayjk.jpg\" alt=\"image\" /></p>\n<p>å¦‚æœæ·»åŠ   <code>-O1</code>  çš„ä¼˜åŒ–é€‰é¡¹å°±ä¼šå‡ºç°ä¸ä¸€æ ·çš„ä»£ç ï¼Œæ•ˆæœå¦‚ä¸‹å›¾<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.57dvtombnc40.jpg\" alt=\"image\" /></p>\n<p>æŒ‰ç…§ gcc çš„ä»‹ç»ï¼Œè¶Šé«˜ä¼˜å…ˆçº§çš„ä»£ç æ‰§è¡Œæ•ˆç‡è¶Šé«˜ï¼Œå çš„ RAM ä¹Ÿä¼šå‡å°‘</p>\n<p>ä½†æ˜¯ï¼Œæ¯•ç«Ÿç¼–è¯‘å™¨ä¸æ˜¯äººï¼Œå®ƒè§£å†³é—®é¢˜çš„æ€è·¯å¾ˆæœ‰å¯èƒ½æ˜¯å±€éƒ¨æœ€ä¼˜ï¼Œå…¨å±€è´ªå¿ƒï¼Œè¿™å°±å¯èƒ½å¯¼è‡´ä¸€äº›ç´¯åŠ é€»è¾‘è¢«ä¼˜åŒ–<br />\nä¾‹å¦‚:</p>\n<pre><code class=\"language-C\">void iic_delay(uitn8_t ntime)\n&#123;\n  while(ntime--)\n    ;\n&#125;\n</code></pre>\n<p>å¯¹äºä¸Šé¢è¿™ç§ä»£ç  ä½¿ç”¨  <code>-O3</code>  çš„ä¼˜åŒ–ç­‰çº§ï¼Œå¯èƒ½å°±ä¼šè¢«ä¼˜åŒ–<br />\nä¸ä»…å¦‚æ­¤ï¼Œè¶Šé«˜ä¼˜å…ˆçº§çš„ä¼˜åŒ–ï¼Œåœ¨ä»£ç è°ƒè¯•çš„æ—¶å€™å°±ä¼šå­˜åœ¨è¶Šå¤§çš„å›°éš¾ï¼Œå› ä¸ºç”Ÿæˆæ±‡ç¼–æ–‡ä»¶å·²ç»å’ŒåŸæœ¬çš„ C è¯­è¨€ç›¸å·®ç”šè¿œï¼Œå°½ç®¡èƒ½æ­£å¸¸æ‰§è¡Œï¼Œä½†ä¸€æ—¦å‡ºé”™å°±å¾ˆéš¾å®šä½é”™è¯¯</p>\n<h6 id=\"ä¼˜åŒ–å‚æ•°è¡¨\"><a class=\"anchor\" href=\"#ä¼˜åŒ–å‚æ•°è¡¨\">#</a> ä¼˜åŒ–å‚æ•°è¡¨</h6>\n<table>\n<thead>\n<tr>\n<th>ç±»å‹</th>\n<th>åŠŸèƒ½</th>\n<th>è¯´æ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>O0</td>\n<td>ä¸è¿›è¡Œä¼˜åŒ–</td>\n<td>é»˜è®¤ä¸åŠ å°±æ˜¯ O0</td>\n</tr>\n<tr>\n<td>O1</td>\n<td>ä¼˜åŒ–ç­‰çº§ 1</td>\n<td>\\</td>\n</tr>\n<tr>\n<td>O2</td>\n<td>ä¼˜åŒ–ç­‰çº§ 2</td>\n<td>\\</td>\n</tr>\n<tr>\n<td>O3</td>\n<td>ä¼˜åŒ–ç­‰çº§ 3</td>\n<td>\\</td>\n</tr>\n<tr>\n<td>Og</td>\n<td>ä¼˜åŒ–ç­‰çº§ 1, å¹¶ç”Ÿæˆè°ƒè¯•ä¿¡æ¯</td>\n<td>åœ¨ O1 ä¼˜åŒ–çš„åŸºç¡€ä¸Šä¿ç•™è°ƒè¯•ä¿¡æ¯ï¼Œå½“ç„¶è¦é…åˆ <code>-g</code>  ä¸€èµ·ä½¿ç”¨</td>\n</tr>\n<tr>\n<td>Os</td>\n<td>ä¼˜åŒ–ç­‰çº§ 2, å»æ‰åå‘ä¼˜åŒ–</td>\n<td>ä¸æ˜¯æ‰€æœ‰çš„ä¼˜åŒ–éƒ½ä¼šå‡å°ç©ºé—´ï¼Œå½“å‡ºç°ä¼˜åŒ–åè€Œå˜å¤§å¯ä»¥ä½¿ç”¨ - Os</td>\n</tr>\n<tr>\n<td>Ofast</td>\n<td>ä¼˜åŒ–ç­‰çº§ 3, é€šè¿‡éå¸¸è§„çš„æ–¹å¼è¿›è¡Œä¼˜åŒ–</td>\n<td>é€šè¿‡æ‰“ç ´ä¸€äº›å›½é™…æ ‡å‡† (æ¯”å¦‚ä¸€äº›æ•°å­¦å‡½æ•°çš„å®ç°æ ‡å‡†) æ¥å®ç°çš„ï¼Œä¸€èˆ¬ä¸æ¨è</td>\n</tr>\n</tbody>\n</table>\n<h5 id=\"æ±‡ç¼–\"><a class=\"anchor\" href=\"#æ±‡ç¼–\">#</a> æ±‡ç¼–</h5>\n<p>æ±‡ç¼–æ˜¯å°†ç¬¬äºŒæ­¥è¾“å‡ºçš„æ±‡ç¼–ä»£ç ç¿»è¯‘æˆç¬¦åˆä¸€å®šæ ¼å¼çš„æœºå™¨ä»£ç .<br />\n åœ¨ Linux ç³»ç»Ÿä¸Šä¸€èˆ¬è¡¨ç°ä¸º ELF ç›®æ ‡æ–‡ä»¶ (OBJ æ–‡ä»¶).</p>\n<p>æœ€æ˜æ˜¾çš„å°±æ˜¯ä½¿ç”¨ keil æ—¶ä¼šç”Ÿæˆå¤§é‡çš„ <code>xx.o</code>  æ–‡ä»¶ï¼Œè¿™äº›éƒ½æ˜¯ç¼–è¯‘å‡ºæ¥</p>\n<p>å¯¹åº”çš„æ‰§è¡Œå‘½ä»¤å¦‚ä¸‹:</p>\n<figure class=\"highlight makefile\"><figcaption data-lang=\"makefile\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>gcc -o filename.o filename.s</pre></td></tr></table></figure><p>â€œåæ±‡ç¼–â€ æ˜¯æŒ‡å°†æœºå™¨ä»£ç è½¬æ¢ä¸ºæ±‡ç¼–ä»£ç ï¼Œè¿™ä¸ªåŠŸèƒ½å¾€å¾€åœ¨ç¨‹åºè°ƒè¯•ä¸­ä½¿ç”¨<br />\nåæ±‡ç¼–çš„ä»£ç å’Œæ±‡ç¼–çš„ä»£ç å¤§æ¦‚ç‡ä¸ç›¸åŒ</p>\n<h5 id=\"é“¾æ¥\"><a class=\"anchor\" href=\"#é“¾æ¥\">#</a> é“¾æ¥</h5>\n<p>é“¾æ¥å°±æ˜¯å°†ä¸Šæ­¥ç”Ÿæˆçš„ OBJ æ–‡ä»¶å’Œç³»ç»Ÿåº“çš„ OBJ æ–‡ä»¶ã€åº“æ–‡ä»¶é“¾æ¥èµ·æ¥ï¼Œæœ€ç»ˆç”Ÿæˆäº†å¯ä»¥åœ¨ç‰¹å®šå¹³å°è¿è¡Œçš„å¯æ‰§è¡Œæ–‡ä»¶</p>\n<figure class=\"highlight makefile\"><figcaption data-lang=\"makefile\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>gcc -o filename filename0.o filename1.o filename2.o</pre></td></tr></table></figure><h4 id=\"æ›´å¿«æ·çš„æ–¹æ³•\"><a class=\"anchor\" href=\"#æ›´å¿«æ·çš„æ–¹æ³•\">#</a> æ›´å¿«æ·çš„æ–¹æ³•</h4>\n<p>ä¸€èˆ¬æ¥è¯´æˆ‘ä»¬ä¸ä¼šéœ€è¦æŸ¥çœ‹ <code>x.i</code>  å’Œ <code>x.s</code>  æ–‡ä»¶ï¼Œæ‰€ä»¥å¯ä»¥è·³è¿‡è¿™ä¸¤ä¸ªæ­¥éª¤ï¼Œç›´æ¥ç”Ÿæˆ `x.o, ç„¶åå†è¿›è¡Œé“¾æ¥<br />\næ— éœ€æ¯ä¸€æ­¥æŒ‡å®šç”Ÿæˆè§„å®šçš„æ–‡ä»¶ç±»å‹<br />\nä¾‹å¦‚:</p>\n<pre><code class=\"language-makefilefile\">gcc -c -o filename1.o filename1.c\ngcc -c -o filename2.o filename2.c\ngcc -o filename filename1.o filename2.o\n</code></pre>\n<h3 id=\"æŒ‡å®šå¤´æ–‡ä»¶ç›®å½•\"><a class=\"anchor\" href=\"#æŒ‡å®šå¤´æ–‡ä»¶ç›®å½•\">#</a> æŒ‡å®šå¤´æ–‡ä»¶ç›®å½•</h3>\n<p>åœ¨å†™ä»£ç çš„æ—¶å€™æˆ‘ä»¬ï¼Œå¿…ç„¶ä¼šç”¨åˆ°åº“å‡½æ•°ï¼Œé‚£ä¹ˆè¿™äº›åº“å‡½æ•°åœ¨å“ªé‡Œå‘¢</p>\n<p>ä¸€èˆ¬æ¥è¯´ï¼Œç¼–è¯‘å™¨ä¼šé»˜è®¤ä½¿ç”¨ç³»ç»Ÿç›®å½•ï¼Œä¹Ÿå¯ä»¥ç”±ç”¨æˆ·æŒ‡å®š<br />\nç³»ç»Ÿç›®å½•ï¼Œä¸€èˆ¬æ˜¯æŒ‡ï¼Œå·¥å…·é“¾é‡Œçš„æŸä¸ª include ç›®å½•ï¼Œå¦‚ä½•ç¡®å®šå‘¢ï¼Ÿ</p>\n<p>å¯ä»¥é€šè¿‡ä¸‹é¢è¿™æ¡å‘½ä»¤ï¼Œè®©å…¶åœ¨ç»ˆç«¯ä¸­è¾“å‡º</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">echo</span> <span class=\"token string\">'main()&#123;&#125;'</span><span class=\"token operator\">|</span> gcc <span class=\"token parameter variable\">-E</span> <span class=\"token parameter variable\">-v</span> -  // å®ƒä¼šåˆ—å‡ºå¤´æ–‡ä»¶ç›®å½•ã€åº“ç›®å½•<span class=\"token punctuation\">(</span>LIBRARY_PATH<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>å¦‚æœä¸æƒ³ç”¨æ ‡å‡†åº“ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨  <code>-nostdinc</code>  æ¥å®ç°ï¼Œä¸ä½¿ç”¨æ ‡å‡†åº“æ¥ç¼–è¯‘</p>\n<p>å¦‚æœè¦æ·»åŠ è‡ªå·±çš„å¤´æ–‡ä»¶åº“è¿›å…¥ç¼–è¯‘ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢è¿™ä¸ªè¯­å¥</p>\n<figure class=\"highlight makefile\"><figcaption data-lang=\"makefile\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>-I &lt;IncDir></pre></td></tr></table></figure><h3 id=\"æŒ‡å®šåº“æ–‡ä»¶\"><a class=\"anchor\" href=\"#æŒ‡å®šåº“æ–‡ä»¶\">#</a> æŒ‡å®šåº“æ–‡ä»¶</h3>\n<p>åŒæ ·çš„åº“æ–‡ä»¶ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬ä¼šç”¨åˆ°ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œè¿™äº›åº“å¯èƒ½ä¸æ˜¯å¼€æºçš„ <code>.lib</code>  æ–‡ä»¶</p>\n<p>ä¸å¤´æ–‡ä»¶ç›¸åŒï¼Œç¼–è¯‘å™¨ä¼šé»˜è®¤ä½¿ç”¨ç³»ç»Ÿç›®å½•ï¼Œä¹Ÿå¯ä»¥ç”±ç”¨æˆ·æŒ‡å®š<br />\nå¯ä»¥é€šè¿‡ä¸‹é¢è¿™æ¡è¯­å¥å®šä½ä½¿ç”¨çš„åº“åœ¨å“ªä¸ªæ–‡ä»¶</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">echo</span> <span class=\"token string\">'main()&#123;&#125;'</span><span class=\"token operator\">|</span> gcc <span class=\"token parameter variable\">-E</span> <span class=\"token parameter variable\">-v</span> -  // å®ƒä¼šåˆ—å‡ºå¤´æ–‡ä»¶ç›®å½•ã€åº“ç›®å½•<span class=\"token punctuation\">(</span>LIBRARY_PATH<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>å¦‚æœä¸æƒ³ç”¨æ ‡å‡†åº“ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ <code>-nostdlib</code>  æ¥å®ç°ç»ˆç«¯è¾“å‡º</p>\n<p>å¦‚æœç”¨æˆ·æƒ³è¦æ·»åŠ è‡ªå·±æŒ‡å®šåº“æ–‡ä»¶ç›®å½•<br />\nå¯ä»¥ä½¿ç”¨ä¸‹é¢è¿™æ¡æŒ‡ä»¤æ¥æŒ‡å®šè‡ªå·±çš„åº“æ–‡ä»¶æ‰€åœ¨ç›®å½•</p>\n<figure class=\"highlight makefile\"><figcaption data-lang=\"makefile\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>-L &lt;LibDir></pre></td></tr></table></figure><p>ä¸å¤´æ–‡ä»¶ä¸åŒï¼Œå¤´æ–‡ä»¶æœ¬èº«åªä¼šè¢«é¢„å¤„ç†åˆ° <code>.c</code>  æ–‡ä»¶ä¸­ï¼Œç”¨äºç”Ÿæˆ <code>.i</code>  æ–‡ä»¶<br />\nä½† <code>.lib</code>  æ–‡ä»¶ä¸åŒå®ƒå¯ä»¥æŒ‡å®šå•ä¸ªæ–‡ä»¶</p>\n<figure class=\"highlight makefile\"><figcaption data-lang=\"makefile\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>-l  &lt;abc>   // é“¾æ¥ libxx.so æˆ– lib.x</pre></td></tr></table></figure><hr />\n<p>ç›®å‰å¯¹ï¼ŒGCC çš„ç¼–è¯‘è¿‡ç¨‹ï¼Œäº†è§£çš„åªæœ‰è¿™äº›ï¼Œå¯èƒ½ä»¥åä¼šç»§ç»­æ·»åŠ <br />\nå¦‚æœæ–‡ç« ä¸­æœ‰ä»€ä¹ˆä¸å½“æˆ–è€…é”™è¯¯ï¼Œæœ›å¤§ä½¬ä»¬æ–§æ­£</p>\n<h1 id=\"å‚è€ƒæ–‡çŒ®\"><a class=\"anchor\" href=\"#å‚è€ƒæ–‡çŒ®\">#</a> å‚è€ƒæ–‡çŒ®</h1>\n<p>[1] <span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuMTAwYXNrLm5ldC9wL3RfcGMvY291cnNlX3BjX2RldGFpbC92aWRlby92XzVmOTI4YjkzZTRiMDI4YmU1OTBiYTQ0MT9wcm9kdWN0X2lkPXBfNWY5MjZhNDllNGIwMGYxMzI4NmEwY2VjJmFtcDtjb250ZW50X2FwcF9pZD0mYW1wO3R5cGU9Ng==\">https://www.100ask.net/p/t_pc/course_pc_detail/video/v_5f928b93e4b028be590ba441?product_id=p_5f926a49e4b00f13286a0cec&amp;content_app_id=&amp;type=6</span><br />\n[2]  <code>ã€ŠåµŒå…¥å¼Linuxåº”ç”¨å¼€å‘å®Œå…¨æ‰‹å†Œã€‹</code> <br />\n[3] <span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3Fpaml0YW8vYXJ0aWNsZS9kZXRhaWxzLzEzMDExMTAwMyM6fjp0ZXh0PTEuJTIwZ2NjJUU0JUI4JUFEJUU2JThDJTg3JUU1JUFFJTlBJUU0JUJDJTk4JUU1JThDJTk2JUU3JUJBJUE3JUU1JTg4JUFCJUU3JTlBJTg0JUU1JThGJTgyJUU2JTk1JUIwJUU2JTlDJTg5JUVGJUJDJTlBLU8wJUUzJTgwJTgxLU8xJUUzJTgwJTgxLU8yJUUzJTgwJTgxLU8zJUUzJTgwJTgxLU9nJUUzJTgwJTgxLU9zJUUzJTgwJTgxLU9mYXN0JUUzJTgwJTgyLDIuJTIwJUU1JTlDJUE4JUU3JUJDJTk2JUU4JUFGJTkxJUU2JTk3JUI2JUVGJUJDJThDJUU1JUE2JTgyJUU2JTlFJTlDJUU2JUIyJUExJUU2JTlDJTg5JUU2JThDJTg3JUU1JUFFJTlBJUU0JUI4JThBJUU5JTlEJUEyJUU3JTlBJTg0JUU0JUJCJUJCJUU0JUJEJTk1JUU0JUJDJTk4JUU1JThDJTk2JUU1JThGJTgyJUU2JTk1JUIwJUVGJUJDJThDJUU1JTg4JTk5JUU5JUJCJTk4JUU4JUFFJUE0JUU0JUI4JUJBJTIwLU8wJUVGJUJDJThDJUU1JThEJUIzJUU2JUIyJUExJUU2JTlDJTg5JUU0JUJDJTk4JUU1JThDJTk2JUUzJTgwJTgy\">https://blog.csdn.net/qijitao/article/details/130111003#:~:text=1. gcc ä¸­æŒ‡å®šä¼˜åŒ–çº§åˆ«çš„å‚æ•°æœ‰ï¼š-O0ã€-O1ã€-O2ã€-O3ã€-Ogã€-Osã€-Ofastã€‚,2. åœ¨ç¼–è¯‘æ—¶ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šä¸Šé¢çš„ä»»ä½•ä¼˜åŒ–å‚æ•°ï¼Œåˆ™é»˜è®¤ä¸º -O0ï¼Œå³æ²¡æœ‰ä¼˜åŒ–ã€‚</span></p>\n<hr />\n<p>å¤§é“äº”åï¼Œå¤©è¡å››åä¹ï¼Œäººéå…¶ä¸€ï¼</p>\n",
            "tags": [
                "åµŒå…¥å¼",
                "ARM",
                "ARM"
            ]
        },
        {
            "id": "https://to-ywz.github.io/Embedded/STM32/ARM%E6%B1%87%E7%BC%96%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/",
            "url": "https://to-ywz.github.io/Embedded/STM32/ARM%E6%B1%87%E7%BC%96%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/",
            "title": "ARMæ±‡ç¼–åŸºç¡€çŸ¥è¯†",
            "date_published": "2023-06-27T14:20:07.000Z",
            "content_html": "<h1 id=\"armæ±‡ç¼–åŸºç¡€çŸ¥è¯†\"><a class=\"anchor\" href=\"#armæ±‡ç¼–åŸºç¡€çŸ¥è¯†\">#</a> ARM æ±‡ç¼–åŸºç¡€çŸ¥è¯†</h1>\n<h2 id=\"æ±‡ç¼–\"><a class=\"anchor\" href=\"#æ±‡ç¼–\">#</a> æ±‡ç¼–</h2>\n<p>å¤§éƒ¨åˆ†åšåµŒå…¥å¼å¼€å‘æ—¶å€™ï¼Œä½¿ç”¨çš„éƒ½æ˜¯ C è¯­è¨€ï¼Œé€šè¿‡ç¼–è¯‘å™¨ç”ŸæˆäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œç„¶åçƒ§å½•åˆ° MCU ä¸­.<br />\n å…¶å®ï¼Œæ›´åº•å±‚è¿˜æœ‰æ±‡ç¼–è¯­è¨€æœºå™¨ç ï¼Œä¾‹å¦‚.start_up.s æ–‡ä»¶å°±æ˜¯æ±‡ç¼–æ–‡ä»¶ï¼Œç”¨äºè®¾ç½®å †æ ˆï¼Œä¸­æ–­å‘é‡è¡¨ä»¥åŠä¸­æ–­å‘é‡å‡½ç­‰<br />\nä¸åŒçš„èŠ¯ç‰‡æŒ‡ä»¤é›†å¯èƒ½ä¸åŒï¼Œæ‰€å¯¹åº”çš„æœºå™¨ç ä¹Ÿä¼šä¸åŒï¼Œæ±‡ç¼–çš„å‡ºç°å°±æ˜¯ä¸ºäº†å¸®åŠ©è®°å¿†<br />\nåŒä¸€æ¡æ±‡ç¼–ä»£ç ï¼Œç”±æ±‡ç¼–å™¨æ¥å®ç°è½¬è¯‘</p>\n<h2 id=\"åæ±‡ç¼–\"><a class=\"anchor\" href=\"#åæ±‡ç¼–\">#</a> åæ±‡ç¼–</h2>\n<p>åæ±‡ç¼–æ˜¯å°†éš¾ä»¥è¾¨è®¤çš„æœºå™¨è½¬åŒ–ä¸ºæ±‡ç¼–è¯­è¨€ï¼Œåæ±‡ç¼–å‡ºæ¥çš„æ±‡ç¼–å¤§æ¦‚ç‡å’ŒåŸæœ¬çš„æ±‡ç¼–ä»£ç ä¸ä¸€æ ·<br />\nä¾‹å¦‚ï¼ŒåŸæ±‡ç¼–å†…å®¹å¦‚ä¸‹<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.6045ea6o1fg0.jpg\" alt=\"image\" /><br />\n åæ±‡ç¼–åï¼Œå¼•å¯¼æ–‡ä»¶å¯¹åº”çš„ä»£ç å¦‚ä¸‹<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.39ldlwmyo6a0.jpg\" alt=\"image\" /><br />\n å¯ä»¥çœ‹åˆ°æœ‰ç€å¾ˆå¤§çš„å·®åˆ«ï¼Œä½†æ˜¯ï¼Œæ¯«æ— ç–‘é—®äºŒè€…éƒ½å¯ä»¥å®ç°æœ€ç»ˆæ•ˆæœ</p>\n<h2 id=\"äºŒè¿›åˆ¶æ–‡ä»¶ç”Ÿæˆæµç¨‹\"><a class=\"anchor\" href=\"#äºŒè¿›åˆ¶æ–‡ä»¶ç”Ÿæˆæµç¨‹\">#</a> äºŒè¿›åˆ¶æ–‡ä»¶ç”Ÿæˆæµç¨‹</h2>\n<p>æ­£å¸¸æ¥è¯´ï¼Œä¸€ä¸ª C è¯­è¨€ç¨‹åºï¼Œä¼šå…ˆç»è¿‡é¢„å¤„ç†ç”Ÿæˆ  <code>x.i</code>  æ–‡ä»¶ï¼Œè¿™æ—¶å€™è¿˜æ˜¯ C è¯­è¨€æ–‡ä»¶ï¼Œä»…ä»…æ˜¯å®Œæˆäº†å°†å¤´æ–‡ä»¶å†…å®¹æ”¾å…¥  <code>x.c</code>  çš„æ–‡ä»¶å¤¹ä¸­<br />\næ¥ä¸‹å»å°±æ˜¯ç¼–è¯‘ï¼Œå°†  <code>x.i</code>  æ–‡ä»¶ç¼–è¯‘ä¸ºæ±‡ç¼–æ–‡ä»¶  <code>x.s</code> , è¿™æ—¶å€™å¾—å‡ºæ¥çš„æ–‡ä»¶å°±æ˜¯æ±‡ç¼–æ–‡ä»¶äº†<br />\nå†æ¥ä¸‹å»å°±æ˜¯å°†å„ä¸ª  <code>x.s</code>  æ–‡ä»¶æ±‡ç¼–ä¸º  <code>x.o</code>  æ–‡ä»¶ï¼Œè¿™æ—¶å€™æ–‡ä»¶å°±æ˜¯äºŒè¿›åˆ¶æ ¼å¼äº†ï¼Œæ— æ³•æ‰“å¼€æŸ¥çœ‹äº†<br />\næœ€åé€šè¿‡é“¾æ¥å™¨å°†  <code>x.o</code>  æ–‡ä»¶ï¼Œåˆå¹¶æˆ  <code>x.elf</code>   æ–‡ä»¶ç”¨äºä¸‹è½½<br />\nè¿™æ—¶å€™å¦‚æœæƒ³çœ‹æ±‡ç¼–çš„è¯å°±éœ€è¦é€šè¿‡åæ±‡ç¼–å™¨æ¥å®ç°åæ±‡ç¼–  <code>x.dis</code> , ä¸€èˆ¬æ¥è¯´å„ç§ç¼–è¯‘å™¨è‡ªå¸¦äº†åæ±‡ç¼–å™¨<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.12l1qmm1yd2o.jpg\" alt=\"image\" /></p>\n<h2 id=\"keilä¸‹æ€ä¹ˆåæ±‡ç¼–\"><a class=\"anchor\" href=\"#keilä¸‹æ€ä¹ˆåæ±‡ç¼–\">#</a> KEIL ä¸‹æ€ä¹ˆåæ±‡ç¼–</h2>\n<p>åœ¨ KEIL çš„ User é€‰é¡¹ä¸­ï¼Œå¦‚ä¸‹å›¾æ·»åŠ è¿™ä¸¤é¡¹ (filename è‡ªè¡Œæ›¿æ¢)</p>\n<pre><code>fromelf  --bin  --output=led.bin  Objects\\filename.axf\nfromelf  --text  -a -c  --output=filename.dis  Objects\\filename.axf\n</code></pre>\n<p>ç„¶åé‡æ–°ç¼–è¯‘ï¼Œå³å¯å¾—åˆ°äºŒè¿›åˆ¶æ–‡ä»¶ filename.binã€åæ±‡ç¼–æ–‡ä»¶ filename.disã€‚<br />\nå¦‚ä¸‹å›¾æ“ä½œï¼š<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.n0andsjwbcg.jpg\" alt=\"image\" /></p>\n<h2 id=\"gccä¸‹åæ±‡ç¼–\"><a class=\"anchor\" href=\"#gccä¸‹åæ±‡ç¼–\">#</a> GCC ä¸‹åæ±‡ç¼–</h2>\n<p>ä½¿ç”¨ GCC å·¥å…·é“¾ç¼–è¯‘ç¨‹åºæ—¶ï¼Œå¯ä»¥åœ¨ Makefile ä¸­æ·»åŠ ä¸€å¥ï¼š</p>\n<pre><code>$(OBJDUMP) -D -m arm  filename.elf &gt; filename.dis\t# OBJDUMP = arm-linux-gnueabihf-objdump\n``\nå°±å¯ä»¥æŠŠå¯æ‰§è¡Œç¨‹åº filename.elfï¼Œåæ±‡ç¼–ï¼Œå¾—åˆ° filename.dis\n</code></pre>\n<h2 id=\"pcå¯„å­˜å™¨\"><a class=\"anchor\" href=\"#pcå¯„å­˜å™¨\">#</a> PC å¯„å­˜å™¨</h2>\n<p>PC å¯„å­˜å™¨é»˜è®¤æŒ‡å‘å½“å‰æŒ‡ä»¤çš„ä¸‹ä¸€æ¡æŒ‡ä»¤ä½ç½®<br />\nä½†æ˜¯ï¼Œä¸åŒæ¶æ„çš„å¤„ç†æ­¥é•¿ä¼šä¸åŒï¼ŒThumb æŒ‡ä»¤é›†ä¸­ PC æ­¥é•¿ä¸º 4, ARM æŒ‡ä»¤é›†ä¸­ PC æ­¥é•¿ä¸º 8, è€Œ Thumb2 æŒ‡ä»¤é›†ä¸ºäº†å…¼å®¹ Thumb æŒ‡ä»¤é›†å°±ä½¿ç”¨äº† 4 ä½œä¸ºæ­¥é•¿<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.275rfbthmavw.jpg\" alt=\"image\" /></p>\n<h2 id=\"æ±‡ç¼–å¦‚ä½•è°ƒç”¨cè¯­è¨€å‡½æ•°\"><a class=\"anchor\" href=\"#æ±‡ç¼–å¦‚ä½•è°ƒç”¨cè¯­è¨€å‡½æ•°\">#</a> æ±‡ç¼–å¦‚ä½•è°ƒç”¨ C è¯­è¨€å‡½æ•°</h2>\n<h3 id=\"ç›´æ¥è°ƒç”¨\"><a class=\"anchor\" href=\"#ç›´æ¥è°ƒç”¨\">#</a> ç›´æ¥è°ƒç”¨</h3>\n<p>å¦‚æœå‡½æ•°è°ƒç”¨ä¸æ¶‰åŠå‚æ•°ä¼ é€’ï¼Œé‚£ä¹ˆå¯ä»¥ç›´æ¥è°ƒç”¨</p>\n<p>ä¾‹å¦‚ï¼Œè°ƒç”¨  <code>void SystemReset(void)</code> , é‚£ä¹ˆå°±å¯ä»¥ç›´æ¥è°ƒç”¨</p>\n<pre><code class=\"language-arm\">bl SystemReset\n</code></pre>\n<p>å¦‚æœå‡½æ•°å…·æœ‰è¿”å›å€¼ï¼Œä¾‹å¦‚  <code>uint8_t is_empty(void);</code> , å½“è°ƒç”¨çš„æ—¶å€™å¯ä»¥ç›´æ¥è°ƒç”¨<br />\nè¿”å›å€¼ä¼šå­˜å…¥  <code>r0~r3</code></p>\n<pre><code>bl is_empty\nand r0, #0xff\n</code></pre>\n<h3 id=\"å«æœ‰å‚æ•°çš„å‡½æ•°\"><a class=\"anchor\" href=\"#å«æœ‰å‚æ•°çš„å‡½æ•°\">#</a> å«æœ‰å‚æ•°çš„å‡½æ•°</h3>\n<p>å¦‚æœå‡½æ•°å¸¦æœ‰å‚æ•°ï¼Œé‚£å°±æ¶‰åŠåˆ°äº†ä¼ å‚çš„é—®é¢˜ï¼Œæ€ä¹ˆä¼ ï¼Œç”¨ä»€ä¹ˆä¼ ï¼Ÿ</p>\n<p>å…¶å® ARM ä¸­æœ‰ä¸€ä¸ª ATPCS è§„åˆ™ ARM-THUMB procedure call standard (ARM-Thumb è¿‡ç¨‹è°ƒç”¨æ ‡å‡†)<br />\n è¿™ä¸ªæ ‡å‡†çš„ç¬¬ 10 é¡µçº¦å®š r0~r15 å¯„å­˜å™¨çš„ç”¨é€”</p>\n<ul>\n<li>R0~r3: ç”¨äºå‚æ•°ä¼ é€’å’Œæ•°å€¼è¿”å›</li>\n<li>r4~r11: ç”¨äºä¿å­˜å½“å‰å‡½æ•°çš„å±€éƒ¨å˜é‡</li>\n</ul>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/008_atpcs.76uqxz77nf40.jpg\" alt=\"008_atpcs\" /></p>\n<p>ä¾‹å¦‚ï¼Œè°ƒä¸‹é¢è¿™ä¸ªå‡½æ•°</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">delay</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint32_t</span> n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>n<span class=\"token operator\">--</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>åœ¨æ±‡ç¼–ä¸­çš„è°ƒç”¨ä»£ç ä¸º</p>\n<pre><code class=\"language-ASM\">ldr r0, =0x7fffff ; ä¼ é€’å‚æ•°, å­˜æ”¾åˆ°r0\nbl  delay\ncmp r0, #0 ; æ ¡éªŒè¿”å›å€¼\n</code></pre>\n<p>æ€è€ƒä¸€ä¸ªé—®é¢˜å½“å‚æ•°è¶…çº§å¤šçš„æ—¶å€™ä¼šæ€ä¹ˆæ ·ï¼Ÿ<br />\n å½“å‡½æ•°å‚æ•°è¿‡å¤šçš„æ—¶å€™ï¼Œä¼šä½¿ç”¨æ ˆæ¥ä¿å­˜</p>\n<p>r4~r11 ä½œä¸ºå±€éƒ¨å˜é‡çš„ä¿å­˜ç‚¹ï¼Œå¯èƒ½åœ¨è°ƒç”¨æ—¶ä¼šå‘ç”Ÿæ”¹å˜<br />\nè¿™æ˜¯å› ä¸ºè¿™äº›å¯„å­˜å™¨æ—¶å…±äº«çš„ï¼ŒCPU çš„ä»»ä½•è¿ç®—æ“ä½œéƒ½éœ€è¦å€ŸåŠ©å¯„å­˜å™¨æ¥å®ç°<br />\næ‰€ä»¥åœ¨è°ƒç”¨å‡½æ•°æ—¶ï¼Œéœ€è¦å°† r4~r15 ä»¥åŠ psr å¯„å­˜å™¨éƒ½ä¿å­˜ä¸‹æ¥ (å½“ç„¶å› åœ°åˆ¶å®œï¼Œæ²¡ç”¨åˆ°å°±ä¸å­˜äº†ï¼Œè¦ä¸ç„¶æµªè´¹ç©ºé—´)</p>\n<h2 id=\"cå‡½æ•°çš„æ±‡ç¼–ä»£ç \"><a class=\"anchor\" href=\"#cå‡½æ•°çš„æ±‡ç¼–ä»£ç \">#</a> C å‡½æ•°çš„æ±‡ç¼–ä»£ç </h2>\n<p>è¿™é‡Œæ˜¯ä¸€æ®µ STM32MP157 çš„ led ç‚¹äº®ä»£ç ï¼Œç”±äº <code>main</code>  å‡½æ•°å¤ªé•¿è¿™é‡Œåªåˆ†æä¸€ä¸‹ delay çš„è°ƒç”¨å’Œæ‰§è¡Œ</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">USE_A7</span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">delay</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">volatile</span> <span class=\"token keyword\">long</span> ntime<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>ntime<span class=\"token operator\">--</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">volatile</span> <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> <span class=\"token operator\">*</span>p_reg<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token comment\">/* ä½¿èƒ½ PLL4 */</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    p_reg <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">volatile</span> <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x50000000</span> <span class=\"token operator\">+</span> <span class=\"token number\">0x894</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token operator\">*</span>p_reg <span class=\"token operator\">|=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token comment\">// ç­‰å¾…æ—¶é’Ÿç¨³å®š</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>p_reg <span class=\"token operator\">&amp;</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token comment\">/* ä½¿èƒ½ GPIOA */</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">ifdef</span> <span class=\"token expression\">USE_A7</span></span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    p_reg <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">volatile</span> <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x50000000</span> <span class=\"token operator\">+</span> <span class=\"token number\">0xA28</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token operator\">*</span>p_reg <span class=\"token operator\">|=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">ifdef</span> <span class=\"token expression\">USE_M4</span></span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    p_reg <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">volatile</span> <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x50000000</span> <span class=\"token operator\">+</span> <span class=\"token number\">0xAA8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token operator\">*</span>p_reg <span class=\"token operator\">|=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    <span class=\"token comment\">/* è®¾ç½® GPIO10 ä¸ºè¾“å‡ºæ¨¡å¼ */</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    p_reg <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">volatile</span> <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x50002000</span> <span class=\"token operator\">+</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    <span class=\"token operator\">*</span>p_reg <span class=\"token operator\">&amp;=</span> <span class=\"token operator\">~</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    <span class=\"token operator\">*</span>p_reg <span class=\"token operator\">|=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    <span class=\"token comment\">// æŒ‡å‘ (GPIOA_ODR)</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    p_reg <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">volatile</span> <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x50002000</span> <span class=\"token operator\">+</span> <span class=\"token number\">0x14</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    <span class=\"token comment\">/* æ‰§è¡Œä»»åŠ¡ */</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>        <span class=\"token comment\">/* è®¾ç½® LED ç”µå¹³å˜åŒ– */</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>        <span class=\"token operator\">*</span>p_reg <span class=\"token operator\">^=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>        <span class=\"token function\">delay</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>ç»è¿‡åæ±‡ç¼–åï¼Œè¿™é‡Œå°±åªç»™å‡ºè°ƒç”¨å’Œ <code>delay</code>  çš„ä»£ç ï¼Œç®€å•è¿›è¡Œä¸€ä¸‹åˆ†æ</p>\n<pre><code class=\"language-asm\">\nc01000bc:\tf244 2040 \tmovw\tr0, #16960\t; 0x4240 ; å°†0x4240å­˜å…¥r0çš„ä½16ä½\nc01000c0:\tf2c0 000f \tmovt\tr0, #15              ; å°†0x0få­˜å…¥r0 çš„æ16ä½\n; ä¸Šé¢çš„å‡ºæ¥çš„å°±æ˜¯100000\nc01000c4:\tf7ff ffa2 \tbl\tc010000c &lt;delay&gt;       ; è°ƒç”¨ delay å‡½æ•°\n\nc010000c &lt;delay&gt;:\nc010000c:\tb480      \tpush\t&#123;r7&#125;                 ; ä¿å­˜å…±äº«è¿‡ç¨‹å¯„å­˜å™¨çš„åŸæœ‰çš„å€¼\nc010000e:\tb083      \tsub\tsp, #12                ; spå‘ååç§»12Byte\nc0100010:\taf00      \tadd\tr7, sp, #0             ; å°†spçš„å€¼è¯»å–å¦‚r7\nc0100012:\t6078      \tstr\tr0, [r7, #4]           ;  r0 å­˜å…¥åˆ° sp+4 çš„åœ°å€\nc0100014:\tbf00      \tnop\nc0100016:\t687b      \tldr\tr3, [r7, #4]           ; å°†sp+4 åœ°å€ä¸Šçš„æ•°æ®è¯»å…¥åˆ°r3\nc0100018:\t1e5a      \tsubs\tr2, r3, #1           ; å°† r3 çš„å€¼-1 ntime-1\nc010001a:\t607a      \tstr\tr2, [r7, #4]           ; æ›´æ–°SP+3çš„æ•°å€¼\nc010001c:\t2b00      \tcmp\tr3, #0                 ; æ¯”è¾ƒæ˜¯å¦å‡åˆ°0\nc010001e:\td1fa      \tbne.n\tc0100016 &lt;delay+0xa&gt; ; æ˜¯åˆ™è¿”å›\nc0100020:\tbf00      \tnop\nc0100022:\t370c      \tadds\tr7, #12              ; å‡ºæ ˆ\nc0100024:\t46bd      \tmov\tsp, r7                 ; å›å¤ sp æ•°å€¼\nc0100026:\tf85d 7b04 \tldr.w\tr7, [sp], #4         ; å›å¤ r7\nc010002a:\t4770      \tbx\tlr\n</code></pre>\n<p>å›¾ç‰‡ç®€å•è®²è§£ä¸€ä¸‹ï¼Œæ›´è¯¦ç»†çš„å¯ä»¥å‚è€ƒéŸ¦ä¸œå±±çš„è§†é¢‘<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.nsum3h8ig40.jpg\" alt=\"image\" /></p>\n<h2 id=\"ä½¿ç”¨æ±‡ç¼–å®ç°ç‚¹ç¯\"><a class=\"anchor\" href=\"#ä½¿ç”¨æ±‡ç¼–å®ç°ç‚¹ç¯\">#</a> ä½¿ç”¨æ±‡ç¼–å®ç°ç‚¹ç¯</h2>\n<p>åˆ†æå’Œäº†è§£äº†è¿™ä¹ˆå¤šï¼Œæ€»å¾—å®æˆ˜ä¸€ä¸‹ï¼Œå…¶å®æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ª è¯» - æ”¹ - å­˜ çš„è¿‡ç¨‹<br />\nä¸€èˆ¬æ¥è¯´ï¼Œå½“å‡ºç°æ¸…é›¶ï¼Œæˆ–è€…äº¦æˆ–ä¹‹ç±»çš„è¿ç®—åœ¨ æ”¹ è¿™ä¸ªæ­¥éª¤ä¸Šä¼šå¤šä¸€äº›<br />\n<strong> <code>;</code>  ä¸æ˜¯æ³¨é‡Šï¼Œè¿™é‡Œçš„æ³¨é‡Šç¬¦å·å’Œ C è¯­è¨€ä¸€è‡´</strong></p>\n<pre><code>.text\n.global  _start\n\n_start: \t\n\n    /* 1. ä½¿èƒ½GPIO */\n\n    /* ä½¿èƒ½ RCC */\n    ldr r0, =(0x50000000 + 0x894)\n    ldr r1, [r0]\n    orr r1, r1, #(1&lt;&lt;0)\n    str r1, [r0]\n \nNotReady:\n    ldr R1, [R0]\n    tst r1, #(1 &lt;&lt; 1)\n    beq NotReady   /* ä¸ä¸º0åˆ™ç­‰å¾… */\n\n   /* ä½¿èƒ½ GPIOA æ¨¡å— */\n    ldr r0, =(0x50000000 + 0xA28)\n    ldr r1, [r0]\n    orr r1, r1, #(1&lt;&lt;0)\n    str r1, [r0]\n\n    /* é…ç½®GPIOå¼•è„š */\n\n    /* è®¾ç½®GPIO10ä¸ºè¾“å‡ºæ¨¡å¼ */\n    ldr r0, = (0x50002000 + 0x00)\n    ldr r1, [r0]\n    mov r2, #(3&lt;&lt;20)      /* ç”¨äºç”Ÿæˆæ¸…é™¤ä½ */\n    bic r1, r1, r2        /* r1 = r1&amp;~(R2) */\n    orr r1, r1, #(1&lt;&lt;20)  /* é…ç½®ä¸º è¾“å‡º */\n    str r1, [r0]\n\n    /* r0 æŒ‡å‘ (GPIOA_ODR) */\n    ldr r2, = (0x50002000 + 0x14)\n\nLoop:\n\n    /* è®¾ç½®å¼•è„šé«˜ç”µå¹³ */\n    ldr r1, [r2]\n    orr r1, r1, #(1&lt;&lt;10)\n    str r1, [r2]\n    \n    ldr r0, =1000000\n    bl Delay\n\n    /* è®¾ç½®å¼•è„šä½ç”µå¹³ */\n    ldr r1, [r2]\n    bic r1, r1, #(1&lt;&lt;10)\n    str r1, [r2]\n    \n    ldr r0, =1000000\n    bl Delay\n    \n    b Loop\n\n\nDelay:\n    subs r0, r0, #1\n    bne Delay\n    mov pc, lr\n</code></pre>\n<p>èƒ½æ˜æ˜¾çš„æ„Ÿè§‰åˆ°ï¼Œå’±ä»¬çš„ä»£ç è¦æ¯”åæ±‡ç¼–çš„çŸ­ï¼Œä¼šæ›´åŠ é«˜æ•ˆä¸€äº›<br />\nè¿™æ˜¯å› ä¸ºç¼–è¯‘å™¨ä¼šåœ¨ä¿è¯ç¨³å¦¥çš„æƒ…å†µä¸‹å†é€‰æ‹©é«˜æ•ˆçš„æŒ‡ä»¤</p>\n<p>å½“ç„¶ï¼Œè¿˜ä¼šæœ‰æ›´åŠ é«˜æ•ˆçš„ç®—æ³•ï¼Œä½†è¿™æ˜¯æˆ‘èƒ½åŠ›å†…ç›®å‰èƒ½æƒ³åˆ°çš„ä¸€ä¸ªæ–¹æ¡ˆ<br />\nå¦‚æœæœ‰æ›´å¥½çš„æ–¹æ³•ï¼Œæœ›å„ä½å¤§ä½¬æ–§æ­£</p>\n<h2 id=\"å‚è€ƒæ–‡çŒ®\"><a class=\"anchor\" href=\"#å‚è€ƒæ–‡çŒ®\">#</a> å‚è€ƒæ–‡çŒ®</h2>\n<p>[1] ARM ArchitectureReference Manual ARMv7-A and ARMv7-R edition<br />\n[2] DDI0403E_B_armv7m_arm<br />\n[3] PM0056<br />\n [4] ATPCS (ATM-Thumb æŒ‡ä»¤è°ƒç”¨æ ‡å‡†)</p>\n<hr />\n<p>å¤§é“äº”åï¼Œå¤©è¡å››åä¹ï¼Œäººéå…¶ä¸€ï¼</p>\n",
            "tags": [
                "åµŒå…¥å¼",
                "ARM",
                "ARM"
            ]
        },
        {
            "id": "https://to-ywz.github.io/Education/E333/6-23/",
            "url": "https://to-ywz.github.io/Education/E333/6-23/",
            "title": "E333æŠ½èƒŒ",
            "date_published": "2023-06-23T05:27:27.000Z",
            "content_html": "<h2 id=\"ç§¦æ±‰æ•™è‚²\"><a class=\"anchor\" href=\"#ç§¦æ±‰æ•™è‚²\">#</a> ç§¦æ±‰æ•™è‚²</h2>\n<h3 id=\"åè¯è§£é‡Š\"><a class=\"anchor\" href=\"#åè¯è§£é‡Š\">#</a> åè¯è§£é‡Š</h3>\n<h4 id=\"å¤ªå­¦\"><a class=\"anchor\" href=\"#å¤ªå­¦\">#</a> å¤ªå­¦</h4>\n<ol>\n<li class=\"quiz fill\">\n<p>ç®€ä»‹<span class=\"gap\">âœ”</span>ã€‚</p>\n<blockquote>\n<p>å¤ªå­¦æ˜¯æ±‰æ­¦å¸æ—¶æœŸåœ¨è‘£ä»²èˆ’çš„å»ºè®®ä¸‹ï¼Œä¸ºæ¨è¡Œ â€œç‹¬å°Šå„’æœ¯â€ çš„æ–‡æ•™æ”¿ç­–è€Œåˆ›ç«‹çš„ä¸­å¤®å®˜å­¦.<br />\n äº”ç»åšå£«ç½®å¼Ÿå­æ ‡å¿—ç€å¤ªå­¦æ­£å¼æˆç«‹<br />\næ ‡å¿—ç€ä»¥ç»å­¦æ•™è‚²ä¸ºåŸºæœ¬å†…å®¹çš„ä¸­å›½å°å»ºæ•™è‚²åˆ¶åº¦æ­£å¼ç¡®ç«‹</p>\n</blockquote>\n</li>\n<li class=\"quiz fill\">\n<p>ç‰¹ç‚¹:<span class=\"gap\">âœ”</span>ã€‚</p>\n<blockquote>\n<p>å¤ªå­¦ä»¥ä¸ºå›½å®¶åŸ¹å…» â€œç»æ˜è¡Œä¿®â€ çš„å®˜åä½œä¸ºæ•™è‚²å®—æ—¨ï¼›</p>\n<p>åœ¨æ•™å­¦å†…å®¹ä¸Šï¼Œåˆ¶å®šç»Ÿä¸€çš„æ•™æä¸»è¦å­¦ä¹  â€œäº”ç»â€;</p>\n<p>å¤ªå­¦ä¸­æœ‰ä¸ªåˆ«ã€å°ç»„æ•™å­¦ã€â€œå¤§éƒ½æˆâ€ é›†ä½“ä¸Šè¯¾ä»¥åŠæ¬¡ç¬¬ç›¸ä¼ çš„æ•™å­¦å½¢å¼ï¼›</p>\n<p>å¤ªå­¦ä»¥ â€œè®¾ç§‘å°„ç­–â€ çš„å½¢å¼è¿›è¡Œè€ƒè¯•ï¼›å¤ªå­¦æŠŠæ•™å¸ˆç§°ä½œåšå£«ï¼ŒæŠŠå­¦ç”Ÿç§°ä½œ â€œåšå£«å¼Ÿå­â€ æˆ– â€œå¤ªå­¦ç”Ÿâ€</p>\n</blockquote>\n</li>\n<li class=\"quiz fill\">\n<p>è¯„ä»·:<span class=\"gap\">âœ”</span>ã€‚</p>\n<blockquote>\n<p>å¤ªå­¦æ˜¯æˆ‘å›½ç¬¬ä¸€æ‰€æœ‰å®Œå¤‡è§„åˆ’ã€å²å®è¯¦å°½å¯è€ƒçš„å­¦æ ¡å¤ªå­¦æœ€æ—©åˆ©ç”¨å­¦æ ¡æ•™è‚²æ¥å¼ºåŒ–å®˜æ–¹æ„è¯†å½¢æ€ï¼›</p>\n<p>å¤ªå­¦æ€å¼€äº†åæŠ—å®¦å®˜æ”¿æ²»çš„ä¸­å›½å­¦ç”Ÿè¿åŠ¨å²ä¸Šçš„ç¬¬ä¸€é¡µã€‚</p>\n<p>ä½†ç”±äºå¤ªå­¦åœ¨æ•™å­¦ä¸­å­˜åœ¨æ’é™¤å¼‚å·±å­¦è¯´ã€ç©ºè°ˆä¹‰ç†çš„ç°è±¡ï¼Œä¸¥é‡æŸç¼šäº†æ•™è‚²æ€æƒ³å’Œå­¦æœ¯ç ”ç©¶çš„å‘å±•</p>\n</blockquote>\n</li>\n</ol>\n<h3 id=\"ç®€ç­”é¢˜\"><a class=\"anchor\" href=\"#ç®€ç­”é¢˜\">#</a> ç®€ç­”é¢˜</h3>\n<h4 id=\"ç®€è¿°æ±‰æ­¦å¸è‘£-æ±‰ä»£ç‹¬æœ¯ä¸‰å¤§æ–‡æ•™æ”¿ç­–\"><a class=\"anchor\" href=\"#ç®€è¿°æ±‰æ­¦å¸è‘£-æ±‰ä»£ç‹¬æœ¯ä¸‰å¤§æ–‡æ•™æ”¿ç­–\">#</a> ç®€è¿° (æ±‰æ­¦å¸ / è‘£ / æ±‰ä»£)â€œç‹¬æœ¯â€(ä¸‰å¤§) æ–‡æ•™æ”¿ç­–</h4>\n<ol>\n<li class=\"quiz fill\">\n<p>ç®€ä»‹:<span class=\"gap\">âœ”</span>ã€‚</p>\n<blockquote>\n<p>æ±‰æ­¦åœ¨è‘£ä»²èˆ’çš„å»ºè®®ä¸‹ï¼Œå®è¡Œ â€œç‹¬æœ¯â€ çš„æ–‡æ•™æ”¿ç­–ã€‚</p>\n<p>è‘£ä»²èˆ’æå‡ºçš„ â€œç‹¬å°Šå„’æœ¯â€ ç­‰ä¸‰å¤§å»ºè®®ï¼Œç§°ä¸ºæ±‰ä»£ä¸‰å¤§æ–‡æ•™æ”¿ç­–</p>\n</blockquote>\n</li>\n<li class=\"quiz fill\">\n<p>å«ä¹‰:<span class=\"gap\">âœ”</span>ã€‚</p>\n<blockquote>\n<p>å›½å®¶æ”¿ç­–å’Œæ–‡åŒ–æ•™è‚²çš†ä»¥å„’æœ¯ä¸ºæœ¬ï¼Œå„’å­¦æˆä¸ºç»Ÿä¸€çš„æŒ‡å¯¼æ€æƒ³ï¼Œ</p>\n<p>ä»¥å„’å®¶ç»å…¸ä¸ºæ•™è‚²å†…å®¹ï¼Œ</p>\n<p>ç”¨ä¸¥æ ¼çš„å¸ˆæ³•ä»£æ›¿è‡ªç”±è®²å­¦ä¹¦æœ¬çŸ¥è¯†åœ¨æ•™å­¦ä¸­å ä¸»è¦åœ°ä½ï¼Œ</p>\n<p>é•¿å¥å¤è®­ä»£æ›¿äº†å¯¹ç°å®é—®é¢˜çš„æ¢è®¨</p>\n</blockquote>\n</li>\n<li class=\"quiz fill\">\n<p>ä¸‰å¤§æ–‡æ•™æ”¿ç­–:<span class=\"gap\">â€œæ¨æ˜å­”æ°ï¼ŒæŠ‘é»œç™¾å®¶â€</span>ã€<span class=\"gap\">å…´å¤ªå­¦ä»¥å…»å£«</span>ã€<span class=\"gap\">é‡è§†é€‰ä¸¾ï¼Œä»»è´¤ä½¿èƒ½</span>ã€‚</p>\n<blockquote>\n<p>â€œæ¨æ˜å­”æ°ï¼ŒæŠ‘é»œç™¾å®¶â€ã€‚</p>\n<p>è¿™æ˜¯æ–‡æ•™æ”¿ç­–çš„æ€»çº²é¢†ã€‚</p>\n<p>è‘£ä»²èˆ’è®ºè¯äº†å„’å­¦åœ¨å°å»ºç»Ÿæ²»ä¸­ç‹¬ä¸€æ— äºŒçš„åœ°ä½ï¼Œæ±‰ä»£è™½ä¸»å¼ å…¶ä»–å„å®¶å­¦è¯´ä¹Ÿå¯ä»¥å‘å±•ï¼Œä½†å…¶ä»–å­¦è¯´å¤„äºä»å±åœ°ä½ï¼Œä¸å¯å–ä»£å„’å­¦çš„å®˜æ–¹åœ°ä½</p>\n<p>å…´å¤ªå­¦ä»¥å…»å£«ã€‚</p>\n<p>ä¸ºäº†ä¿è¯å°å»ºå›½å®¶åœ¨ç»Ÿæ²»æ€æƒ³ä¸Šçš„é«˜åº¦ç»Ÿä¸€ï¼Œä¹Ÿä¸ºäº†æ”¹å˜ç»Ÿæ²»äººæ‰çŸ­ç¼ºçš„å±€é¢ï¼Œè‘£ä»²èˆ’æå‡º â€œå…´å¤ªå­¦ä»¥å…»å£«â€ çš„å»ºè®®ã€‚</p>\n<p>å®é™…ä¸Šï¼Œé€šè¿‡å…´åŠå¤ªå­¦ï¼Œæ”¿åºœç›´æ¥æ“çºµæ•™è‚²å¤§æƒï¼Œå†³å®šäººæ‰çš„åŸ¹å…»ç›®æ ‡.</p>\n<p>è¿™æ˜¯è½å® â€œç‹¬å°Šå„’æœ¯â€ æ•™è‚²æ”¿ç­–çš„é‡è¦æ‰‹æ®µä¹‹ä¸€ã€‚</p>\n<p>é‡è§†é€‰ä¸¾ï¼Œä»»è´¤ä½¿èƒ½ã€‚</p>\n<p>é’ˆå¯¹æ±‰åˆäººæ‰é€‰æ‹”å’Œä½¿ç”¨ä¸­çš„å¼Šç—…ï¼Œè‘£ä»²èˆ’æå‡ºåŠ å¼ºé€‰ä¸¾åˆç†ä»»ç”¨äººæ‰çš„ä¸»ä»–æå‡º â€œé‡æè€Œæˆå®˜å½•å¾·è€Œå®šä½â€ çš„ç”¨äººæ€æƒ³ã€‚</p>\n<p>è¿™äº›ä¸»å¼ å¯¹ä¿ƒè¿›å„’å­¦å–å¾—ç‹¬å°Šåœ°ä½æœ‰é‡è¦ä½œç”¨ã€‚</p>\n</blockquote>\n</li>\n<li class=\"quiz fill\">\n<p>è¯„ä»·:<span class=\"gap\">âœ”</span>ã€‚</p>\n<blockquote>\n<p>æ€»çš„æ¥çœ‹ â€œç‹¬æœ¯â€ ä½¿å­¦åœ¨ç¤¾ä¼šæ”¿æ²»å’Œç¤¾ä¼šç”Ÿæ´»ä¸­çš„åœ°ä½ç©ºå‰æé«˜ï¼Œ</p>\n<p>ä½¿å­¦åœ¨æ•™è‚²è§‚å¿µå’Œæ•™è‚²å®æ–½æ–¹é¢éƒ½å¤„äºä¸»å¯¼å’Œæ”¯é…åœ°ä½ï¼ŒåŸºæœ¬ä¸Šç¬¦åˆå„’å®¶æ„å»ºçš„æ¨¡å¼å¹¶ä»¥æ­¤å…¨æ–¹ä½åœ°å½±å“ç€ç¤¾ä¼šæ”¿æ²»æ–‡åŒ–çš„å‘å±•èµ°å‘ï¼Œä½œç”¨æä¸ºæ·±è¿œ</p>\n</blockquote>\n</li>\n</ol>\n",
            "tags": [
                "æ•™è‚²å­¦",
                "E333",
                "E333"
            ]
        },
        {
            "id": "https://to-ywz.github.io/Embedded/STM32/%E7%AC%AC%E4%B8%80%E4%B8%AA%E7%A8%8B%E5%BA%8FSTM32MP157/",
            "url": "https://to-ywz.github.io/Embedded/STM32/%E7%AC%AC%E4%B8%80%E4%B8%AA%E7%A8%8B%E5%BA%8FSTM32MP157/",
            "title": "ç¬¬ä¸€ä¸ªç¨‹åºSTM32MP157",
            "date_published": "2023-06-18T16:33:52.000Z",
            "content_html": "<h1 id=\"ç¬¬ä¸€ä¸ªç¨‹åº\"><a class=\"anchor\" href=\"#ç¬¬ä¸€ä¸ªç¨‹åº\">#</a> ç¬¬ä¸€ä¸ªç¨‹åº</h1>\n<p>ä¸ hello world ç±»ä¼¼ï¼ŒåµŒå…¥å¼ç¬¬ä¸€ä¸ªç¨‹åºä¸ºç‚¹äº® LED, åœ¨ STM 32MP157 ä¸Šç‚¹äº® LED.</p>\n<h2 id=\"å¦‚ä½•ç‚¹äº®ä¸€ä¸ª-led\"><a class=\"anchor\" href=\"#å¦‚ä½•ç‚¹äº®ä¸€ä¸ª-led\">#</a> å¦‚ä½•ç‚¹äº®ä¸€ä¸ª LED</h2>\n<ol>\n<li>çœ‹åŸç†å›¾ï¼Œæ‰¾åˆ°ç›¸å…³å¼•è„š</li>\n<li>çœ‹ä¸»èŠ¯ç‰‡çš„æ•°æ®æ‰‹å†Œï¼Œå¦‚ä½•é…ç½®æ§åˆ¶å¼•è„š</li>\n<li>å†™ç¨‹åº</li>\n</ol>\n<h3 id=\"çœ‹åŸç†å›¾\"><a class=\"anchor\" href=\"#çœ‹åŸç†å›¾\">#</a> çœ‹åŸç†å›¾</h3>\n<p>å¯¹äº ç™¾é—®ç½‘ çš„è¿™å—æ¿å­æ¥è¯´ï¼ŒLED éƒ¨åˆ†çš„åŸç†å›¾å¦‚ä¸‹<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.3q216km4y1s0.jpg\" alt=\"image\" /><br />\n ä»¥ LED2 ä¸ºä¾‹å­ï¼Œä»å›¾ä¸­å¯ä»¥çœ‹å‡º è¿™ä¸ª LED æ­£ææ¥å…¥äº† 3.3V, è´Ÿææ¥åˆ°äº† ä¸»æ§çš„ PA10 ä¸Š.<br />\n ç”±åˆä¸­ç‰©ç†å¯çŸ¥ï¼Œç”µè·¯çš„å¯¼é€šæ˜¯å› ä¸ºç”µå­çš„å®šå‘ç§»åŠ¨ï¼Œç”µå­çš„å®šå‘ç§»åŠ¨æ˜¯å› ä¸ºå­˜åœ¨ç”µåŠ¿å·®<br />\næ‰€ä»¥è¦æƒ³ç‚¹äº® LED, å°±è¦å½¢æˆç”µåŠ¿å·®ï¼Œè€Œ LED çš„æ­£ææ¥å…¥çš„ 3.3v çš„ç”µæºï¼Œæ‰€ä»¥åªèƒ½é€šè¿‡ æ”¹å˜ PA10 è¾“å‡ºçš„ç”µå‹æ¥å½¢æˆç”µåŠ¿å·®<br />\næ˜¾ç„¶ï¼ŒPA10 è¾“å‡ºé«˜ç”µå¹³æ—¶ ç”µåŠ¿å·®ä¸º 0, LED ç†„ç­ï¼›PA10 è¾“å‡ºä½ç”µå¹³æ—¶ ç”µåŠ¿å·®ä¸º 3.3v, LED ç‚¹äº®</p>\n<h4 id=\"é©±åŠ¨èƒ½åŠ›ä¸è¶³çš„æƒ…å†µ\"><a class=\"anchor\" href=\"#é©±åŠ¨èƒ½åŠ›ä¸è¶³çš„æƒ…å†µ\">#</a> é©±åŠ¨èƒ½åŠ›ä¸è¶³çš„æƒ…å†µ</h4>\n<p>å¯¹äº MP1 æ¥è¯´ï¼ŒIO èƒ½è¾“å‡º 3.3v çš„ç”µå‹æ‰€ä»¥é‡‡ç”¨å½“å‰çš„ç”µè·¯<br />\næœ‰æœ‰äº› é©±åŠ¨èƒ½åŠ›è¾ƒå¼±çš„ ä¸»æ§ å¯èƒ½åªèƒ½è¾“å‡º 1.2v é‚£ä¹ˆä»–ä»¬çš„åŸç†å›¾ç”µè·¯å¯èƒ½å¦‚ä¸‹<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.mtzsdl9cu5s.jpg\" alt=\"image\" /></p>\n<p>å½“ ç”µè·¯è®¾è®¡å¦‚ä¸Šæ—¶ï¼Œ<br />\nGPIO è¾“å‡º 1.2v æ—¶ï¼Œä¸‰æç®¡å¯¼é€šï¼Œ3.3v å’Œ GND å½¢æˆé€šè·¯ LED è¢«ç‚¹äº®<br />\n GPIO è¾“å‡º 0v æ—¶ï¼Œä¸‰æç®¡æˆªè‡³ï¼Œæ— æ³•å½¢æˆé€šè·¯ï¼ŒLED ç†„ç­</p>\n<p>ä¹Ÿæœ‰å¯èƒ½å¦‚ä¸‹è®¾è®¡<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.e7tyxd3a41c.jpg\" alt=\"image\" /><br />\n å½“ ç”µè·¯è®¾è®¡å¦‚ä¸Šæ—¶ï¼Œ<br />\nGPIO è¾“å‡º 1.2v æ—¶ï¼Œç¬¬ä¸€ä¸ªä¸‰æç®¡å¯¼é€šï¼Œä¸‰æç®¡é›†ç”µæå¤„ç”µå‹å‡ ä¹ä¸º 0, ç¬¬äºŒä¸ªä¸‰æç®¡ä¸å¯¼é€šï¼ŒLED ç†„ç­<br />\n GPIO è¾“å‡º 0 v æ—¶ï¼Œç¬¬ä¸€ä¸ªä¸‰æç®¡æˆªè‡³ï¼Œé›†ç”µæå¤„å­˜åœ¨ç”µå‹ï¼Œç¬¬äºŒä¸ªä¸‰æç®¡å¯¼é€šï¼ŒLED ç‚¹äº®</p>\n<p><strong>PS: å…¶å®æ— è®ºï¼Œè¾“å‡ºçš„ç”µå‹æ˜¯å¤šå°‘ï¼Œå¦‚æœå¤–å›´ç”µè·¯æ²¡æœ‰é”™è¯¯ï¼Œå¯¹æˆ‘ä»¬ç¼–ç¨‹æ¥è¯´ï¼Œåªæœ‰ 0 æˆ–è€… 1, è¾“å‡ºçš„åªæœ‰é«˜ä½ç”µå¹³</strong></p>\n<h3 id=\"æ“ä½œç›¸å…³å¼•è„šé€»è¾‘æ€§æ¨å¯¼\"><a class=\"anchor\" href=\"#æ“ä½œç›¸å…³å¼•è„šé€»è¾‘æ€§æ¨å¯¼\">#</a> æ“ä½œç›¸å…³å¼•è„š (é€»è¾‘æ€§æ¨å¯¼)</h3>\n<p>GPIO: General-purpose input/output</p>\n<p>å›é¡¾ä¸Šé¢ï¼Œéœ€è¦ GPIO è¾“å‡ºç”µå¹³ï¼Œæˆ‘ä»¬å°±éœ€è¦æ“ä½œ GPIO, å¯æ˜¯  GPIO è¾“å‡ºé«˜ç”µå¹³æœ‰å¾ˆå¤šå¯èƒ½<br />\nä¾‹å¦‚ é€šç”¨è¾“å…¥è¾“å‡ºï¼ŒADC, DAC, UART .... è¿™å°±æ¶‰åŠåˆ°äº† GPIO çš„å¤šè·¯å¤ç”¨ï¼ŒGPIO_MUX å¤šè·¯é€‰æ‹©å™¨éƒ¨åˆ†ï¼Œé€šè¿‡è¿™ä¸ªé€‰æ‹©å™¨æ¥é€‰æ‹© GPIO çš„å·¥ä½œæ¨¡å¼<br />\nè¿™ä¸€éƒ¨åˆ†æ¯” STM32 ä¸Š ä½“ç°ä¸º GPIO çš„æ¨¡å¼é€‰æ‹©ï¼ŒNXP çš„ RT ç³»åˆ—çš„å•ç‰‡æœºå°±æœ‰ä¸€ä¸ªä¸“é—¨çš„ç”¨äºæ§åˆ¶ IOMUXC å¯„å­˜å™¨ï¼Œç”¨äºé€‰æ‹© å¤ç”¨</p>\n<p>æ‰€æœ‰ ARM æ¶æ„çš„èŠ¯ç‰‡ä¸ºäº†çœç”µ é»˜è®¤æ‰€æœ‰çš„ æ¨¡å—éƒ½æ˜¯ è¢«å…³é—­ çš„éœ€è¦æ‰‹åŠ¨æ‰“å¼€ï¼ŒGPIO ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œåœ¨ä½¿ç”¨ä¹‹å‰éœ€è¦ ENABLE ç›¸åº”çš„æ—¶é’Ÿ</p>\n<p>å’±ä»¬ æ§åˆ¶ LED äº®ç­å°±æ˜¯ç®€å•çš„ GPIO åŸºæœ¬è¾“å…¥è¾“å‡ºï¼Œä¸ç”¨å¤ç”¨æˆå…¶ä»–æ¨¡å—<br />\n GPIO æœ‰ I ä¹Ÿæœ‰ O, å°±ä¼šå­˜åœ¨ä¸€ä¸ªæ–¹å‘æ§åˆ¶å™¨<br />\nä¸Šé¢åˆ†æçš„å°±æ˜¯ LED æ“ä½œå°±æ˜¯ GPIO ç”µå¹³è¾“å‡ºï¼Œæ‰€ä»¥ å’±éœ€è¦ æŠŠ GPIO çš„æ–¹å‘é…ç½®æˆè¾“å‡º<br />\nåˆšåˆšåˆ†æ MP1 çš„ LED ç”µè·¯ ä¸ºä½ç”µå¹³ç‚¹äº®ï¼Œæ‰€ä»¥å°† è¾“å‡ºå¯„å­˜å™¨ é…ç½®ä¸ºé«˜ç”µå¹³</p>\n<p>PS: æ“ä½œå¯„å­˜å™¨æ—¶ï¼Œä¸è¦å½±å“å…¶ä»–ä½ï¼Œå…ˆè¯»å‡ºå¯„å­˜å™¨åŸæœ¬çš„å€¼ï¼Œå†å†™å…¥å¯„å­˜å™¨ä¸­.(å¤§éƒ¨åˆ†èŠ¯ç‰‡éƒ½é‡‡ç”¨è¿™ç§åè®® (set and clear protocol))</p>\n<p>å°ç»“ä¸€ä¸‹:</p>\n<ol>\n<li>æœ‰å¤šç»„ GPIO, æ¯ç»„æœ‰å¤šä¸ª GPIO</li>\n<li>ä½¿èƒ½ï¼šç”µæº / æ—¶é’Ÿ</li>\n<li>æ¨¡å¼ (Mode): å¼•è„šå¯ç”¨äº GPIO æˆ–å…¶ä»–åŠŸèƒ½</li>\n<li>æ–¹å‘ï¼šå¼•è„š Mode è®¾ç½®ä¸º GPIO æ—¶ï¼Œå¯ä»¥ç»§ç»­è®¾ç½®å®ƒæ˜¯è¾“å‡ºå¼•è„šï¼Œè¿˜æ˜¯è¾“å…¥å¼•è„š</li>\n<li>æ•°å€¼ï¼šå¯¹äºè¾“å‡ºå¼•è„šï¼Œå¯ä»¥è®¾ç½®å¯„å­˜å™¨è®©å®ƒè¾“å‡ºé«˜ã€ä½ç”µå¹³<br />\nå¯¹äºè¾“å…¥å¼•è„šï¼Œå¯ä»¥è¯»å–å¯„å­˜å™¨å¾—åˆ°å¼•è„šçš„å½“å‰ç”µå¹³</li>\n</ol>\n<h3 id=\"stm32mp157-æ“ä½œ-ç‚¹äº®-led-çš„å¯„å­˜å™¨\"><a class=\"anchor\" href=\"#stm32mp157-æ“ä½œ-ç‚¹äº®-led-çš„å¯„å­˜å™¨\">#</a> STM32MP157 æ“ä½œ ç‚¹äº® LED çš„å¯„å­˜å™¨</h3>\n<h4 id=\"æ—¶é’Ÿé…ç½®\"><a class=\"anchor\" href=\"#æ—¶é’Ÿé…ç½®\">#</a> æ—¶é’Ÿé…ç½®</h4>\n<p>ä¸Šé¢å’±ä»¬è¯´è¿‡ ç‚¹äº® LED éœ€è¦ï¼Œå…ˆä½¿èƒ½ å¯¹åº”çš„ ç”µæºæ€»çº¿è¿›è¡Œä½¿èƒ½ï¼Œ<br />\n è¿™ä¸€éƒ¨åˆ†å°±éœ€è¦æŸ¥çœ‹æ•°æ®æ‰‹å†Œå¯¹åº”çš„å¯„å­˜å™¨æ“ä½œï¼Œè¿™é‡Œæ¶‰åŠåˆ° RCC æ¨¡å—ï¼ŒRCC æ˜¯ç®¡ç†å¤ä½ å’Œ æ—¶é’Ÿæ§åˆ¶çš„æ¨¡å—<br />\nåœ¨æ‰‹å†Œçš„ 10.2 ç« èŠ‚ä¸­æ‰¾åˆ°çœ‹è§ä¸€å¼  RCC æ¨¡å—çš„åŠŸèƒ½æ¡†å›¾ï¼Œè¿™é‡Œç›´è§‚çš„è¡¨ç¤ºå‡ºäº† RCC ä¸ªä¸­åŠŸèƒ½<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.5zihk7u9e2w0.jpg\" alt=\"image\" /><br />\n åœ¨å›¾çš„ä¸‹é¢ï¼Œå¯ä»¥çœ‹è§ PLLx çš„åŠŸèƒ½ï¼Œå’±ä»¬çš„è¦ä½¿ç”¨çš„ PLL4 å³ä¾§å¾ˆæ˜æ˜¾æœ‰  <code>per_clk</code> , GPIO æ˜¯ä¸€ç§æœ€åŸºæœ¬çš„å¤–è®¾ï¼Œæ‰€ä»¥å’±ä»¬æ‰¾å¯¹ PLL äº†<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.4fm6fxyf0480.jpg\" alt=\"image\" /><br />\n è®©å’±ä»¬ç»§ç»­å‘ä¸‹æ‰¾ä¸€æ‰¾ï¼Œåœ¨æ•°æ®æ‰‹å†Œçš„ 522 é¡µï¼ŒRCC çš„ 10.4 ç« èŠ‚ï¼ŒåŠŸèƒ½æè¿°éƒ¨åˆ†ï¼Œæœ‰ç€è¿™ä¹ˆä¸€æ®µè¯</p>\n<blockquote>\n<p>The RCC provides up to 4 PLLs, each of them can be configured with integer or fractional<br />\nratios.<br />\nâ€¢ The PLL1 is dedicated to the MPU clocking<br />\nâ€¢ The PLL2 provides:<br />\nâ€“ The clocks for the AXI-SS (including APB4, APB5, AHB5 and AHB6 bridges)<br />\nâ€“ The clocks for the DDR interface<br />\nâ€“ The clocks for the GPU<br />\nâ€¢ The PLL3 provides:<br />\nâ€“ The clocks for the MCU, and its bus matrix (including the APB1, APB2, APB3,<br />\nAHB1, AHB2, AHB3 and AHB4)<br />\nâ€“ The kernel clocks for peripherals<br />\nâ€¢ The PLL4 is dedicated to the generation of the kernel clocks for various peripherals</p>\n</blockquote>\n<p>å¯ä»¥çœ‹åˆ°ï¼ŒåŸæ–‡ä¸­è¡¨ç¤º PLL4 æ˜¯ä¸“é—¨ç”¨äº ç”Ÿæˆå„ç§å¤–è®¾æ—¶é’Ÿçš„å†…æ ¸æ—¶é’Ÿï¼Œè¿˜ç”¨äº†  <code>dedicated to</code>  æ¥è¡¨ç¤ºä¸“é—¨ï¼Œè¯´æ˜è‚¯å®šæ²¡æ‰¾é”™ PLL<br />\n å†å¾€ä¸‹ä¹Ÿèƒ½çœ‹åˆ°æ›´è¯¦ç»†çš„å…³äº RCC æ¨¡å—çš„æ¡†å›¾<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.4669sb2k6uy.jpg\" alt=\"image\" /></p>\n<p>è¿™æ—¶å€™å°±è¯¥å»æ‰¾ RCC çš„å¯„å­˜å™¨å•¦ï¼Œå½“ç„¶å’Œ PLL4 ç›¸å…³çš„æ‰‹å†Œè‚¯å®šä¼šæœ‰å¾ˆå¤šï¼Œè¿™æ—¶å€™å½“ç„¶æ˜¯æ‰¾ ç±»ä¼¼äº CR å¯„å­˜å™¨ï¼Œè€Œä¸”å¤§æ¦‚ç‡æ˜¯ RCC_CR<br />\n è‡³äºä¸ºä»€ä¹ˆï¼ŒCR æ˜¯  <code>Control Register</code>  çš„ç¼©å†™ï¼Œè€Œ PLL4 å½’å±äº RCC é‚£ä¹ˆä¸€å®šè¦å…ˆåœ¨ RCC ä¸­ä½¿èƒ½ï¼Œä½¿èƒ½æ˜¯ä¸€ç§ä¸­æ§åˆ¶æ“ä½œï¼Œé‚£å¿…ç„¶å°±æ˜¯ CR å¯„å­˜å™¨å•¦<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.3mcbh2qugls0.jpg\" alt=\"image\" /><br />\n å¾ˆæ˜¾ç„¶ï¼ŒçŒœé”™åå­—äº†ï¼Œå·®äº†ä¸ª PLL4, ä¸è¿‡å¤§å·®ä¸å·®.<br />\n ä»ä¸‹é¢çš„æ–‡å­—ä¸­å¯ä»¥çœ‹å‡º 0 bit ä½æ˜¯ä½¿èƒ½ä½ï¼Œåªè¦æŠŠè¿™ä¸€ä½ç½® 1 å³å¯ä½¿èƒ½ PLL4<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.4pj7jg02kpw0.jpg\" alt=\"image\" /></p>\n<p>ç”±å¯„å­˜å™¨è¡¨å¯çŸ¥ RCC_PLL4CR, ä¸ºæ§åˆ¶ å¤–è®¾çš„æ—¶é’Ÿçº¿ï¼Œä½¿èƒ½åªéœ€è¦æ‹‰é«˜ç¬¬ä¸€ä½ï¼Œåœ¨ä¸å½±å“å…¶ä»–ä½çš„æƒ…å†µä¸‹<br />\nå’±ä»¬å¯ä»¥è¿™ä¹ˆå†™  <code>RCC_PLL4CR |= (1 &lt;&lt; 0)</code> <br />\n PLL4 çš„ä½¿èƒ½å¹¶ä¸æ˜¯ç¬é—´çš„ï¼Œæ‰€ä»¥åœ¨æ“ä½œä¹‹å‰éœ€è¦ç­‰å¾…ï¼ŒPLL4 å‡†å¤‡å¥½ï¼Œå³ç­‰å¾… RCC_PLL4CR çš„  <code>PLL4REDY</code>  ä½å¤ä½ï¼Œæ‰ç®—å¯åŠ¨æˆåŠŸ<br />\nè¿™é‡Œå’±å¯ä»¥è¿™æ ·å†™  <code>RCC_PLL4CR &amp; (1 &lt;&lt; 1)</code>  æ¥æ£€æµ‹ PLL4 æ˜¯å¦ä½¿èƒ½</p>\n<p>å¯¹äº ARM æ¶æ„çš„èŠ¯ç‰‡æ¥è¯´ï¼Œå¤§éƒ¨åˆ†å¤–è®¾éƒ½æ˜¯å…³é—­çš„ï¼Œæ‰€ä»¥è¦é…ç½®ä¸€ä¸ªå¤–è®¾ä¹‹å‰å¿…é¡»è¦åšçš„äº‹æƒ…æ˜¯ï¼Œä½¿èƒ½å¯¹åº”çš„å¤–è®¾æ—¶é’Ÿ<br />\nä¸€èˆ¬æ¥è¯´ï¼Œå¤–è®¾æ—¶é’Ÿçš„ä½¿èƒ½éƒ½æ˜¯  <code>AxBx_ENSETR</code> , ä½†æ˜¯è¿™é‡Œæœ‰ä¸€ä¸ªå¾ˆå¤§çš„é—®é¢˜ï¼Œå¦‚ä½•ç¡®å®šè¿™äº›å¤–è®¾åˆ°åº•å½’å±äºå“ªäº›æ€»çº¿ç®¡ç†ï¼Ÿ<br />\n å…¶å®åœ¨æ–‡æ¡£ä¸­æœ‰ä¸€ç« èŠ‚å«åš  <code>Memory and bus architecture</code>  è¿™é‡Œä»‹ç»äº†å†…å­˜åˆ†å¸ƒå’Œæ€»çº¿æ¶æ„<br />\nåœ¨ 2.1.2 Memory Map Organization ä¸­æœ‰ä¸€èŠ‚ Peripherals clusters çš„å†…å®¹ï¼Œç¬¬ä¸€æ®µå°±æ¶‰åŠåˆ°äº† GPIO å¤–è®¾</p>\n<blockquote>\n<p>AHB4/APB3<br />\nThis cluster groups important system functions as clock and power control, system<br />\nconfiguration, most GPIOs control, plus some additional timers and low-speed<br />\ncommunication interfaces</p>\n</blockquote>\n<p>è¿™é‡Œå¤§è‡´æ„æ€å°±æ˜¯ AHB3 å’Œ AHB4, ç®¡ç†ç³»ç»Ÿé…ç½®ã€ç”µæºã€æ—¶é’Ÿå’Œ GPIO ä»¥åŠä¸€éƒ¨åˆ†å®šæ—¶å™¨å’Œä½é€Ÿé€šä¿¡æ¥å£<br />\né‚£è¿™å°±å¾ˆæ˜ç¡®äº†ï¼Œç›´æ¥å»å¯»æ‰¾ AHB3 å’Œ AHB4 ç›¸å…³çš„å¯„å­˜å™¨ï¼Œç›´æ¥æŸ¥æ‰¾ä¼šå¥½ä¸€äº›<br />\nè¿™é‡Œå¯ä»¥éœ€è¦æ³¨æ„ä¸€ä¸‹å› ä¸ºç”¨çš„ A7 å†…æ ¸ï¼Œæ‰€ä»¥è¦æ‰¾ Enable for MPU çš„<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.71ao3rrjvn80.png\" alt=\"image\" /></p>\n<h4 id=\"gpio-é…ç½®\"><a class=\"anchor\" href=\"#gpio-é…ç½®\">#</a> gpio é…ç½®</h4>\n<p>å’Œä¸€èˆ¬çš„ A ç³»åˆ— æˆ– M ç³»åˆ— çš„ ARM ä¸åŒï¼Œ157 çš„å¼•è„šè¢« å’ŒåŠŸèƒ½è¢«ä¸åŒçš„æ¨¡å—å¤ç”¨ï¼Œæœ‰äº› M4 ä¸“ç”¨ï¼Œæœ‰äº› A7 ä¸“ç”¨ï¼Œè¿˜æœ‰äº›äºŒè€…å¤ç”¨<br />\nä½†æ˜¯ä¸ç®¡æ˜¯ A ç³»åˆ—è¿˜æ˜¯ M ç³»åˆ—ï¼Œå¼•è„šé…ç½®çš„æ€è·¯åº”è¯¥å¤§å·®ä¸å·®ï¼Œå…·ä½“çš„é…ç½®æ–¹å¼å‚è€ƒ æ–‡æ¡£çš„ç¬¬ 13 ç« çš„ Table 81, ä»¥åŠ 13.3.10 å°ç»“<br />\nè¿™éƒ¨åˆ†å¯¹ GPIO çš„é…ç½®æœ‰ä¸“é—¨çš„è®²è§£<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.5w9pjj2uj8o0.jpg\" alt=\"image\" /><br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.6v92b3xqers0.jpg\" alt=\"image\" /></p>\n<p>è¿™é‡Œæˆ‘å°±ç›´æ¥é€šè¿‡å¯„å­˜å™¨è¡¨æ¥æŸ¥çœ‹ç›¸å…³é…ç½®å•¦</p>\n<p>é¦–å…ˆé…ç½® GPIO çš„å·¥ä½œæ¨¡å¼ï¼Œæ–‡ç« å¼€å§‹è¯´è¿‡ï¼Œç°åœ¨çš„ GPIO éƒ½æ˜¯èº«å…¼æ•°èŒï¼Œæ‰€ä»¥éœ€è¦å…ˆæŒ‡å®šå®ƒå·¥ä½œåœ¨å“ªä¸ªèŒè´£ä¸Š<br />\nè¿™ä¸ªå°±æ¶‰åŠ GPIO_MODER å¯„å­˜å™¨<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.1uns4ldco4o0.jpg\" alt=\"image\" /><br />\n ä»å›¾ä¸­å¯ä»¥çœ‹åˆ° GPIO è¾“å‡ºæ¨¡å¼éœ€è¦å°†å¯¹åº”çš„ä½é…ç½®ä¸º 01<br />\n ä¼ªä»£ç å¯ä»¥è¿™æ ·å®ç°  <code>GPIOA_MODER &amp;= ~(3 &lt;&lt; 20); GPIOA_MODER |= (1 &lt;&lt; 20)</code> ;</p>\n<p>æ¥ä¸‹å»å°±å…ˆä¸é…ç½®ä¸Šä¸‹æ‹‰ï¼Œè¾“å‡ºé€Ÿåº¦ä¹‹ç±»çš„ï¼Œåªå…ˆçœ‹ä¸€ä¸‹è¾“å‡ºç±»å‹é»˜è®¤æ–¹å¼ï¼Œæ˜¯æ¨æŒ½ è¿˜æ˜¯å¼€æ¼çš„æ¨¡å¼äº† (å› ä¸ºé»˜è®¤æ¨æŒ½)<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.2l4tbhj1qie0.jpg\" alt=\"image\" /><br />\n ç›´æ¥å¿«è¿›åˆ° è¾“å‡º<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.59rxw8n915c0.jpg\" alt=\"image\" /><br />\n ä»å›¾ä¸­å¯çŸ¥ï¼Œè¦æƒ³è¾“å‡ºå¯¹åº”ç”µå¹³åªéœ€è¦ï¼Œå°†ç”µå¹³å†™å…¥å¯¹åº”ä½å³å¯ï¼Œå³  <code>GPIOA_ODR |= (1 &lt;&lt; 10); GPIOA_ODR &amp;= (1 &lt;&lt; 10);</code></p>\n<p>åˆ°æ­¤ï¼Œæ•´ä¸ªé€»è¾‘å±‚å°±æ‹å‡ºæ¥äº†<br />\nè‡³äºä»£ç å®ç°å°±å°±æŒ‰ç€è¿™ä¸ªé€»è¾‘å³å¯ï¼Œè¿™é‡Œè´´ä¸€ä»½æˆ‘çš„ä»£ç </p>\n<h5 id=\"ä»£ç \"><a class=\"anchor\" href=\"#ä»£ç \">#</a> ä»£ç </h5>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">USE_A7</span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">delay</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">volatile</span> <span class=\"token keyword\">long</span> ntime<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>ntime<span class=\"token operator\">--</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">volatile</span> <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> <span class=\"token operator\">*</span>p_reg<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token comment\">/* ä½¿èƒ½ PLL4 */</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    p_reg <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">volatile</span> <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x50000000</span> <span class=\"token operator\">+</span> <span class=\"token number\">0x894</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token operator\">*</span>p_reg <span class=\"token operator\">|=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token comment\">// ç­‰å¾…æ—¶é’Ÿç¨³å®š</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>p_reg <span class=\"token operator\">&amp;</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token comment\">/* ä½¿èƒ½ GPIOA */</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">ifdef</span> <span class=\"token expression\">USE_A7</span></span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    p_reg <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">volatile</span> <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x50000000</span> <span class=\"token operator\">+</span> <span class=\"token number\">0xA28</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token operator\">*</span>p_reg <span class=\"token operator\">|=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">ifdef</span> <span class=\"token expression\">USE_M4</span></span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    p_reg <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">volatile</span> <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x50000000</span> <span class=\"token operator\">+</span> <span class=\"token number\">0xAA8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token operator\">*</span>p_reg <span class=\"token operator\">|=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    <span class=\"token comment\">/* è®¾ç½® GPIO10 ä¸ºè¾“å‡ºæ¨¡å¼ */</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    p_reg <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">volatile</span> <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x50002000</span> <span class=\"token operator\">+</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    <span class=\"token operator\">*</span>p_reg <span class=\"token operator\">&amp;=</span> <span class=\"token operator\">~</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    <span class=\"token operator\">*</span>p_reg <span class=\"token operator\">|=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    <span class=\"token comment\">// æŒ‡å‘ (GPIOA_ODR)</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    p_reg <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">volatile</span> <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x50002000</span> <span class=\"token operator\">+</span> <span class=\"token number\">0x14</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    <span class=\"token comment\">/* æ‰§è¡Œä»»åŠ¡ */</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>        <span class=\"token comment\">/* è®¾ç½® LED ç”µå¹³å˜åŒ– */</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>        <span class=\"token operator\">*</span>p_reg <span class=\"token operator\">|=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>        <span class=\"token function\">delay</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>        <span class=\"token operator\">*</span>p_reg <span class=\"token operator\">&amp;=</span> <span class=\"token operator\">~</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>        <span class=\"token function\">delay</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>å¯åŠ¨æ–‡ä»¶</p>\n<pre><code class=\"language-ASM\">.text\n.global  _start\n_start: \t\t\t\n\n\t/* è®¾ç½®sp */\n\tldr sp, =0xc0000000 + 0x100000\n\n\t/* è°ƒç”¨mainå‡½æ•° */\n\tbl main\n</code></pre>\n<p>makefile</p>\n<figure class=\"highlight makefile\"><figcaption data-lang=\"makefile\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>PREFIX<span class=\"token operator\">=</span>arm-linux-gnueabihf-</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>CC<span class=\"token operator\">=</span><span class=\"token variable\">$</span><span class=\"token punctuation\">(</span>PREFIX<span class=\"token punctuation\">)</span>gcc</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>LD<span class=\"token operator\">=</span><span class=\"token variable\">$</span><span class=\"token punctuation\">(</span>PREFIX<span class=\"token punctuation\">)</span>ld</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>AR<span class=\"token operator\">=</span><span class=\"token variable\">$</span><span class=\"token punctuation\">(</span>PREFIX<span class=\"token punctuation\">)</span>ar</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>OBJCOPY<span class=\"token operator\">=</span><span class=\"token variable\">$</span><span class=\"token punctuation\">(</span>PREFIX<span class=\"token punctuation\">)</span>objcopy</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>OBJDUMP<span class=\"token operator\">=</span><span class=\"token variable\">$</span><span class=\"token punctuation\">(</span>PREFIX<span class=\"token punctuation\">)</span>objdump</pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token target symbol\">led.img</span> <span class=\"token punctuation\">:</span> start.S main.c</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t<span class=\"token variable\">$</span><span class=\"token punctuation\">(</span>CC<span class=\"token punctuation\">)</span> -nostdlib -g -c -o start.o start.S</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t<span class=\"token variable\">$</span><span class=\"token punctuation\">(</span>CC<span class=\"token punctuation\">)</span> -nostdlib -g -c -o main.o main.c</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t<span class=\"token variable\">$</span><span class=\"token punctuation\">(</span>LD<span class=\"token punctuation\">)</span> -T stm32mp157.lds -g start.o main.o -o led.elf </pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\t<span class=\"token variable\">$</span><span class=\"token punctuation\">(</span>OBJCOPY<span class=\"token punctuation\">)</span> -O binary -S led.elf  led.bin</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\t<span class=\"token variable\">$</span><span class=\"token punctuation\">(</span>OBJDUMP<span class=\"token punctuation\">)</span> -D -m arm  led.elf  > led.dis</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\tmkimage -A arm -T firmware -C none -O u-boot -a 0xC0100000 -e 0 -d led.bin led.img </pre></td></tr><tr><td data-num=\"17\"></td><td><pre>\tmkimage -T stm32image -a 0xC0100000 -e 0xC0100000 -d led.bin led.stm32 </pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token target symbol\">clean</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>\trm -f led.dis  led.bin led.elf led.img *.o *.log</pre></td></tr></table></figure><h2 id=\"å…¶å®ƒæ³¨æ„\"><a class=\"anchor\" href=\"#å…¶å®ƒæ³¨æ„\">#</a> å…¶å®ƒæ³¨æ„</h2>\n<p>çƒ§å½•çš„è¯ç›®å‰æˆ‘æ²¡æœ‰ç ”ç©¶æ˜ç™½ï¼Œæš‚æ—¶è·Ÿç€éŸ¦ä¸œå±±è€å¸ˆçš„è¯¾ç¨‹æ¥ï¼Œèµ° USB ä¸‹è½½ï¼Œçƒ§å…¥åˆ° RAM ä¸­<br />\nè¦æ³¨æ„çš„æ˜¯ï¼Œéœ€è¦ä¿®æ”¹ä¸€ä¸‹  <code>led.stm32</code>  çš„åœ°å€<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.5hub87mcflc0.jpg\" alt=\"image\" /></p>\n<h2 id=\"å‚è€ƒæ–‡çŒ®\"><a class=\"anchor\" href=\"#å‚è€ƒæ–‡çŒ®\">#</a> å‚è€ƒæ–‡çŒ®</h2>\n<p>[1] Linux å®Œå…¨å¼€å‘æ‰‹å†Œã€‚éŸ¦ä¸œå±±<br />\n [2] STM32MP157 æ•°æ®æ‰‹å†Œ<br />\n [3] <span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuMTAwYXNrLm5ldC9wL3RfcGMvY291cnNlX3BjX2RldGFpbC9jb2x1bW4vcF81Zjg1NzkxZWU0YjA2YWZmMWEwM2Q2MTQ/Y29udGVudF9hcHBfaWQ9\">https://www.100ask.net/p/t_pc/course_pc_detail/column/p_5f85791ee4b06aff1a03d614?content_app_id=</span></p>\n<hr />\n<p>å¤§é“äº”åï¼Œå¤©è¡å››åä¹ï¼Œäººéå…¶ä¸€ï¼</p>\n",
            "tags": [
                "åµŒå…¥å¼",
                "STM32",
                "STM32"
            ]
        },
        {
            "id": "https://to-ywz.github.io/blog/hexo%E5%8D%9A%E5%AE%A2%E4%BD%BF%E7%94%A8%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95/",
            "url": "https://to-ywz.github.io/blog/hexo%E5%8D%9A%E5%AE%A2%E4%BD%BF%E7%94%A8%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95/",
            "title": "hexoåšå®¢ä½¿ç”¨é—®é¢˜è®°å½•",
            "date_published": "2023-06-17T10:38:47.000Z",
            "content_html": "<h1 id=\"hexo-blog-ä½¿ç”¨bugé—®é¢˜è®°å½•\"><a class=\"anchor\" href=\"#hexo-blog-ä½¿ç”¨bugé—®é¢˜è®°å½•\">#</a> hexo blog ä½¿ç”¨ bug é—®é¢˜è®°å½•</h1>\n<h2 id=\"hexo-d-å‡ºç°warning-lf\"><a class=\"anchor\" href=\"#hexo-d-å‡ºç°warning-lf\">#</a> hexo d å‡ºç° &quot;warning: LF&quot;</h2>\n<p>å…ˆè¯´ç»“è®ºï¼Œå‡ºç°å¦‚ä¸‹çš„è­¦å‘Šï¼Œå…¶å®æ˜¯å¯ä»¥ç›´æ¥å¿½è§†çš„ï¼Œä¸ä¼šå½±å“ç¼–è¯‘åçš„ç»“æœ<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.6krjwmiaz080.webp\" alt=\"image\" /><br />\n ç½‘ä¸Šèƒ½ Google åˆ°ä¸€å¤§å †è§£å†³æ–¹æ¡ˆéƒ½æ˜¯åƒç¯‡ä¸€å¾‹çš„ï¼Œå°†  <code>core.autocrlf</code>  è®¾ç½®ä¸º  <code>false</code> .<br />\n è¿™æ ·å¯ä»¥ç›´æ¥è§£å†³è­¦å‘Šæç¤ºï¼Œä½†æ˜¯å¾ˆæ˜¾ç„¶ï¼Œå…¨å±€åŒ–çš„å¤„ç†å¿…ç„¶ä¼šå¸¦æ¥æ›´å¤šçš„éšæ€§é—®é¢˜<br />\næ‰€ä»¥ï¼Œè¿˜æ˜¯å¾ˆæœ‰å¿…è¦å»å¼„æ¸…æ¥šä¸ºä»€ä¹ˆï¼Œç„¶åå†æ‰¾å‡ºåˆç†çš„æ–¹æ¡ˆè§£å†³è¿™ä¸ªé—®é¢˜</p>\n<h3 id=\"åˆ†æ\"><a class=\"anchor\" href=\"#åˆ†æ\">#</a> åˆ†æ</h3>\n<p>è¿™å’Œä¸ªé—®é¢˜çš„æœ¬è´¨æºå¤´å’Œ  <code>git add</code>  å‡ºç° &quot;LF&quot; è­¦å‘Šæ˜¯ä¸€è‡´çš„<br />\nåœ¨ Windows ä¸­ä½¿ç”¨ CRLF ( <code>\\r\\n</code> ) åšä½œä¸ºè¡Œå°¾ç¬¦ï¼Œè€Œåœ¨ Linux ç³»ç»Ÿä¸­åˆ™ä½¿ç”¨ LF ( <code>\\n</code> )<br />\n CRLF å³ Carriage-Return Line-Feed çš„ç¼©å†™<br />\n Git ä¸ä¿®æ”¹æ–‡ä»¶å†…å®¹ï¼Œä½†é»˜è®¤ä¼šå°†å…¥åº“çš„æ–‡ä»¶çš„è¡Œå°¾ç¬¦è®¾ç½®ä¸º LF, ä¼šå°†æ£€å‡ºçš„æ–‡ä»¶çš„è¡Œå°¾ç¬¦è®¾ç½®ä¸º CRLF, åœ¨æ‰§è¡Œæ—¶å‡ºç°ä¸Šé¢çš„è­¦å‘Š<br />\nå·¥ä½œç›®å½•ä¸­çš„æ–‡ä»¶çš„è¡Œå°¾æ˜¯ LF, ä½†æ˜¯è¿™é‡Œåœ¨å³å°†å…¥ Git åº“ä¹‹å‰ä¼šå°† LF è½¬æ¢ä¸º CRLF, æ‰€ä»¥ç»™å‡º  <code>LF will be replaced by CRLF in &lt;file-name&gt;</code>  çš„è­¦å‘Š<br />\nå…¶å®å…¶ç›®çš„æ˜¯åœ¨å‘Šè¯‰æˆ‘ä»¬ï¼Œæºæ–‡ä»¶ä¸ä¼šè¢«ä¿®æ”¹ï¼Œä½†æ˜¯åœ¨ git ä»“åº“ä¸­çš„æ–‡ä»¶ LF ä¼šè¢«è®¾ç½®ä¸º CRLF.<br />\n å› æ­¤åœ¨  <code>&quot;LF will be replaced by CRLF in &lt;file-name&gt;</code>  è­¦å‘Šåé¢å¾€å¾€ä¼šæœ‰ä¸€å¥  <code>&quot;The file will have its original line endings in your working directory.&quot;</code> <br />\n æ‰€ä»¥  <code>core.autocrlf</code>  çš„é…ç½®æ˜¯ç”¨äºæ£€æµ‹è·¨å¹³å°çš„ï¼Œå¦‚æœå°†å…¶è®¾ç½®ä¸º  <code>false</code>  åˆ™å¯èƒ½å‡ºç°ä¸€äº›å¾ˆéš¾å‘ç°çš„ bug<br />\n ä¾‹å¦‚ï¼Œæˆ‘åœ¨åš ftp å¼€å‘æ—¶ï¼Œftp server æ˜¯è¿è¡Œåœ¨ linux ä¸Šçš„ï¼Œè€Œä»æœº MCU å¼€å‘æ˜¯åœ¨ windows ä¸Šå®ç°çš„ï¼Œåœ¨æ–°å»ºæ–‡ä»¶å¤¹å‘½ä»¤ä¸­å¤šå‡ºäº†ä¸€ä¸ªç©ºæ ¼ï¼Œä½¿ç”¨ windows çš„ ftp å®¢æˆ·ç«¯å»æŸ¥çœ‹æ—¶è·Ÿæœ¬æ— æ³•è¾¨åˆ«ï¼Œè€Œåœ¨ linux ä¸Šä¼šæ˜¾ç¤ºå‡ºä¸€ä¸ª  <code>\\ </code> çš„ç©ºæ ¼ï¼Œè¿™ä¸ª bug æŸ¥äº†åŠå¤©</p>\n<p>è€Œç°å°†  <code>core.autocrlf</code>  çš„æ£€æµ‹å…³é—­ï¼Œæœ€ç›´æ¥ä¼šå¯¼è‡´:</p>\n<ol>\n<li>pull linux æ–‡ä»¶åˆ°è‡ªå·±çš„ windows ç¯å¢ƒä¸‹ç”¨è®°äº‹æœ¬çœ‹çš„è¯ä¼šå‡ºç°é»‘ç‚¹</li>\n<li>Windows é‡Œçš„æ–‡ä»¶åœ¨ Mac ä¸‹æ‰“å¼€çš„è¯ï¼Œåœ¨æ¯è¡Œçš„ç»“å°¾å¯èƒ½ä¼šå¤šå‡ºä¸€ä¸ª ^M ç¬¦å· (æœªéªŒè¯ï¼Œç©·é¬¼æ²¡æœ‰ Mac, æ®è¯´ Mac æŠ•å¥”äº† Unix)</li>\n</ol>\n<h3 id=\"è§£å†³æ–¹æ¡ˆ\"><a class=\"anchor\" href=\"#è§£å†³æ–¹æ¡ˆ\">#</a> è§£å†³æ–¹æ¡ˆ</h3>\n<p>ç”±ä¸Šé¢å¯çŸ¥ï¼Œæš´åŠ›çš„å…¨å±€æ›´æ”¹ä¸ºä¸æ£€æµ‹å¹¶ä¸å¯å–ï¼Œé‚£ä¹ˆæœ‰æ²¡æœ‰ä»€ä¹ˆåˆç†çš„æ–¹æ³•å‘¢ï¼Ÿ<br />\n å¾ˆé—æ†¾ï¼Œå½“å¿…é¡»è·¨å¹³å°å¤„ç†åä½œçš„æ—¶å€™å°±ä¸èƒ½å…³é—­<br />\nä¸€èˆ¬æ¥è¯´ git çš„ Windows å®¢æˆ·ç«¯ä¼šé»˜è®¤è®¾ç½®  <code>core.autocrlf=true</code>  (å¯é€šè¿‡  <code>git config core.autocrlf</code>  å‘½ä»¤æŸ¥è¯¢æ˜¯å¦é»˜è®¤ true. å¦‚ä¸æ˜¯ true, é€šè¿‡  <code>config --global core.autocrlf true</code>  å‘½ä»¤è®¾ç½®è¯¥å±æ€§ä¸º true)<br />\n è€Œ  <code>core.autocrlf=true</code>  æœ‰ä»¥ä¸‹ 3 ä¸ªåŠŸèƒ½æ¥é¿å…æˆ‘ä»¬å‡ºç°æˆ‘ä»¬å‰é¢åˆ†ææ—¶æ‰€è¿°çš„é—®é¢˜:</p>\n<ol>\n<li>åœ¨æŠŠ  <code>modified</code>  ä¿®æ”¹è¿‡çš„æ–‡ä»¶  <code>git add</code>  åˆ°æš‚å­˜åŒº stageâ€ æ—¶ï¼ŒGit è‡ªåŠ¨æŠŠ LF è½¬æ¢æˆ CRLF, å¹¶ç»™å‡ºé‚£æ¡è­¦å‘Š &quot;LF will be replaced by CRLF&quot;</li>\n<li>åœ¨æŠŠ  <code>modified</code>  ä¿®æ”¹è¿‡çš„æ–‡ä»¶ç”±æš‚å­˜åŒº (stage) æäº¤ (commit) åˆ°ç‰ˆæœ¬åº“ / ä»“åº“ (repository) æ—¶ï¼ŒGit è‡ªåŠ¨æŠŠ CRLF è½¬æ¢æˆ LF</li>\n<li>åœ¨ç”¨  <code>check/git checkout</code>  åˆ‡æ¢åˆ°æŒ‡å®šåˆ†æ”¯ æˆ–  <code>git clone</code>  å…‹éš†è¿œç¨‹ç‰ˆæœ¬åº“â€ æ¥åŠ è½½ä»£ç æ—¶ï¼ŒGit è‡ªåŠ¨æŠŠ LF è½¬æ¢æˆ CRLF<br />\n æˆ‘ä»¬åšå®¢å±äºç¬¬ä¸€ç§</li>\n</ol>\n<p>ä¸è¿‡å¯¹äºæˆ‘ä»¬åªå†™åšå®¢ä¸è¿›è¡Œè·¨å¹³å°å¤„ç†çš„æƒ…å†µçš„è¯ï¼Œè¿˜æ˜¯æœ‰ä¸€ä¸ªå»ºè®®å¯ä»¥åœ¨ä½¿ç”¨ç¼–è¾‘å™¨çš„æ—¶å€™ï¼Œå°†ç¼–è¾‘å™¨çš„æ¢è¡Œæ ‡è¯†ç¬¦è¿›è¡Œé»˜è®¤è®¾ç½®<br />\nè¿™é‡Œä»‹ç» vscode çš„è§£å†³æ–¹æ³•</p>\n<ol>\n<li>vsocode çš„çš„å³ä¸‹è§’è®¾ç½®ä¸º CRLF<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.6y86xuenw300.webp\" alt=\"image\" /></li>\n<li>æ¯æ¬¡éƒ½æ‰‹åŠ¨è®¾ç½®å°±éå¸¸çš„ä¸åˆç†ï¼Œæ‰€ä»¥å¯ä»¥å»å·¥ä½œåŒºçš„è®¾ç½®ä¸­è®¾ç½®é»˜è®¤çš„æ–‡ä»¶æ¢è¡Œæ–¹æ³•ï¼Œè¿™æ ·å°±å¯ä»¥é¿å…å‡ºç°éœ€è¦è­¦å‘Šäº†<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.2mnd2tv5ls00.webp\" alt=\"image\" /></li>\n<li>å½“è®©ä¹Ÿå¯ä»¥åœ¨  <code>.vscode</code>  æ–‡ä»¶å¤¹ä¸­çš„  <code>setting.json</code>  æ–‡ä»¶ä¸­æ·»åŠ   <code>&quot;files.eol&quot;:&quot;\\r\\n&quot;</code></li>\n</ol>\n<h3 id=\"çŸ¥è¯†å¤§çˆ†ç‚¸\"><a class=\"anchor\" href=\"#çŸ¥è¯†å¤§çˆ†ç‚¸\">#</a> çŸ¥è¯†å¤§çˆ†ç‚¸</h3>\n<h4 id=\"cr-lf-å’Œ-lf-åŒºåˆ«\"><a class=\"anchor\" href=\"#cr-lf-å’Œ-lf-åŒºåˆ«\">#</a> CR-LF å’Œ LF åŒºåˆ«</h4>\n<p>LF: Line Feed æ¢è¡Œ<br />\n CRLF: Carriage Return Line Feed å›è½¦æ¢è¡Œ</p>\n<p>æ—©æœŸçš„æœºæ¢°æ‰“å­—æœºä¸Šä¸ªåä¸º **ã€Œå­—è½¦ã€<strong>(Typewriter carriage) çš„éƒ¨ä»¶ï¼Œç±»ä¼¼äºç°åœ¨çš„å…‰æ ‡ï¼Œæ‰“ä¸€ä¸ªå­—ç¬¦ï¼Œå­—è½¦å‰è¿›ä¸€æ ¼.<br />\n è€Œæ‰“å®Œä¸€è¡Œåï¼Œåˆ™éœ€è¦è®©å­—è½¦å›åˆ°èµ·å§‹ä½ç½®ï¼Œè¿™å°±æ˜¯</strong> Carriage Return** é”®æœ€æ—©çš„ä½œç”¨ï¼Œå› è€Œè¢«ç›´æ¥ç¿»è¯‘ä¸º **ã€Œå›è½¦ã€**<br />\n è™½ç„¶å›è½¦é”®çš„åŠŸèƒ½å·²ç»ä¸æ­¢ &quot;å€’å›å­—è½¦&quot; äº† (ä¾‹å¦‚ï¼Œæ³„æ„¤çš„å¤§å›è½¦é”®ï¼Œç‹—å¤´), ä½†è¿™ä¸ªè¯‘åä¿ç•™äº†ä¸‹æ¥</p>\n<h4 id=\"rä¸nçš„èµ·æº\"><a class=\"anchor\" href=\"#rä¸nçš„èµ·æº\">#</a> '\\r' ä¸ '\\n' çš„èµ·æº</h4>\n<p>è¿™æœ€æ—©èµ·æºäºç”µä¼ æ‰“å­—æœºï¼Œè¿™æ˜¯ä¸€ç§è¿œè·ç¦»ä¿¡æ¯ä¼ é€å™¨æ¢°ï¼Œé€šå¸¸ç”±é”®ç›˜ã€æ”¶å‘æŠ¥å™¨å’Œå°å­—æœºæ„ç­‰ç»„å‘æŠ¥æ—¶ï¼ŒæŒ‰ä¸‹æŸä¸€å­—ç¬¦é”®ï¼Œå°±èƒ½å°†è¯¥å­—ç¬¦çš„ç”µç ä¿¡å·è‡ªåŠ¨å‘é€åˆ°ä¿¡é“ï¼›æ”¶æŠ¥æ—¶ï¼Œèƒ½è‡ªåŠ¨æ¥æ”¶æ¥è‡ªä¿¡é“çš„ç”µç ä¿¡å·ï¼Œå¹¶æ‰“å°å‡ºç›¸åº”çš„å­—ç¬¦.<br />\n å¤§æ¦‚æ˜¯è¿™ä¸ªæ ·å­ï¼Œç»å¸¸å‡ºç°åœ¨äºŒæˆ˜æ—¶æœŸä¸ºèƒŒæ™¯çš„ç”µå½±ä¸­çš„æ‰“å­—æœºæ˜¯ä»–çš„ç¥–å…ˆè¾ˆä»½<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.1py4lg46v8w0.webp\" alt=\"image\" /><br />\n è¿™ç§æ‰“å­—æœºæœ‰ä¸€ä¸ªæ‰“å°å¤´å’Œæ»šè½®ï¼Œæ»šè½®ç”¨äºè°ƒæ•´çº¸çš„çºµå‘ç§»åŠ¨ã€‚æ¯å½“æ‰“å°å¤´æ‰“å°å®Œå½“å‰è¡Œåéœ€è¦å°†æ‰“å°å¤´ç§»åˆ°æœ€å·¦è¾¹ï¼Œæ»šè½®éœ€è¦æŠŠçº¸å‘ä¸‹ç§»åŠ¨ä¸€è¡Œã€‚ç”±äºè¿™ä¸¤ä¸ªæ“ä½œéœ€è¦çš„æ—¶é—´è¿œå¤§äºç”µä¿¡å·ä¼ è¾“çš„æ—¶é—´ï¼Œå¯èƒ½ä¼šå¯¼è‡´åœ¨æ“ä½œè¿‡ç¨‹ä¸­ç”µä¿¡å·çš„ä¸¢å¤±ã€‚è€Œè§£å†³è¿™ä¸ªé—®é¢˜çš„æ–¹æ¡ˆæ˜¯ç‰©ç†è¡¥å¿ï¼Œè¦æ±‚æ¯è¡Œéƒ½åŠ ä¸Š  <code>\\r\\n</code>  è¿™ä¸¤ä¸ªå­—ç¬¦ï¼Œç”¨äºè¡¥å¿ç‰©ç†è®¾å¤‡æ“ä½œçš„æ—¶é—´<br />\n <code>\\r</code>  ä»£è¡¨æ‰“å°å¤´å·¦ç§»å¯¹åº” CR, è€Œ  <code>\\n</code>  æ»šè½®æ»šåŠ¨æ“ä½œå¯¹åº” LF.</p>\n<h4 id=\"é‚£ä¹ˆä¸ºä»€ä¹ˆè¦åˆ†æˆä¸¤ä¸ªå­—ç¬¦\"><a class=\"anchor\" href=\"#é‚£ä¹ˆä¸ºä»€ä¹ˆè¦åˆ†æˆä¸¤ä¸ªå­—ç¬¦\">#</a> é‚£ä¹ˆä¸ºä»€ä¹ˆè¦åˆ†æˆä¸¤ä¸ªå­—ç¬¦ï¼Ÿ</h4>\n<p>å…¶å®ç†ç”±å¾ˆç®€å•ï¼Œå› ä¸ºæµ‹è¯•å‡ºæ¥çš„ç»“æœæ˜¯ä¸€ä¸ªå­—ç¬¦è¾“å…¥åï¼ŒCRLF çš„æ“ä½œå¹¶æ²¡æœ‰å®Œæˆï¼Œè¿›è€Œå¯¼è‡´ç§»åŠ¨åˆ°ä¸€åŠçš„æ—¶å€™æ‰“å°å‡ºé”™ä½çš„æ–‡å­—ã€‚æ‰€ä»¥å¹²é”™è®¾è®¡ä¸ºä¸¤ä¸ªå­—ç¬¦æ¥é¿å…è¿™ä¸ªé—®é¢˜.<br />\n è™½ç„¶è¿™ä¸ªç†ç”±å¾ˆæ— å˜å¤´ï¼Œä½†è¿™å°±æ˜¯æœ€èŠ‚çœæˆæœ¬çš„è§£å†³æ–¹å¼</p>\n<h4 id=\"ä¸ºä»€ä¹ˆä¸æ˜¯-nrå‘¢\"><a class=\"anchor\" href=\"#ä¸ºä»€ä¹ˆä¸æ˜¯-nrå‘¢\">#</a> ä¸ºä»€ä¹ˆä¸æ˜¯  <code>\\n\\r</code>  å‘¢ï¼Ÿ</h4>\n<p>å› ä¸º  <code>\\r</code>  æ‰€æ¶ˆè€—çš„æ—¶é—´ä¼šæ›´é•¿ï¼Œä¿è¯åœ¨ä¸¤ä¸ªå­—ç¬¦è¾“å…¥å®Œæˆå‰å®ç° CR-LF çš„æ“ä½œï¼Œè¦ä¸ç„¶ä¹Ÿä¼šå‡ºç°ä¸€ä¸ªå­—ç¬¦è®¾è®¡ç‰ˆæœ¬çš„é—®é¢˜</p>\n<h2 id=\"nodejs-14-accessing-non-existent-propertyé—®é¢˜\"><a class=\"anchor\" href=\"#nodejs-14-accessing-non-existent-propertyé—®é¢˜\">#</a> Node.js 14 Accessing non-existent property é—®é¢˜</h2>\n<p>-------------------20230617---------------------------</p>\n<p>ä»Šå¤©æ—©æ›´æ–°ä¸»é¢˜ä¸€ä¸å°å¿ƒæŠŠ  <code>_config.yml</code>  æ–‡ä»¶è¦†ç›–äº†ï¼Œ/(ã„’ o ã„’)/~~</p>\n<p>ä¹‹å‰ç¯å¢ƒé…ç½®ä¹Ÿå­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œæ‰€ä»¥å¹²è„†é‡æ–°æ­å»ºä¸€éç¯å¢ƒ</p>\n<p>ç»“æœåœ¨ç¼–è¯‘çš„æ—¶å€™å‡ºç°äº†è¿™ä¸ªè­¦å‘Šï¼Œæœ¬ç€ä¸æ”¾è¿‡ä»»ä½•ä¸€ä¸ªè­¦å‘Šçš„ç²¾ç¥ï¼Œæˆ‘å» google äº†ä¸€ä¸‹<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.4gexhvdisp00.webp\" alt=\"image\" /></p>\n<p>ç»“æœï¼Œä½†éƒ¨åˆ†éƒ½è¯´æ˜¯æ— å…³ç´§è¦çš„è­¦å‘Šï¼Œæ˜¯å› ä¸º Node Js çš„ç‰ˆæœ¬è¿‡é«˜ï¼Œå¯ä»¥å¿½ç•¥æˆ–è€…å¼ºåˆ¶é™ä½è­¦å‘Šä¼˜å…ˆçº§</p>\n<p>ç›®å‰æš‚æ—¶æ²¡æœ‰æ‰¾åˆ°æ›´å¥½çš„è§£å†³æ–¹æ¡ˆï¼Œè€Œä¸”è¿˜æœ‰ä¸€å¤§å † bug æ²¡ä¿®ï¼Œæ‰€ä»¥æš‚æ—¶æç½®ä¸€ä¸‹</p>\n<h4 id=\"æœ¬æ–‡å‚è€ƒæ¥æº\"><a class=\"anchor\" href=\"#æœ¬æ–‡å‚è€ƒæ¥æº\">#</a> æœ¬æ–‡å‚è€ƒæ¥æº</h4>\n<p><strong>[1] <span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21yYm9uZTExL2FydGljbGUvZGV0YWlscy8xMDQwNTIxMzc=\">https://blog.csdn.net/mrbone11/article/details/104052137</span></strong><br />\n<strong>[2] <span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuZmluY2xpcC5jb20vbmV3cy9mLzExNjc4Lmh0bWw=\">https://www.finclip.com/news/f/11678.html</span></strong><br />\n<strong>[3] <span class=\"exturl\" data-url=\"aHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvTmV3bGluZQ==\">https://en.wikipedia.org/wiki/Newline</span></strong></p>\n<hr />\n<p>å¤§é“äº”åï¼Œå¤©è¡å››åä¹ï¼Œäººéå…¶ä¸€ï¼</p>\n",
            "tags": [
                "blog",
                "blog"
            ]
        },
        {
            "id": "https://to-ywz.github.io/Embedded/STM32/ARM%E6%9E%B6%E6%9E%84/",
            "url": "https://to-ywz.github.io/Embedded/STM32/ARM%E6%9E%B6%E6%9E%84/",
            "title": "ARMæ¶æ„",
            "date_published": "2023-06-16T14:20:07.000Z",
            "content_html": "<h1 id=\"arm-æ¶æ„\"><a class=\"anchor\" href=\"#arm-æ¶æ„\">#</a> ARM æ¶æ„</h1>\n<p>éšç€å¯¹ STM çš„é€æ­¥äº†è§£ï¼Œå°±ä¼šå‘ç°ä¸€äº›ç‰¹åˆ«çš„åœ°æ–¹ï¼Œä¾‹å¦‚ï¼Œä¸ºä»€ä¹ˆ ARM å¯ä»¥åƒè®¿é—®å†…å­˜ä¸€æ ·è®¿é—®å¤–è®¾ï¼Ÿ</p>\n<h2 id=\"ä¸ºä»€ä¹ˆarmå¯ä»¥åƒè®¿é—®å†…å­˜ä¸€æ ·è®¿é—®å¤–è®¾\"><a class=\"anchor\" href=\"#ä¸ºä»€ä¹ˆarmå¯ä»¥åƒè®¿é—®å†…å­˜ä¸€æ ·è®¿é—®å¤–è®¾\">#</a> ä¸ºä»€ä¹ˆ ARM å¯ä»¥åƒè®¿é—®å†…å­˜ä¸€æ ·è®¿é—®å¤–è®¾ï¼Ÿ</h2>\n<p>ä¸è¦è§‰å¾—è¿™æ˜¯ç†æ‰€å½“ç„¶çš„<br />\nåœ¨ x86 ä¸Šé©±åŠ¨ç¨‹åºéœ€è¦æœ‰å¯¹åº”çš„é©±åŠ¨æ–‡ä»¶ï¼Œé©±åŠ¨æ–‡ä»¶éœ€è¦é€šè¿‡åº“å‡½æ•°æˆ–æ˜¯å†…è”æ±‡ç¼–æ‰èƒ½å®ç°<br />\nè™½ç„¶ ST ä¹Ÿéœ€è¦é©±åŠ¨æ–‡ä»¶ï¼Œä½†æ˜¯åº•å±‚çš„å®ç°å°±å¾ˆæœ‰æ„æ€ï¼Œä½† ST ç³»åˆ—çš„å•ç‰‡æœºå¯ä»¥ä½¿ç”¨ C è¯­è¨€åƒè®¿é—®å†…å­˜ä¸€æ ·æ¥è®¿é—®å¤–è®¾</p>\n<p>ä»æ±‡ç¼–çš„å±‚é¢æ¥çœ‹ ARM æ¶æ„ä¸‹çš„å¤„ç†å™¨å¯ä»¥é€šè¿‡ <code>ldr</code>  æ¥æ“ä½œä»»æ„çš„å†…å­˜å’Œå¤–è®¾ï¼Œè€Œ  <code>x86</code>  ä¸åŒ<br />\nä»–æ˜¯é€šè¿‡ <code>IN</code>  æŒ‡ä»¤å’Œ <code>MOV</code>  æŒ‡ä»¤åˆ†åˆ«å®ç°å¯¹å¤–è®¾å’Œå†…å­˜çš„æ“ä½œ</p>\n<p>å…¶å®æœ¬è´¨æ˜¯æ¶æ„ä¸åŒï¼Œå½¢æˆçš„æŒ‡ä»¤é›†ä¸åŒï¼Œå¯¹äº ARM æ¶æ„æ¥è¯´ï¼Œåœ°å€å’Œå†…å­˜ç»Ÿä¸€ç¼–å€ï¼Œè€Œ x86 åˆ™æ˜¯å°†å¤–è®¾åˆ†åˆ«è¿›è¡Œç¼–å€<br />\n CPU ä¾é åœ°å€æ€»çº¿æ¥è®¿é—®å¯¹åº”çš„åœ°å€ï¼Œ32 ä½çš„å•ç‰‡æœºæœ‰ 32 æ ¹åœ°å€çº¿ï¼Œæœ‰ 4G çš„å¯»å€ç©ºé—´ï¼ŒROMã€RAM å’Œå¤–è®¾åˆ†å¸ƒåœ¨ 0~4G çš„å¯»å€ç©ºé—´ä¹‹å†…<br />\n ARM æ¶æ„çš„å†…å­˜åˆ†å¸ƒå¤§è‡´å¦‚ä¸‹å›¾<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.28ed6cywyu68.jpg\" alt=\"image\" /></p>\n<p>åªè¦æ˜¯åœ¨ 0~4G ä¹‹å¤–çš„åœ°å€ï¼ŒCPU æƒ³è¦è®¿é—®å°±ä¼šå’Œ x86 ç±»ä¼¼çš„æ–¹å¼æ¥å®ç°è®¿é—®<br />\nä¾‹å¦‚ï¼Œè¦è®¿é—® EEPROM, é‚£ä¹ˆå¯¹äºå¤„ç†å™¨å•Šæ¥è¯´ï¼Œä¼šæ£€æŸ¥è®¿é—® eeprom çš„é©±åŠ¨ï¼Œç„¶åå†æŒ‰ eeprom çš„å†…éƒ¨åœ°å€</p>\n<h2 id=\"risc-cisc\"><a class=\"anchor\" href=\"#risc-cisc\">#</a> RISC &amp; CISC</h2>\n<p>æ—¢ç„¶è¯´åˆ°äº†æ¶æ„ï¼Œé‚£å°±ä¸å¾—ä¸è¯´ä¸€ä¸‹ ä¸¤ç§æŒ‡ä»¤é›† CISC å’Œ RISC<br />\n ç”±äºä¸ªäººèƒ½åŠ›æœ‰é™ï¼Œæ‰€ä»¥å¯èƒ½ä¼šå‡ºç°é”™è¯¯å’Œçº°æ¼ï¼Œå°±å¤§è‡´ä»‹ç»ä¸€ä¸‹ä¸¤å¤§æŒ‡ä»¤é›†</p>\n<ol>\n<li>CISC<br />\nComplex Instruction Set Computing, å…¶æ‰€ç”¨æŒ‡ä»¤è¾ƒä¸ºå¤æ‚ï¼Œè€Œå¤æ‚çš„æŒ‡ä»¤é‡‡ç”¨ &quot;å¾®ç¨‹åº&quot; å®ç°<br />\n &quot;å¾®ç¨‹åº&quot; ä¸ä»£è¡¨ä¼šé«˜æ•ˆï¼Œè¯¥æ‰§è¡Œçš„æ­¥éª¤ä¸€éƒ¨éƒ½ä¸å°‘ï¼Œ<br />\n ä¾‹å¦‚: call å’Œ ret æŒ‡ä»¤ç”¨äºå®ç°å‡½æ•°è°ƒç”¨å’Œè¿”å›ï¼Œå…¶äº‹å®ä¸Šä¹Ÿæ˜¯åœ¨è°ƒç”¨çš„ä¹‹å‰å°† pc æˆ–æ ‡ç­¾åœ°å€å­˜å…¥ LR å¯„å­˜å™¨ï¼Œç„¶ååœ¨æ‰§è¡Œåˆ° RET è¯­å¥æ—¶è¯»å–å‡ºæ¥<br />\nå°½ç®¡é€»è¾‘ä¸€è‡´</li>\n<li>RISC<br />\nReduced Instruction Set Computing, å…¶æ‰€ç”¨æŒ‡ä»¤è¾ƒä¸ºç®€å•ï¼Œç‰¹ç‚¹å¦‚ä¸‹:</li>\n<li>å¯¹å†…å­˜åªæœ‰è¯»ã€å†™æŒ‡ä»¤</li>\n<li>å¯¹äºæ•°æ®çš„è¿ç®—æ˜¯åœ¨ CPU å†…éƒ¨å®ç°</li>\n<li>ä½¿ç”¨ RISC æŒ‡ä»¤çš„ CPU å¤æ‚åº¦å°ä¸€ç‚¹ï¼Œï¼Œæ˜“äºè®¾è®¡</li>\n</ol>\n<h3 id=\"åŒºåˆ«\"><a class=\"anchor\" href=\"#åŒºåˆ«\">#</a> åŒºåˆ«</h3>\n<ol>\n<li>CISC çš„æŒ‡ä»¤èƒ½åŠ›å¼ºï¼Œä½†å¤šæ•°æŒ‡ä»¤ä½¿ç”¨ç‡ä½å´å¢åŠ äº† CPU çš„å¤æ‚åº¦ï¼ŒæŒ‡ä»¤æ˜¯å¯å˜é•¿æ ¼å¼</li>\n<li>RISC çš„æŒ‡ä»¤å¤§éƒ¨åˆ†ä¸ºå•å‘¨æœŸæŒ‡ä»¤ï¼ŒæŒ‡ä»¤é•¿åº¦å›ºå®šï¼Œæ“ä½œå¯„å­˜å™¨ï¼Œå¯¹äºå†…å­˜åªæœ‰ Load/Store æ“ä½œ</li>\n<li>CISC æ”¯æŒå¤šç§å¯»å€æ–¹å¼ï¼›RISC æ”¯æŒçš„å¯»å€æ–¹å¼</li>\n<li>CISC é€šè¿‡å¾®ç¨‹åºæ§åˆ¶æŠ€æœ¯å®ç°ï¼›</li>\n<li>RISC å¢åŠ äº†é€šç”¨å¯„å­˜å™¨ï¼Œç¡¬å¸ƒçº¿é€»è¾‘æ§åˆ¶ä¸ºä¸»ï¼Œé‡‡ç”¨æµæ°´çº¿</li>\n<li>CISC çš„ç ”åˆ¶å‘¨æœŸé•¿</li>\n<li>RISC ä¼˜åŒ–ç¼–è¯‘ï¼Œæœ‰æ•ˆæ”¯æŒé«˜çº§è¯­è¨€</li>\n</ol>\n<h2 id=\"armçš„cpuå†…éƒ¨å¯„å­˜å™¨\"><a class=\"anchor\" href=\"#armçš„cpuå†…éƒ¨å¯„å­˜å™¨\">#</a> ARM çš„ CPU å†…éƒ¨å¯„å­˜å™¨</h2>\n<p>è§£å†³äº†ä¸€ä¸ªé—®é¢˜ï¼Œåˆå‡ºç°äº†æ–°çš„é—®é¢˜ï½ï½(æˆ‘é‚£è¯¥æ­»çš„æ¢ç´¢æ¬²å•Š)~~<br />\nARM æ¶æ„çš„ CPU çš„å†…éƒ¨å¯„å­˜å™¨æœ‰å“ªäº›ï¼Œå…·ä½“ä»£è¡¨ä»€ä¹ˆä½œç”¨</p>\n<p>ARM å†…éƒ¨æœ‰ 17 ä¸ªå¯„å­˜å™¨ï¼ŒR0~R15 å’Œä¸€ä¸ª PSR å¯„å­˜å™¨ï¼Œå¤§è‡´å¦‚ä¸‹å›¾<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.dtnj6p5voaw.jpg\" alt=\"image\" /><br />\n å…¶ä¸­ R0~R12 æ˜¯é€šç”¨å¯„å­˜å™¨<br />\n R13 æ˜¯ SP å¯„å­˜å™¨ï¼ŒSP å¯„å­˜å™¨åˆåˆ†ä¸º <code>sp_process</code>  å’Œ <code>sp_main</code> , åˆ†åˆ«ç”¨äº <code>main</code>  çš„ä¸»æ ˆå’Œå­å‡½æ•°çš„ <code>sp_process</code>  è¿‡ç¨‹æ ˆï¼Œå¯åŠ¨æ–‡ä»¶ä¸­è®¾ç½®çš„ <code>sp</code>  å°±æ˜¯è¿™ä¸ªæ–‡ä»¶<br />\nè¿™é‡Œçš„ä¸¤ä¸ªå¯„å­˜å™¨åœ¨ keil æ˜¯å¯è§çš„<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.31psuz72bc00.jpg\" alt=\"image\" /><br />\nR14 æ˜¯ LR å¯„å­˜å™¨ï¼Œç”¨æ¥ä¿å­˜è¿”å›åœ°å€ï¼Œå‡½æ•°è°ƒç”¨ï¼Œä¾‹å¦‚ï¼Œåœ¨ä½¿ç”¨ BL ä¹‹å‰éœ€è¦å°†åœ°å€å­˜å…¥åˆ° LR ä¸­<br />\n R15 æ˜¯ PC å¯„å­˜å™¨ï¼Œç¨‹åºå¯„å­˜å™¨ï¼Œè¡¨ç¤ºå½“å‰æ‰§è¡ŒæŒ‡ä»¤çš„ä¸‹ä¸€æ¡æŒ‡ä»¤ã€‚ä¾‹å¦‚ï¼Œå½“å‰æ‰§è¡Œåˆ° 0x12 åœ°å€ä¸Šçš„  <code>mov R0, #8</code> , é‚£ä¹ˆ PC çš„å€¼åˆ™ä¸º 0x1A<br />\nPSR å¯„å­˜å™¨çš„æƒ…å†µåˆæœ‰äº›ä¸åŒï¼Œè¦åˆ†ä¸º cortex-M3/M4 å†…æ ¸å’Œ A7 æ ¸</p>\n<h3 id=\"mæ ¸\"><a class=\"anchor\" href=\"#mæ ¸\">#</a> M æ ¸</h3>\n<p>PSR å®é™…ä¸Šæ˜¯ xPSR<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.3jtxfp5tvs20.jpg\" alt=\"image\" /><br />\nxPSR ç­‰ä»·äºä¸‰ä¸ªå¯„å­˜å™¨</p>\n<ul>\n<li>IPSR: ä¸­æ–­ PSR</li>\n<li>EPSR: æ‰§è¡Œ PSR</li>\n<li>APSR: åº”ç”¨ PSR</li>\n</ul>\n<p>è¿™ä¸‰ä¸ªå¯„å­˜å™¨å¯ä»¥ä¸€èµ·è®¿é—®ä¹Ÿå¯ä»¥åˆ†å¼€è®¿é—®</p>\n<pre><code class=\"language-ASM\">MRS R0, APSR  ; è¯»å–APSR\nMSR APSR, R0  ; å†™å…¥APSR\nMRS R0, PSR   ;å†™å…¥ç»„åˆç¨‹åºçŠ¶æ€\nMSR PSR, R0   ;å†™ç»„åˆç¨‹åºçŠ¶æ€\n</code></pre>\n<h4 id=\"xpsrå„ä¸ªå¯„å­˜å™¨æ§åˆ¶çš„ä½\"><a class=\"anchor\" href=\"#xpsrå„ä¸ªå¯„å­˜å™¨æ§åˆ¶çš„ä½\">#</a> xPSR å„ä¸ªå¯„å­˜å™¨æ§åˆ¶çš„ä½</h4>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.4n144w85e3o0.jpg\" alt=\"image\" /><br />\n å…¶åœ¨ keil ä¸­è§†å›¾å¦‚ä¸‹<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.2z4k0x924600.jpg\" alt=\"image\" /></p>\n<p>APSR å„ä¸ªä½çš„å«ä¹‰<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.63sl0usm6y80.jpg\" alt=\"image\" /><br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.4zx9vd9o3c40.jpg\" alt=\"image\" /><br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.5380s8s84qc0.jpg\" alt=\"image\" /></p>\n<h3 id=\"aæ ¸\"><a class=\"anchor\" href=\"#aæ ¸\">#</a> A æ ¸</h3>\n<p>PSR å®é™…ä¸Šæ˜¯ CPSR,Current Program Status Register<br />\nA7 å……åˆ†çš„åˆ©ç”¨äº†æ¯ä¸€ä½ï¼Œæ¯ä¸€ä½çš„ bit éƒ½æœ‰è‡ªå·±çš„å«ä¹‰<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.3ak1ce85wgu0.jpg\" alt=\"image\" /><br />\nA7 å†…éƒ¨è¿˜æœ‰æ›´å¤šå¯„å­˜å™¨ç±»å‹ï¼Œä¾‹å¦‚ FIQã€IRQã€ABT ä¹‹ç±»çš„ï¼Œ æ›´å¤šçš„å¯ä»¥å‚è€ƒ<span class=\"exturl\" data-url=\"aHR0cHM6Ly9kZXZlbG9wZXIuYXJtLmNvbS9kb2N1bWVudGF0aW9uL2RkaTA0MDYvbGF0ZXN0Lw==\">å®˜æ–¹æ–‡æ¡£</span> B1-1145<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.36pautl6uz80.jpg\" alt=\"image\" /></p>\n<h3 id=\"ä¸€äº›æƒ³æ³•\"><a class=\"anchor\" href=\"#ä¸€äº›æƒ³æ³•\">#</a> ä¸€äº›æƒ³æ³•</h3>\n<p>CPU çš„å†…éƒ¨çš„å¯„å­˜å™¨åªæœ‰è¿™äº›ï¼Œè€Œåƒ IIC, GPIO ç­‰ä¸€ç³»åˆ—çš„å¤–è®¾å±äºå¤–è®¾çš„å¯„å­˜å™¨ï¼Œä»…ä»…æ˜¯å› ä¸ºä»–ä»¬åœ¨ CPU çš„å¯»å€èŒƒå›´å†…ï¼Œæ‰€ä»¥å¯ä»¥å®ç°åƒå†…å­˜ä¸€æ ·çš„æ§åˆ¶</p>\n<p>å…¶å®åªæœ‰æ±‡ç¼–å±‚é¢ä¸Šçš„å¯„å­˜å™¨æ‰å’Œ CPU ç›¸å…³ï¼ŒC è¯­è¨€å±‚é¢çš„å¯„å­˜å™¨æ›´å¤šçš„æ˜¯ä¸€ä¸ªå†…å­˜åœ°å€ï¼Œè½¬åŒ–åˆ°æ±‡ç¼–å°±æ˜¯å°†åœ°å€å­˜å…¥åäºŒä¸ªå¯„å­˜å™¨ä¹‹åè¿›è¡Œæ“ä½œè€Œå·²</p>\n<h2 id=\"armçš„æ±‡ç¼–åˆ°åº•æ˜¯å•¥\"><a class=\"anchor\" href=\"#armçš„æ±‡ç¼–åˆ°åº•æ˜¯å•¥\">#</a> ARM çš„æ±‡ç¼–åˆ°åº•æ˜¯å•¥</h2>\n<p>è¯´èµ·è¿™ä¸ªé—®é¢˜ï¼Œæ±‡ç¼–çš„åå­—æ˜¯  <code>ASM</code> , ä½†æ˜¯å¾ˆæœ‰æ„æ€ï¼Œä¼šå‘ç°  <code>ATT</code>  å’Œ  <code>Intel</code>  çš„æ±‡ç¼–éƒ½æ˜¯ ASM, ä½†æ˜¯å·®è·è¿˜æ˜¯å¾ˆå¤§çš„<br />\nå‰é¢ä¹Ÿè¯´äº†ï¼ŒRISC å’Œ CISC çš„æŒ‡ä»¤é›†ä¸ä¸€æ ·ï¼Œè€Œä¸” ARM å®˜æ–¹ç»™å‡ºäº†æ¨å‡ºäº†å‡ æ¬¡æŒ‡ä»¤é›†ï¼ŒARMã€Thumbã€Thumb2ï¼Œ ä»¥åŠ UAL.</p>\n<p>æœ€å¼€å§‹çš„æ—¶å€™ ARM å…¬å¸åªæ¨å‡ºäº† Thumb å’Œ ARM ä¸¤ç§æ±‡ç¼–è¯­è¨€ï¼Œä¸¤ç§æŒ‡ä»¤éƒ½å¯ä»¥åœ¨ MCU ä¸­æ‰§è¡Œï¼Œä¾‹å¦‚ STM32F103 ç³»åˆ—<br />\n Thumb æ˜¯ 16 ä½çš„æŒ‡ä»¤é›†åˆï¼ŒèŠ‚çœç©ºé—´ï¼›è€Œ ARM æ˜¯ 32 ä½çš„æŒ‡ä»¤é›†åˆï¼Œé«˜æ•ˆä½†æµªè´¹ç©ºé—´</p>\n<h3 id=\"å¦‚ä½•åŒºåˆ«ä¸¤ç§æŒ‡ä»¤é›†\"><a class=\"anchor\" href=\"#å¦‚ä½•åŒºåˆ«ä¸¤ç§æŒ‡ä»¤é›†\">#</a> å¦‚ä½•åŒºåˆ«ä¸¤ç§æŒ‡ä»¤é›†</h3>\n<p>ARM å…¬å¸ç»™å‡ºäº†ä¸¤ä¸ªä¸¤ä¸ªå…³é”®å­— <code>CODE16</code>  å’Œ  <code>CODE32</code> <br />\n å½“ç”¨ CODE16, è¡¨ç¤ºä¸‹é¢çš„ä»£ç å·¥ä½œäº Thumb æŒ‡ä»¤é›†<br />\nç”¨ CODE32, è¡¨ç¤ºä¸‹é¢çš„ä»£ç å·¥ä½œäº ARM æŒ‡ä»¤é›†</p>\n<p>æŒ‡ä»¤é›†ä¼šå½±å“åˆ° CPU çš„å–æŒ‡è¯‘ç ä¸€è¿ä¸²çš„æ“ä½œï¼Œæ‰€ä»¥ CPU ä¹Ÿå¿…é¡»å®æ—¶çš„çŸ¥é“<br />\næ‰€ä»¥åœ¨ PSR å¯„å­˜å™¨ä¸­è®¾æœ‰ä¸€ä¸ª T æ ‡å¿—ä½ï¼Œç”¨äºåŒºåˆ†å½“å‰å¤„äºå“ªä¸€ä¸ªæŒ‡ä»¤é›†<br />\nä¸º 0 çš„æ—¶å€™æ˜¯ ARM æŒ‡ä»¤é›†ï¼Œä¸º 1 æ—¶æ—¶ Thumb æŒ‡ä»¤é›†</p>\n<h3 id=\"cpuå¦‚ä½•è°ƒç”¨å‡½æ•°\"><a class=\"anchor\" href=\"#cpuå¦‚ä½•è°ƒç”¨å‡½æ•°\">#</a> CPU å¦‚ä½•è°ƒç”¨å‡½æ•°</h3>\n<p>è¯•æƒ³ä¸€ä¸ªé—®é¢˜ï¼Œå‡½æ•° A ä½¿ç”¨ Thumb æŒ‡ä»¤å†™çš„ï¼Œå‡½æ•° B æ˜¯ä½¿ç”¨ ARM æŒ‡ä»¤é›†ç¼–å†™ï¼Œå¦‚ä½•è°ƒç”¨ A/B</p>\n<p>äº‹å®ä¸Šï¼Œå¯ä»¥ç›´æ¥å°† A/B çš„åœ°å€å†™å…¥ PC å¯„å­˜å™¨ï¼Œæ¥å®ç°è¿™ä¸ªåŠŸèƒ½</p>\n<p>ä½†æ˜¯å†ç»†æƒ³ä¸€ä¸‹ï¼Œå¦‚ä½•è®© CPU è¿è¡Œå† Thumb æ¨¡å¼ä¸‹è¿è¡Œ A, è€Œå†è¿è¡Œ B çš„æ—¶å€™å¤„äº ARM æ¨¡å¼<br />\nåšä¸ªæ‰‹è„š:<br />\n è°ƒç”¨å‡½æ•° A æ—¶ï¼Œè®© PC å¯„å­˜å™¨çš„ BITO ç­‰äº 1ï¼Œå³: PC = å‡½æ•° A åœ°å€ +(1&lt;&lt;0);<br />\n è°ƒç”¨å‡½æ•° B æ—¶ï¼Œè®© PC å¯„å­˜å™¨çš„ BITO ç­‰äº 0:ï¼Œå³ï¼šPC = å‡½æ•° B åœ°å€</p>\n<p>å†è¿›ä¸€æ­¥ï¼Œå¦‚ä½•å†æ‰§è¡Œ A æ—¶è°ƒç”¨ ARM æŒ‡ä»¤çš„å‡½æ•° B, åœ¨æ‰§è¡Œå®Œæ¯•åå›åˆ° Thumb æŒ‡ä»¤å‡½æ•° A</p>\n<pre><code class=\"language-asm\">Bx B_Addr\nBx A_Addr +1(+1ä¹‹åä¼šä½¿èƒ½Bit0ä½)\n</code></pre>\n<p>ä½†æ˜¯è¿™æ ·å­è¿˜æ˜¯å­˜åœ¨é—®é¢˜ã€‚ä¾‹å¦‚ï¼ŒåŒä¸€ä¸ªç¨‹åºä¸­ï¼Œæœ‰äº›åœ°æ–¹éœ€è¦é«˜æ•ˆçš„ ARM æŒ‡ä»¤é›†ï¼Œè€Œæœ‰äº›åˆ™éœ€è¦ Thumb ä½ç©ºé—´<br />\nä¸ºäº†è§£å†³è¿™éº»çƒ¦çš„é—®é¢˜ï¼ŒARM å…¬å¸æ¨å‡ºäº† Thumb2 æŒ‡ä»¤é›†ï¼Œæ”¯æŒ CODE16 å’Œ CODE32 æ··åˆç¼–ç¨‹</p>\n<p>ARM, Thumb, Thumb2, æ¯ä¸€ç§æ±‡ç¼–éƒ½æœ‰è‡ªå·±çš„è¯­è¨€é£æ ¼ï¼Œå°½ç®¡ç›¸ä¼¼ï¼Œä½†æ˜¯ä¼šæœ‰ä¸åŒçš„ç‰¹æ€§ï¼Œè¿™æ ·å­å°±å¢åŠ äº†ç¨‹åºå‘˜çš„å­¦ä¹ æˆæœ¬<br />\nå› æ­¤ ARM å…¬å¸å°±æ¨å‡ºäº†ç»Ÿä¸€çš„æ±‡ç¼–è¯­è¨€ UAL, UAL æ”¯æŒ CODE32,CODE16,Thumb ä¸‰ç§é£æ ¼çš„è¯­è¨€ï¼Œè¿™æ · ARM çš„æ±‡ç¼–è¯­è¨€çš„å‘å±•å°±ç®—æ˜¯åŸºæœ¬æˆå‹äº†</p>\n<h2 id=\"åŸºæœ¬çš„ualæ±‡ç¼–è¯­æ³•\"><a class=\"anchor\" href=\"#åŸºæœ¬çš„ualæ±‡ç¼–è¯­æ³•\">#</a> åŸºæœ¬çš„ UAL æ±‡ç¼–è¯­æ³•</h2>\n<p>æ±‡ç¼–è¯­è¨€æœ¬èº«å¤§å·®ä¸å·®ï¼Œå¤§è‡´ä¼šåˆ†ä¸ºï¼Œå†…å­˜æ“ä½œæŒ‡ä»¤ï¼Œè¾“å‡ºå¤„ç†æŒ‡ä»¤ ä»¥åŠ è½¬è·³æŒ‡ä»¤ä¸‰å¤§ç±»</p>\n<h3 id=\"å†…å­˜æ“ä½œæŒ‡ä»¤\"><a class=\"anchor\" href=\"#å†…å­˜æ“ä½œæŒ‡ä»¤\">#</a> å†…å­˜æ“ä½œæŒ‡ä»¤</h3>\n<h4 id=\"å•å¯„å­˜å™¨æ“ä½œ\"><a class=\"anchor\" href=\"#å•å¯„å­˜å™¨æ“ä½œ\">#</a> å•å¯„å­˜å™¨æ“ä½œ</h4>\n<p>å†…å­˜æ“ä½œæŒ‡ä»¤å¤§è‡´åˆ†ä¸ºä¸¤å¤§ç±»ï¼šæ¶‰åŠå†…å­˜è¯»å–å’Œä¸æ¶‰åŠå†…å­˜è¯»å–</p>\n<p>æ‰€è°“çš„æ¶‰ä¸æ¶‰åŠå†…å­˜ï¼Œå…¶å®å°±æ˜¯åªæ¶‰åŠç«‹å³æ•°å’Œå¯„å­˜å™¨çš„æ“ä½œï¼Œå¯ä»¥æ˜¯å¯„å­˜å™¨åˆ°å¯„å­˜å™¨ï¼Œä¹Ÿå¯ä»¥æ˜¯ç«‹å³æ•°åˆ°å¯„å­˜å™¨<br />\nä¸è¿‡æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼Œç«‹å³æ•°æ˜¯æœ‰ä¸€å®šé™åˆ¶çš„.<br />\n ç«‹å³æ•°å¿…é¡»æ»¡è¶³ï¼Œå¯ä»¥é€šè¿‡å¯¹ä¸€ä¸ª 8 ä½æ•°å­—è¿›è¡Œå‘å³æ—‹è½¬çš„æ“ä½œå¾—åˆ°ä¸€ä¸ªåœ¨ 32 ä½å­—ä¸­å¯ä»¥ç”¨ä½œç«‹å³æ•°çš„å€¼<br />\nä¾‹å¦‚ï¼Œ <code>mov r0, #10</code>  æ˜¯å¯ä»¥çš„ä½†æ˜¯ <code>mov r0, #10086</code>  å°±ä¸è¡Œ</p>\n<pre><code class=\"language-ASM\">MOV\t\tR0, #0x20000\nMOV\t\tR1, #0x10\nMOV\t\tR2, #0x12\n</code></pre>\n<p>æ¶‰åŠå†…å­˜çš„æ“ä½œï¼Œä¹Ÿéœ€è¦ç»è¿‡å¯„å­˜å™¨ï¼Œé€šè¿‡ <code>STR</code>  å’Œ <code>LDR</code>  æ¥å®ç°è¿™ä¸ªåŠŸèƒ½<br />\nä¾‹å¦‚ï¼Œè¯»å– 0x20000 çš„æ•°æ®åˆ° R1 ä¸­ï¼Œè¯»å– 0x40000 ä¸­çš„æ•°æ®åˆ° R3 ä¸­</p>\n<pre><code class=\"language-ASM\">mov r0, #0x20000  ; 0x20000 åœ°å€æ”¾å…¥r0\nstr r0, [r2]        ; å°†æ•°æ®æ”¾å…¥r1çš„åœ°å€\nmov r0, #0x40000  ; å°†åœ°å€å†™å…¥r0\nldr r3, [r0]        ; å°†åœ°å€ä¸­çš„æ•°æ®è¯»å…¥r3\n</code></pre>\n<p>é™¤äº†è¿™äº›åŸºæœ¬çš„æ“ä½œï¼Œè¿˜æœ‰ä¸€äº›æ›´å¤æ‚çš„æ“ä½œ</p>\n<pre><code class=\"language-ASM\">STR\t\tR2, [R0]              ; R2çš„å€¼å­˜åˆ°R0æ‰€ç¤ºåœ°å€\nSTR\t\tR2, [R0, #4]          ; R2çš„å€¼å­˜åˆ°R0+4æ‰€ç¤ºåœ°å€\nSTR\t\tR2, [R0, #8]!         ; R2çš„å€¼å­˜åˆ°R0+8æ‰€ç¤ºåœ°å€, R0=R0+8\nSTR\t\tR2, [R0, R1]          ; R2çš„å€¼å­˜åˆ°R0+R1æ‰€ç¤ºåœ°å€\nSTR\t\tR2, [R0, R1, LSL #4]  ; R2çš„å€¼å­˜åˆ°R0+(R1&lt;&lt;4)æ‰€ç¤ºåœ°å€\nSTR\t\tR2, [R0], #0X20       ; R2çš„å€¼å­˜åˆ°R0æ‰€ç¤ºåœ°å€, R0=R0+0x20\nMOV\t\tR2, #0x34\nSTR\t\tR2, [R0]              ; R2çš„å€¼å­˜åˆ°R0æ‰€ç¤ºåœ°å€\nLDR\t\tR3, [R0], +R1, LSL #1 ; R3çš„å€¼ç­‰äºR0+(R1&lt;&lt;1)æ‰€ç¤ºåœ°å€ä¸Šçš„å€¼\n</code></pre>\n<h4 id=\"å¤šå¯„å­˜å™¨æ“ä½œ\"><a class=\"anchor\" href=\"#å¤šå¯„å­˜å™¨æ“ä½œ\">#</a> å¤šå¯„å­˜å™¨æ“ä½œ</h4>\n<p>å½“ç„¶é™¤äº†è¯»å–å•ä¸ªå¯„å­˜å™¨è¿˜å¯ä»¥å®ç°è¯»ä¸ªå¯„å­˜å™¨çš„è¯»å–<br />\nåŸºæœ¬è¯­æ³•å¦‚ä¸‹<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.bbr7un23kmw.jpg\" alt=\"image\" /></p>\n<p>å¯¹äºå¤šå¯„å­˜å™¨çš„æ“ä½œæ¥è¯´ï¼Œä¼šæœ‰ LDM å’Œ STM æŒ‡ä»¤çš„ RegList åˆ—è¡¨å¯„å­˜å™¨å­˜å‚¨å¦‚ä½•å¯¹åº”çš„é—®é¢˜<br />\nå°±è®°ä½ä¸€å¥è¯ï¼šä½æ ‡å· Reg å¯¹åº”ä½åœ°å€å‡æ³•ä¹Ÿå¦‚æ­¤<br />\nä¸‹é¢æ˜¯ä¸€äº› <code>STMA</code>  æ“ä½œï¼ŒLDM ä¹Ÿç±»ä¼¼<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.6rhvfh8cv1o0.jpg\" alt=\"image\" /></p>\n<h4 id=\"å®ç°æ ˆæ“ä½œ\"><a class=\"anchor\" href=\"#å®ç°æ ˆæ“ä½œ\">#</a> å®ç°æ ˆæ“ä½œ</h4>\n<p>åˆ°è¿™é‡Œï¼Œå°±ä¼šå‘ç°ï¼Œè¿™ä¸ªæ“ä½œéå¸¸çš„åƒæ ˆï¼Œè¿™é‡Œæ¥æ¨¡æ‹Ÿä¸€ä¸‹è¿›å‡ºæ ˆçš„æ“ä½œ</p>\n<p>è¿™é‡Œä½¿ç”¨æ»¡å‡æ ˆ:</p>\n<ol>\n<li>å‹æ ˆï¼Œå…ˆå‡åå­˜ï¼ŒSTMFD</li>\n<li>å‡ºæ ˆï¼Œå…ˆå‡ºåå‡ï¼ŒLDMFD</li>\n</ol>\n<p>å‰é¢è¯´è¿‡æ ˆæŒ‡é’ˆæ˜¯ SP, å’±ä»¬å°† R1~R3 çš„æ•°å€¼å­˜å…¥å‹å…¥æ ˆä¸­ï¼Œç„¶åï¼Œæ›´æ”¹ R1~R3 çš„å€¼ä¹‹åå­˜ï¼Œå†å‡ºæ ˆï¼Œå¦‚æœæ•°æ®è¿˜åŸåˆ™è¡¨ç¤ºå…¥æ ˆæˆåŠŸ</p>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.34cfbkaaw6w0.jpg\" alt=\"image\" /><br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.2bgcm06wvesk.jpg\" alt=\"image\" /></p>\n<h3 id=\"æ•°æ®å¤„ç†æŒ‡ä»¤\"><a class=\"anchor\" href=\"#æ•°æ®å¤„ç†æŒ‡ä»¤\">#</a> æ•°æ®å¤„ç†æŒ‡ä»¤</h3>\n<p>ç›¸è¾ƒäº è¯»å–æŒ‡ä»¤ï¼Œæ•°æ®æ“ä½œçš„æŒ‡ä»¤å°±æ›´åŠ å¤šäº†ï¼ŒåŠ å‡ä¹˜é™¤ï¼Œç§»ä½ï¼Œæ¸…é›¶ç­‰ç­‰<br />\nè¿™é‡Œåªä»‹ç»åŠ å‡å’Œä¸ºä½æ“ä½œä»¥åŠç®€å•çš„æ¯”è¾ƒæŒ‡ä»¤</p>\n<h4 id=\"åŠ æ³•æŒ‡ä»¤add\"><a class=\"anchor\" href=\"#åŠ æ³•æŒ‡ä»¤add\">#</a> åŠ æ³•æŒ‡ä»¤ï¼šADD</h4>\n<p>è¯­æ³•:  <code>add ç›®çš„å¯„å­˜å™¨, åŠ æ•°1, åŠ æ•°2</code></p>\n<pre><code class=\"language-ASM\">\t\tmov\t\tr0, #1\n\t\tmov\t\tr1, #2\n\t\tadd\t\tr1, r1, r0\n</code></pre>\n<h4 id=\"å‡æ³•æŒ‡ä»¤sub\"><a class=\"anchor\" href=\"#å‡æ³•æŒ‡ä»¤sub\">#</a> å‡æ³•æŒ‡ä»¤ï¼šSUB</h4>\n<p>è¯­æ³•:  <code>sub ç›®çš„å¯„å­˜å™¨, è¢«å‡æ•°æ•°1, å‡æ•°2</code></p>\n<pre><code class=\"language-ASM\">\t\tmov\t\tr0, #2\n\t\tmov\t\tr1, #1\n\t\tsub\t\tr1, r1, r0\n</code></pre>\n<h4 id=\"ä½æ“ä½œ\"><a class=\"anchor\" href=\"#ä½æ“ä½œ\">#</a> ä½æ“ä½œ</h4>\n<h5 id=\"and\"><a class=\"anchor\" href=\"#and\">#</a> AND</h5>\n<p>è¯­æ³•:  <code>and ç›®çš„å¯„å­˜å™¨, æ•°å€¼1, æ•°å€¼2</code></p>\n<pre><code class=\"language-ASM\">\t\tmov\t\tr0, #2\n\t\tmov\t\tr1, #1\n\t\tand\t\tr1, r1, r0 ; r1å˜æˆ0\n</code></pre>\n<h5 id=\"bic\"><a class=\"anchor\" href=\"#bic\">#</a> BIC</h5>\n<p>è¯­æ³•:  <code>bic ç›®çš„å¯„å­˜å™¨, æ•°å€¼1, æ•°å€¼2</code></p>\n<pre><code class=\"language-ASM\">\t\tmov\t\tr0, #1\n\t\tmov\t\tr1, #3\n\t\tbic\t\tr1, r1, r0 ; r1 å˜æˆ2\n</code></pre>\n<h5 id=\"orr\"><a class=\"anchor\" href=\"#orr\">#</a> ORR</h5>\n<p>è¯­æ³•:  <code>orr ç›®çš„å¯„å­˜å™¨, æ•°å€¼1, æ•°å€¼2</code></p>\n<pre><code class=\"language-ASM\">\t\tmov\t\tr0, #1\n\t\tmov\t\tr1, #2\n\t\torr\t\tr1, r1, r0 ;r1å˜æˆ3\n</code></pre>\n<h4 id=\"æ¯”è¾ƒ\"><a class=\"anchor\" href=\"#æ¯”è¾ƒ\">#</a> æ¯”è¾ƒ</h4>\n<h5 id=\"æ¯”è¾ƒæŒ‡ä»¤-cmp\"><a class=\"anchor\" href=\"#æ¯”è¾ƒæŒ‡ä»¤-cmp\">#</a> æ¯”è¾ƒæŒ‡ä»¤ CMP</h5>\n<p>è¯­æ³•:  <code>cmp r1, r2</code> <br />\ncmp æŒ‡ä»¤æ‰§è¡Œåä¼šå½±å“ psr çš„ C ä½ï¼Œæ ¹æ®æ¯”è¾ƒç»“æœå®ç°ç½®ä½å’Œ<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.5sumnuksm000.jpg\" alt=\"image\" /></p>\n<h5 id=\"æµ‹è¯•tst\"><a class=\"anchor\" href=\"#æµ‹è¯•tst\">#</a> æµ‹è¯• TST</h5>\n<p>ä¸ä¿®æ”¹æ•°æ®ç»“æœæ¥è¿›è¡Œ <code>and</code>  æ“ä½œï¼Œæ¥æµ‹è¯•æ•°æ®</p>\n<p>è¯­æ³•:  <code>tst å¯„å­˜å™¨1, å¯„å­˜å™¨</code></p>\n<pre><code class=\"language-ASM\">\t\tmov\t\tr0, #1\n\t\tmov\t\tr1, #2\n\t\ttst\t\tr1, r0\n</code></pre>\n<h3 id=\"è½¬è·³æŒ‡ä»¤\"><a class=\"anchor\" href=\"#è½¬è·³æŒ‡ä»¤\">#</a> è½¬è·³æŒ‡ä»¤</h3>\n<p>è½¬è·³æŒ‡ä»¤å…¶å®ä¸æ­¢è¿™ä¸¤ä¸ªï¼Œä½†æ˜¯è¿™ä¸¤ä¸ªæ˜¯å‡½æ•°è°ƒç”¨çš„æ¥å£</p>\n<p>B: Branch è½¬è·³<br />\n BL:Branch with Link, è½¬è·³å‰å°†è¿”å›åœ°å€å­˜å…¥ LR<br />\nBX: Branch and exechange, æ ¹æ®è½¬è·³åœ°å€çš„ BIT0, è‡ªåŠ¨åˆ‡æ¢ ARM æŒ‡ä»¤é›†å’Œ Thumb æŒ‡ä»¤é›†<br />\n BXL: åŒä¸Šï¼Œä½†æ˜¯è½¬è·³å‰ä¿å­˜è¿”å›åœ°å€</p>\n<p>è¯­æ³•å¦‚å›¾<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.4bzwss3uvj80.jpg\" alt=\"image\" /></p>\n<p>ç”±äºæ¨¡æ‹Ÿå™¨ä¸èƒ½æ¨¡æ‹Ÿ BX ç³»åˆ—æŒ‡ä»¤ï¼Œè¿™é‡Œåªæœ‰ B æŒ‡ä»¤çš„ä¾‹å­</p>\n<pre><code class=\"language-ASM\">\t\tmov\t\tr0, #10\n\t\tBL\t\tDelay\n\t\t\n\t\tmov\t\tr2, #0x1\n\t\t\n\t\t\nDelay\n\t\tSUBS\tr0, r0, #1\t;ç­‰ä»·äºä¸‹é¢ä¸¤å¥è¯\n\t\t;SUB\t\tr0, r0, #1\n\t\t;CMP\t\tr0, #0\n\t\tBNE\t\tDelay\n\t\tmov\t\tPC, LR\t\n\t\t; BL çš„è¿”å›åœ°å€åœ¨LRä¸­, è¦é€šè¿‡movæ¥å®ç°\n\t\t; æ²¡æœ‰ç±»ä¼¼x86çš„ ret æŒ‡ä»¤\n</code></pre>\n<h2 id=\"å°ç»“\"><a class=\"anchor\" href=\"#å°ç»“\">#</a> å°ç»“</h2>\n<p>ç”±äºä¸ªäººçŸ¥è¯†å‚¨å¤‡æœ‰é™ï¼Œæ–‡ç« å¯èƒ½æœ‰äº›è™å¤´è›‡å°¾ï¼ŒåæœŸç­‰æŸ¥é˜…å®Œæ¯•ç›¸å…³çš„æ–‡æ¡£ååœ¨æ›´æ–°å’Œä¿®æ­£<br />\næ–‡ç« å¦‚æœ‰ä¸æ°å½“ä¹‹å¤„ï¼Œæœ›è¯¸ä½å¤§ä½¬æ–§æ­£</p>\n<h2 id=\"å‚è€ƒæ–‡çŒ®\"><a class=\"anchor\" href=\"#å‚è€ƒæ–‡çŒ®\">#</a> å‚è€ƒæ–‡çŒ®</h2>\n<p><strong>[1] <span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuMTAwYXNrLm5ldC9wL3RfcGMvY291cnNlX3BjX2RldGFpbC9jb2x1bW4vcF81Zjg1Njc3YmU0YjA2YWZmMWEwM2NlY2I/Y29udGVudF9hcHBfaWQ9\">https://www.100ask.net/p/t_pc/course_pc_detail/column/p_5f85677be4b06aff1a03cecb?content_app_id=</span></strong><br />\n<strong>[2] STM32MP157 è£¸æœºå¼€å‘å®Œå…¨æ‰‹å†Œ</strong><br />\n<strong> [3] DM00327659</strong><br />\n<strong> [4] ARM Cortex-M3 ä¸ Cortex-M4 æƒå¨æŒ‡å—</strong><br />\n<strong> [5] DDI0406C_d_armv7ar_arm</strong></p>\n<hr />\n<p>å¤§é“äº”åï¼Œå¤©è¡å››åä¹ï¼Œäººéå…¶ä¸€ï¼</p>\n",
            "tags": [
                "åµŒå…¥å¼",
                "ARM",
                "ARM"
            ]
        },
        {
            "id": "https://to-ywz.github.io/computer-science/C/C%E8%AF%AD%E8%A8%80%E6%8B%BE%E9%81%97/",
            "url": "https://to-ywz.github.io/computer-science/C/C%E8%AF%AD%E8%A8%80%E6%8B%BE%E9%81%97/",
            "title": "Cè¯­è¨€æ‹¾é—",
            "date_published": "2023-06-15T22:18:38.000Z",
            "content_html": "<h1 id=\"cè¯­è¨€è¯­æ³•\"><a class=\"anchor\" href=\"#cè¯­è¨€è¯­æ³•\">#</a> C è¯­è¨€è¯­æ³•</h1>\n<h2 id=\"static-ç”¨æ³•\"><a class=\"anchor\" href=\"#static-ç”¨æ³•\">#</a> static ç”¨æ³•</h2>\n<p>é™åˆ¶ä½œç”¨åŸŸï¼Œå­˜å‚¨æ–¹å¼å˜ä¸ºé™æ€å­˜å‚¨</p>\n<ol>\n<li>ä¿®é¥°å…¨å±€å˜é‡ï¼Œé™åˆ¶ä½œç”¨åŸŸã€‚åœ¨é“¾æ¥è¿‡ç¨‹ä¸­ï¼Œå¤šæ–‡ä»¶ä¸­çš„é‡åå˜é‡ä¸ä¼šå†²çª.</li>\n<li>ä¿®é¥°å±€éƒ¨å˜é‡ï¼Œå»¶é•¿ç”Ÿå‘½å‘¨æœŸï¼Œå­˜å‚¨æ–¹å¼å˜ä¸ºé™æ€å­˜å‚¨åªè¿›è¡Œä¸€æ¬¡åˆå§‹åŒ–.</li>\n<li>ä¿®é¥°å‡½æ•°ï¼Œé™åˆ¶å‡½æ•°ä½œç”¨åŸŸï¼Œå±€é™åœ¨æ–‡ä»¶å†…éƒ¨ã€‚åœ¨è¿æ¥è¿‡ç¨‹ä¸­é¿å…å’Œå¤šæ–‡ä»¶ä¸­åŒåå‡½æ•°å†²çª</li>\n</ol>\n<h2 id=\"define-å’Œ-const-çš„åŒºåˆ«\"><a class=\"anchor\" href=\"#define-å’Œ-const-çš„åŒºåˆ«\">#</a>  <code>#define</code>  å’Œ  <code>const</code>  çš„åŒºåˆ«</h2>\n<ol>\n<li><code>const</code>  å®šä¹‰çš„å¸¸é‡åœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­åªæœ‰ä¸€ä»½æ‹·è´ (å› ä¸ºå®ƒæ˜¯å…¨å±€çš„åªè¯»å˜é‡ï¼Œå­˜æ”¾åœ¨é™æ€åŒº), è€Œ  <code>#define</code>  å®šä¹‰çš„å®å¸¸é‡åœ¨å†…å­˜ä¸­æœ‰è‹¥å¹²ä¸ªæ‹·è´ (æ²¡æœ‰å­˜ç©ºé—´)</li>\n<li><code>#define</code>  å®æ˜¯åœ¨é¢„ç¼–è¯‘é˜¶æ®µè¿›è¡Œæ›¿æ¢ï¼Œè€Œ  <code>const</code>  ä¿®é¥°çš„åªè¯»å˜é‡æ˜¯åœ¨ç¼–è¯‘çš„æ—¶å€™ç¡®å®šå…¶å€¼</li>\n<li><code>#define</code>  å®æ²¡æœ‰ç±»å‹ï¼Œè€Œ  <code>const</code>  ä¿®é¥°çš„åªè¯»å˜é‡å…·æœ‰ç‰¹å®šçš„ç±»å‹</li>\n<li><code>#define</code>  ä¸èƒ½è¢«è°ƒè¯•ï¼Œ <code>const</code>  å¯ä»¥è¢«è°ƒè¯•</li>\n</ol>\n<h2 id=\"undef-å®\"><a class=\"anchor\" href=\"#undef-å®\">#</a>  <code>#undef</code>  å®</h2>\n<ul>\n<li>ä½œç”¨:  <code>#undef</code>  ç”¨äºå–æ¶ˆå‰é¢çš„å®šä¹‰çš„å®æ ‡è¯†ç¬¦</li>\n<li>å¸¸è§ç”¨æ³•:</li>\n</ul>\n<ol>\n<li>é˜²æ­¢å®å®šä¹‰å†²çª</li>\n</ol>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre> </pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">MAX</span> <span class=\"token expression\"><span class=\"token number\">200</span></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"MAX = %d\\n\"</span><span class=\"token punctuation\">,</span> MAX<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">undef</span> <span class=\"token expression\">MAX</span></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre> </pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">int</span> MAX <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"MAX = %d\\n\"</span><span class=\"token punctuation\">,</span> MAX<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre> </pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><ol start=\"2\">\n<li>ç”¨äºé™åˆ¶å®çš„ä½œç”¨èŒƒå›´</li>\n</ol>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">TEST_A</span> <span class=\"token expression\"><span class=\"token number\">1</span> </span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">TEST_CLASS_A</span> <span class=\"token expression\">clase T1 </span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"TEST.h\"</span> </span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">undef</span> <span class=\"token expression\">TEST_A </span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">undef</span> <span class=\"token expression\">TEST_CLASS_A</span></span></pre></td></tr></table></figure><p>è¿™æ®µä»£ç è¡¨ç¤º  <code>TEST_A 1</code>  å’Œ  <code>TEST_CLASS_A clase T1</code>  åœ¨å‡º  <code>TEST.h</code>  æ–‡ä»¶åæ— æ•ˆ<br />\nå¯ä»¥æœ‰æ•ˆçš„å‡å°‘å®çš„å†²çª</p>\n<h2 id=\"æšä¸¾è½¬å­—ç¬¦\"><a class=\"anchor\" href=\"#æšä¸¾è½¬å­—ç¬¦\">#</a> æšä¸¾è½¬å­—ç¬¦</h2>\n<p>ç›¸å¯¹äº å®å®šä¹‰æ¥è¯´ï¼Œæšä¸¾å˜é‡æ›´ä¸ºåˆ©äºè°ƒè¯•ï¼Œä½†æ˜¯å¤§é‡çš„æšä¸¾å˜é‡ï¼Œå¾ˆéš¾è®©äººè®°ä½ï¼Œå¹¶ä¸”å¯¹äºæšä¸¾å€¼æ¥è¯´ï¼Œä½¿ç”¨  <code>switch case</code>  æ¥å®ç°æ‰“å°å‡ºæšä¸¾å˜é‡ï¼Œå®åœ¨æ˜¯æœ‰äº›è´¹æ—¶è´¹åŠ›.<br />\n ä½œä¸ºä¸€ä¸ªç¨‹åºå‘˜æˆ‘ä»¬è¿½æ±‚çš„å°±æ˜¯é«˜æ•ˆä¸ç®€æ´çš„è‰ºæœ¯ (å°±æ˜¯å·æ‡’), æ‰€ä»¥æˆ‘ä»¬è¦æ‰¾åˆ°ä¸€ç§æ›´é«˜æ•ˆçš„æ–¹æ³•ï¼Œå®ç¼–ç¨‹</p>\n<p>åœ¨è¿™ä¹‹å‰éœ€è¦çŸ¥é“ <strong> <code>#k</code>  ä¼šæŠŠ  <code>k</code>  å˜ä¸ºå­—ç¬¦ä¸²</strong></p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name function\">MACROSTR</span><span class=\"token expression\"><span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">)</span> #k</span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">// å®šä¹‰æšä¸¾æˆå‘˜</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">X_NUMBERS</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token expression\"><span class=\"token function\">X</span><span class=\"token punctuation\">(</span>kZero <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span>   </span><span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token expression\"><span class=\"token function\">X</span><span class=\"token punctuation\">(</span>kOne <span class=\"token operator\">=</span> <span class=\"token number\">20</span><span class=\"token punctuation\">)</span>    </span><span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token expression\"><span class=\"token function\">X</span><span class=\"token punctuation\">(</span>kTwo <span class=\"token operator\">=</span> <span class=\"token number\">30</span><span class=\"token punctuation\">)</span>    </span><span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  <span class=\"token expression\"><span class=\"token function\">X</span><span class=\"token punctuation\">(</span>kThree <span class=\"token operator\">=</span> <span class=\"token number\">40</span><span class=\"token punctuation\">)</span>  </span><span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  <span class=\"token expression\"><span class=\"token function\">X</span><span class=\"token punctuation\">(</span>kFour <span class=\"token operator\">=</span> <span class=\"token number\">50</span><span class=\"token punctuation\">)</span>   </span><span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  <span class=\"token expression\"><span class=\"token function\">X</span><span class=\"token punctuation\">(</span>kMax <span class=\"token operator\">=</span> <span class=\"token number\">60</span><span class=\"token punctuation\">)</span></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\">// å®šä¹‰æšä¸¾ç±»å‹</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">enum</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name function\">X</span><span class=\"token expression\"><span class=\"token punctuation\">(</span>Enum<span class=\"token punctuation\">)</span> Enum<span class=\"token punctuation\">,</span></span></span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>  X_NUMBERS</pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">undef</span> <span class=\"token expression\">X</span></span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token punctuation\">&#125;</span> kConst<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token comment\">// å®šä¹‰æšä¸¾ç±»å‹æ‰€å¯¹åº”çš„å­—ç¬¦ä¸²</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token keyword\">const</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>kConstStr<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name function\">X</span><span class=\"token expression\"><span class=\"token punctuation\">(</span>String<span class=\"token punctuation\">)</span> <span class=\"token function\">MACROSTR</span><span class=\"token punctuation\">(</span>String<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></span></span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    X_NUMBERS</pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">undef</span> <span class=\"token expression\">X</span></span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœå¦‚ä¸‹:</p>\n<pre><code>Hello World!\n\nkZero = 10\nkOne = 20\nkTwo = 30\nkThree = 40\nkFour = 50\nkMax = 60\n\n</code></pre>\n<p>çœ‹ç»“æœåªèƒ½çŸ¥é“ æšä¸¾ç±»å‹è¢«è½¬æˆäº†å­—ç¬¦ï¼Œæ‰€ä»¥éœ€è¦ ä½¿ç”¨  <code>gcc -E -o main.c main.i</code> <br />\n çœ‹ä¸€ä¸‹é¢„ç¼–è¯‘åçš„ç»“æœ<br />\nå¦‚ä¸‹</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre># <span class=\"token number\">1</span> <span class=\"token string\">\"enumToStr.c\"</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre># <span class=\"token number\">1</span> <span class=\"token string\">\"&lt;built-in>\"</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre># <span class=\"token number\">1</span> <span class=\"token string\">\"&lt;command-line>\"</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre># <span class=\"token number\">1</span> <span class=\"token string\">\"enumToStr.c\"</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre># <span class=\"token number\">11</span> <span class=\"token string\">\"enumToStr.c\"</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">enum</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  kZero <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> kOne <span class=\"token operator\">=</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> kTwo <span class=\"token operator\">=</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span> kThree <span class=\"token operator\">=</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span> kFour <span class=\"token operator\">=</span> <span class=\"token number\">50</span><span class=\"token punctuation\">,</span> kMax <span class=\"token operator\">=</span> <span class=\"token number\">60</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">&#125;</span> kConst<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">static</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>kConstStr<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token string\">\"kZero = 10\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"kOne = 20\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"kTwo = 30\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"kThree = 40\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"kFour = 50\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"kMax = 60\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></pre></td></tr></table></figure><p>å¾ˆæ˜æ˜¾çš„çœ‹åˆ° æšä¸¾è¢«è½¬æ¢æˆäº†å­—ç¬¦ä¸²ï¼Œä½†æ˜¯ä»ç„¶å­˜åœ¨ä¸€äº›é—®é¢˜å­—ç¬¦ä¸²æ‰“å°ä¼šå¸¦ä¸Šæ•°å­—ï¼Œæ•°å€¼ä¸ä¸€å®šçš„æšä¸¾ï¼Œæ— æ³•ç›´æ¥ä½œä¸ºç´¢å¼•æ¥æŸ¥æ‰¾å­—ç¬¦ä¸²è¿›è¡Œæ‰“å°</p>\n<h2 id=\"union\"><a class=\"anchor\" href=\"#union\">#</a> union</h2>\n<p>union æœ€å¤§çš„ä½œç”¨æ˜¯ç”¨äºèŠ‚çœç©ºé—´ï¼Œä¾‹å¦‚</p>\n<p>è€Œç°åœ¨é…åˆä¸Šç»“æ„ä½“å’Œ C99 çš„ä½å­—æ®µï¼Œåˆ™å¯ä»¥è¿›ä¸€æ­¥æ”¾å¤§ä¼˜åŠ¿ï¼Œä¾‹å¦‚</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">typedef</span> <span class=\"token keyword\">union</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">struct</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">short</span> net_work <span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>   <span class=\"token comment\">// 1-OneNET æ¥å…¥æˆåŠŸ\t\t0-OneNET æ¥å…¥å¤±è´¥</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">short</span> err_count <span class=\"token operator\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// é”™è¯¯è®¡æ•°</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">short</span> heart_beat <span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// å¿ƒè·³</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">short</span> get_ip <span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>     <span class=\"token comment\">// è·å–åˆ°æœ€ä¼˜ç™»å½• IP</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">short</span> lbs <span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>        <span class=\"token comment\">// 1 - å·²è·å–åˆ°äº†ä½ç½®åæ ‡</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">short</span> lbs_count <span class=\"token operator\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// è·å–è®¡æ•°</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">short</span> connect_ip <span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// è¿æ¥äº† IP</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">short</span> err_check <span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// é”™è¯¯æ£€æµ‹</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">short</span> reverse <span class=\"token operator\">:</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> bit<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">short</span> all<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token punctuation\">&#125;</span> OneNet_Statue_t<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>å‡è®¾æˆ‘ä»¬ ä¸€ä¸ªå˜é‡  <code>OneNet_Statue_t oneNet_SR;</code>  æˆ‘ä»¬å¯ä»¥è¿™æ ·å­å¯¹å˜é‡è¿›è¡Œèµ‹å€¼  <code>oneNet_SR.all=0x0010;</code></p>\n<p>å½“æˆ‘ä»¬è¦æ£€æµ‹å˜é‡çš„æŸä¸€ä¸ªä½çš„æ—¶å€™ï¼Œå°±å¯ä»¥ä½¿ç”¨  <code>network = oneNet_SR.net_work</code>  æ¥è·å–çŠ¶æ€</p>\n<h1 id=\"memmove-å’Œ-memcpy-çš„åŒºåˆ«\"><a class=\"anchor\" href=\"#memmove-å’Œ-memcpy-çš„åŒºåˆ«\">#</a>  <code>memmove</code>  å’Œ  <code>memcpy</code>  çš„åŒºåˆ«</h1>\n<p>é¦–å…ˆ  <code>memcpy</code>  å’Œ  <code>memmove</code>  éƒ½æ˜¯ c è¯­è¨€åº“å‡½æ•°ï¼Œä½äº  <code>string.h</code>  ä¸­çš„å‡½æ•°.<br />\n å…¶å‡½æ•°åŸå‹åˆ†åˆ«ä¸º</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span><span class=\"token function\">memcpy</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>dst<span class=\"token punctuation\">,</span> <span class=\"token keyword\">const</span> <span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>src<span class=\"token punctuation\">,</span> <span class=\"token class-name\">size_t</span> count<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span><span class=\"token function\">memmove</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>dst<span class=\"token punctuation\">,</span> <span class=\"token keyword\">const</span> <span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>src<span class=\"token punctuation\">,</span> <span class=\"token class-name\">size_t</span> count<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>ä½œç”¨éƒ½æ˜¯æ‹·è´ä¸€æ®µå†…å­˜çš„å†…å®¹ï¼Œåˆ°ç›®çš„åœ°å€ã€‚åŒºåˆ«åœ¨äºï¼Œ<strong>åœ¨å†…å­˜é‡å æ—¶ï¼Œ <code>memmove</code>  å¯ä»¥ä¿è¯æ•°æ®çš„æ­£ç¡®å¤åˆ¶ï¼Œè€Œ  <code>memcpy</code>  ä¸å¯ä»¥</strong><br />\næƒ…å†µå¦‚å›¾<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/before2022/memove.png\" alt=\"memmove\" /><br />\n å¯¹äºç¬¬ä¸€ç§æƒ…å†µ  <code>memcpy</code>  å¯ä»¥å®Œç¾è§£å†³ï¼Œä½†æ˜¯å¯¹äºåé¢è¿™ä¸¤ç§  <code>memcpy</code>  å°±æ— æ³•ä¿è¯å¤åˆ¶ç»“æœ.<br />\n æ‰€ä»¥  <code>memcpy</code>  å®ç°æ–¹æ³•å› è¯¥å¦‚ä¸‹:</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">void</span><span class=\"token operator\">*</span> <span class=\"token function\">my_memcpy</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token operator\">*</span> dst<span class=\"token punctuation\">,</span> <span class=\"token keyword\">const</span> <span class=\"token keyword\">void</span><span class=\"token operator\">*</span> src<span class=\"token punctuation\">,</span> <span class=\"token class-name\">size_t</span> n<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>tmp_d <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>dst<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>tmp_s <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>src<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre> </pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span>n<span class=\"token operator\">--</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token operator\">*</span>tmp_d<span class=\"token operator\">++</span> <span class=\"token operator\">=</span> <span class=\"token operator\">*</span>tmp_s<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">return</span> dst<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>å¯¹ å…¶è¿›è¡Œåˆ†ç±»è®¨è®ºåˆ™å¯å¾—åˆ°  <code>memmove</code></p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">void</span><span class=\"token operator\">*</span> <span class=\"token function\">my_memmove</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token operator\">*</span> dst<span class=\"token punctuation\">,</span> <span class=\"token keyword\">const</span> <span class=\"token keyword\">void</span><span class=\"token operator\">*</span> src<span class=\"token punctuation\">,</span> <span class=\"token class-name\">size_t</span> n<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>tmp_d <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>dst<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>tmp_s <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>src<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>tmp_d <span class=\"token operator\">></span> tmp_s <span class=\"token operator\">&amp;&amp;</span> tmp_s<span class=\"token operator\">+</span>n <span class=\"token operator\">></span> tmp_d<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span> <span class=\"token comment\">// å†…å­˜é‡å </span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>      tmp_d <span class=\"token operator\">=</span> tmp_d<span class=\"token operator\">+</span>n<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>      tmp_s <span class=\"token operator\">=</span> tmp_s<span class=\"token operator\">+</span>n<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>      <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>n<span class=\"token operator\">--</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span> <span class=\"token comment\">// å…ˆå°†å›è¢«é‡å çš„åœ°æ–¹å­˜å…¥ç›®çš„åœ°å€</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token operator\">*</span>tmp_d<span class=\"token operator\">--</span> <span class=\"token operator\">=</span> <span class=\"token operator\">*</span>tmp_s<span class=\"token operator\">--</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span> </pre></td></tr><tr><td data-num=\"15\"></td><td><pre>      <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span>n<span class=\"token operator\">--</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>          <span class=\"token operator\">*</span>tmp_d<span class=\"token operator\">++</span> <span class=\"token operator\">=</span> <span class=\"token operator\">*</span>tmp_s<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">return</span> dst<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"æŸ”æ€§æ•°ç»„0-é•¿æ•°ç»„\"><a class=\"anchor\" href=\"#æŸ”æ€§æ•°ç»„0-é•¿æ•°ç»„\">#</a> æŸ”æ€§æ•°ç»„ (0 é•¿æ•°ç»„)</h2>\n<p>è¿™é“é¢˜æ˜¯æˆ‘å”¯ä¸€ä¸ç¡®å®šçš„é¢˜ç›®ï¼Œåº”ä¸ºç”¨åˆ°çš„å¤ªå°‘äº† (ä¸ªäºº)<br />\n é¢˜ç›®å¤§è‡´å¦‚ä¸‹:</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdlib.h></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;string.h></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">typedef</span> <span class=\"token keyword\">struct</span> <span class=\"token class-name\">Data_t</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">char</span> value<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">int</span> temp<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">short</span> len<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">char</span> arr<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">&#125;</span> Flex_Array_t<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">int</span> len <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>buf <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token function\">malloc</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span>Flex_Array_t<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> len<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span>Flex_Array_t<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> len<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        buf<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> i<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    Flex_Array_t <span class=\"token operator\">*</span>Array <span class=\"token operator\">=</span> buf<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"array.value = %x\\n\"</span><span class=\"token punctuation\">,</span> Array<span class=\"token operator\">-></span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"array.temp = %x\\n\"</span><span class=\"token punctuation\">,</span> Array<span class=\"token operator\">-></span>temp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"array.len = %x\\n\"</span><span class=\"token punctuation\">,</span> Array<span class=\"token operator\">-></span>len<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"array.arr[0] = %x\\n\"</span><span class=\"token punctuation\">,</span> Array<span class=\"token operator\">-></span>arr<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"array.arr[1] = %x\\n\"</span><span class=\"token punctuation\">,</span> Array<span class=\"token operator\">-></span>arr<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>è¿™é‡Œè€ƒäº†ä¸¤ä¸ªçŸ¥è¯†ç‚¹ï¼Œä¸€ä¸ªæ˜¯å­—èŠ‚å¯¹é½ï¼Œå¦ä¸€ä¸ªæ˜¯æŸ”æ€§æ•°ç»„.<br />\n åœ¨ 32 ä½æœºçš„æ¡ä»¶ä¸‹ï¼Œ4 å­—èŠ‚å¯¹é½ï¼Œæ‰€ä»¥å¤§å°æ˜¯ 1+4+2 +(3+2)= 12 å­—èŠ‚ï¼Œ0 é•¿æ•°ç»„ä¸å ç©ºé—´ï¼Œ<br />\n0 é•¿æ•°ç»„ï¼Œåœ¨ ISO æ ‡å‡†é‡Œæ˜¯ä¸æ”¯æŒçš„ï¼Œä½†æ˜¯ gcc åœ¨ c99 ä¸­é¢„å…ˆæä¾›äº†æ”¯æŒã€‚ç›¸å…³æ–‡æ¡£å†æ­¤:&quot;<span class=\"exturl\" data-url=\"aHR0cHM6Ly9nY2MuZ251Lm9yZy9vbmxpbmVkb2NzL2djYy9aZXJvLUxlbmd0aC5odG1s\">Arrays of Length Zero</span>.&quot;<br />\n æˆ‘æ„Ÿè§‰ 0 é•¿æ•°ç»„çš„ç»“æ„ä½“å…¶å®å°±å’Œ  <code>extern int arr[]</code>  æå…¶ç±»ä¼¼ (ä¸è¿‡æ²¡æœ‰è·¨æ–‡ä»¶ä½œç”¨åŸŸçš„æ•ˆæœ), åœ¨æ²¡æœ‰å®šä¹‰å˜é‡ä¹‹å‰éƒ½ä¸ä¼šäº§ç”Ÿå­˜å‚¨ï¼Œ <code>sizeof</code>   çš„ç»“æœä¸‹ä»–ä»¬å¹¶ä¸å ç”¨ç©ºé—´ã€‚å¯¹äº  <code>Flex_Array_t</code>  ä¹Ÿæ˜¯åŒä¸€ä¸ªé“ç†.<br />\n å…¶å®ï¼Œä¸¥æ ¼æ„ä¹‰ä¸Šæ¥è¯´ï¼Œ0 é•¿å°±ç±»ä¼¼æ•°ç»„é¦–åœ°å€ï¼Œè€Œæ•°ç»„çš„é¦–åœ°å€ä»…ä»…æ˜¯ä¸€ä¸ªæ ‡ç­¾ï¼Œä¸å ç”¨ç©ºé—´ï¼Œä¾‹å¦‚</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">int</span> arr<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span> <span class=\"token keyword\">const</span> <span class=\"token operator\">*</span>argv<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    arr<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0xff</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>å…¶æ±‡ç¼–ä»£ç å¦‚ä¸‹<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/before2022/%E6%9C%AA%E8%B6%8A%E7%95%8C%E6%95%B0%E7%BB%84.png\" alt=\"ASM_Array\" /><br />\narr å­˜å‚¨åœ¨ ä¸ºä¸€ä¸ªå†…å­˜æ ‡ç­¾ï¼Œå’Œ main æ ‡ç­¾ä½œç”¨ç±»ä¼¼ (.comm æ˜¯å£°æ˜æœªåˆå§‹åŒ–çš„å†…å­˜æ®µç©ºé—´)<br />\n<strong> PS: è¿™ä¹Ÿæ˜¯æŒ‡é’ˆå’Œæ•°ç»„é¦–åœ°å€çš„æœ€å¤§ä¸åŒ</strong></p>\n<p>å›åˆ°é¢˜ç›®ï¼Œè¿™é“é¢˜ç›®åœ¨å¼„æ¸…æ¥šè¿™ä¸¤ä¸ªé—®é¢˜å’Œå°±å˜ç®€å•äº†ï¼Œ <code>buf</code>  çš„å¤§å°ä¸º 14, é‚£ä¹ˆ  <code>buf</code>  è¢« èµ‹ç»™  <code>Array</code>  çš„æ—¶å€™ï¼Œå°±æ˜¯ä»  <code>arr[0]</code>  å¼€å§‹èµ‹å€¼åˆ°  <code>arr[13]</code>  ä¸ºæ­¢</p>\n<p>é‚£ä¹ˆå°±å¯ä»¥å…ˆå¾—å‡º  <code>Array.arr[0]</code>  å’Œ  <code>Array.arr[1]</code>  åˆ†åˆ«ä¸º  <code>0x0a</code>  å’Œ  <code>0x0b</code> , å› ä¸ºç»“æ„ä½“çš„æ•°ç»„ä¸å ç©ºé—´ï¼Œå¤šå‡ºçš„é‚£  <code>len</code>  å¿…ç„¶æ˜¯ç»™  <code>arr[0]</code>  çš„.<br />\n ä½™ä¸‹çš„å°±å¾ˆå¥½æ¨æ–­äº†  <code>Array.value = 0</code> , è¡¥é½ 3 å­—èŠ‚ï¼Œ <code>Array.temp = 0x07060504</code> ,  <code>int</code>  æœ¬ä¸º 4 å­—èŠ‚ä¸ç”¨è¡¥é½.  <code>Array.len = 0x0908</code> ,  <code>short</code>  ç±»å‹è¡¥é½ 2 å­—èŠ‚.<br />\n å—¯ï¼Ÿï¼åˆ°è¿™é‡Œå°±æœ‰ä¸€ä¸ªå¤§é—®é¢˜äº†æ—¢ç„¶è¡¥é½äº†  <code>short</code>  ä¸¤ä¸ªå­—èŠ‚ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆ  <code>arr</code>  æ•°å€¼ä¸æ˜¯æœªçŸ¥æ•°å‘¢ï¼Ÿ</p>\n<p>å‰é¢è¯´è¿‡ æŸ”æ€§æ•°ç»„ å¤§å°ä¸º 0, æˆ‘ä»¬å¼€è¾Ÿçš„ç©ºé—´å¤§å°ä¸º ç»“æ„ä½“å¤§å°å¤§å†å¤šä¸Š 2 å­—èŠ‚.<br />\n æˆ‘ä»¬ä½¿ç”¨  <code>malloc</code>  å‡½æ•°å¼€è¾Ÿå‡ºçš„ç©ºé—´æ˜¯è¿ç»­çš„æ‰€ä»¥å¯¹äº æŸ”æ€§æ•°ç»„æ¥è¯´ï¼Œä¸ç®¡å‰é¢è¡¥æ²¡è¡¥é½ï¼Œéƒ½ä»ä¸Šä¸€ä¸ªæ•°æ®ç±»å‹ç»“æŸåˆå¼€å§‹è®¡ç®—ï¼Œç®—æ˜¯ä¸€ä¸ª c99 çš„ç‰¹æ€§å§.<br />\n å…·ä½“åŸå› æˆ‘ä»¥ååœ¨ç¢ç£¨ç¢ç£¨.</p>\n<h2 id=\"dowhile0å®å®šä¹‰ä¸­çš„ä½œç”¨\"><a class=\"anchor\" href=\"#dowhile0å®å®šä¹‰ä¸­çš„ä½œç”¨\">#</a>  <code>do&#123;..&#125;while(0)</code>  å®å®šä¹‰ä¸­çš„ä½œç”¨</h2>\n<p>------------20230615----------------</p>\n<p>æ›¾ç»è§åˆ°è¿‡è¿™æ ·çš„å®</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name function\">__set_task_state</span><span class=\"token expression\"><span class=\"token punctuation\">(</span>tsk<span class=\"token punctuation\">,</span> state_value<span class=\"token punctuation\">)</span>      </span><span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token expression\"><span class=\"token keyword\">do</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token punctuation\">(</span>tsk<span class=\"token punctuation\">)</span><span class=\"token operator\">-></span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>state_value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span></span></span></pre></td></tr></table></figure><p>ä¸€åº¦ä¸çŸ¥é“ä¸ºä»€ä¹ˆè¦ç”¨ <code>do&#123;&#125;while(0)</code>  è¿™ç§ç»“æ„ï¼Œåœ¨æˆ‘çœ‹æ¥å®ƒä¹Ÿå¯ä»¥è¿™æ ·å®ç°</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name function\">__set_task_state</span><span class=\"token expression\"><span class=\"token punctuation\">(</span>tsk<span class=\"token punctuation\">,</span> state_value<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span>tsk<span class=\"token punctuation\">)</span><span class=\"token operator\">-></span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>state_value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></span></pre></td></tr></table></figure><p>ä½†æ˜¯ä»Šå¤©å†æ‰¾æ–‡çŒ®çš„æ—¶å€™å‘ç°ä¸€ç¯‡æœ‰æ„æ€çš„æ–‡ç« <span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cucGl4ZWxzdGVjaC5uZXQvYXJ0aWNsZS8xMzkwNDgyOTUwLWRvLSU3Yi0lN2Qtd2hpbGUtKDApLWluLW1hY3Jvcw==\">åŸæ–‡é“¾æ¥</span>åˆ·æ–°çš„æˆ‘å¯¹è¿™ä¸ªå†™æ³•çš„è®¤çŸ¥</p>\n<p>æ¥è‡ª Google çš„ä¸€ä½ linux å†…æ ¸å¼€å‘å·¥ç¨‹å¸ˆæ˜¯è¿™ä¹ˆè¯´çš„</p>\n<p>do{...}while(0) is the only construct in C that lets you define macros that always work the same way</p>\n<p>å¤§è‡´æ„æ€æ˜¯ do {...} while (0) æ˜¯ C ä¸­å”¯ä¸€å…è®¸æ‚¨å®šä¹‰å§‹ç»ˆä»¥ç›¸åŒæ–¹å¼å·¥ä½œçš„å®çš„æ„é€ </p>\n<p>æ¥çœ‹ä¸ªä¾‹å­ï¼Œå¦‚æœæœ‰è¿™ä¹ˆä¸ªå®</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name function\">foo</span><span class=\"token expression\"><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>  <span class=\"token function\">bar</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token function\">baz</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">// è¿™æ ·ä½¿ç”¨</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">foo</span><span class=\"token punctuation\">(</span>wolf<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>è¿™ä¼šè¢«è½¬è¯‘ä¸º:</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">bar</span><span class=\"token punctuation\">(</span>wolf<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token function\">baz</span><span class=\"token punctuation\">(</span>wolf<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>èƒ½å¤Ÿæ­£å¸¸æ‰§è¡Œï¼Œä½†æ˜¯è¿™ç§æƒ…å†µ</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>feral<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token function\">foo</span><span class=\"token punctuation\">(</span>wolf<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>å°†ä¼šè¢«è§£é‡Šä¸º</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>feral<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token function\">bar</span><span class=\"token punctuation\">(</span>wolf<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">baz</span><span class=\"token punctuation\">(</span>wolf<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>å¾ˆæ˜¾ç„¶ï¼Œè¿™æ˜¯ä¸ç¬¦åˆæˆ‘ä»¬çš„é€»è¾‘çš„ï¼Œå®ƒæ²¡æœ‰åŠæ³•å’Œ do {} while (0) ä¸€æ ·æ­£å¸¸å·¥ä½œ</p>\n<p>å¦‚æœæˆ‘ä»¬æŠŠè¿™ä¸ªå®é‡ç”¨ do {...} while (0), é‡æ–°å®šä¹‰</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name function\">foo</span><span class=\"token expression\"><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>  <span class=\"token keyword\">do</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token function\">bar</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token function\">baz</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span></span></span></pre></td></tr></table></figure><p>è¯¥è¯­å¥åŠŸèƒ½ä¸Šç­‰ä»·äºå‰è€…ï¼Œdo èƒ½ç¡®ä¿å¤§æ‹¬å·é‡Œçš„é€»è¾‘èƒ½è¢«æ‰§è¡Œï¼Œè€Œ while (0) èƒ½ç¡®ä¿è¯¥é€»è¾‘åªè¢«æ‰§è¡Œä¸€æ¬¡ï¼Œå³ä¸æ²¡æœ‰å¾ªç¯æ—¶ä¸€æ ·<br />\nè¯­å¥è¢«è§£é‡Šä¸º</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>feral<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">do</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token function\">bar</span><span class=\"token punctuation\">(</span>wolf<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token function\">baz</span><span class=\"token punctuation\">(</span>wolf<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>Semantically<span class=\"token punctuation\">,</span> it's the same as<span class=\"token operator\">:</span></pre></td></tr></table></figure><p>ä»æœ¬è´¨ä¸Šçš„æ•ˆæœæ¥è¯´ï¼Œä¸Šé¢ç­‰ä»·äºä¸‹é¢è¿™æ®µä»£ç çš„é€»è¾‘</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>feral<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token function\">bar</span><span class=\"token punctuation\">(</span>wolf<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token function\">baz</span><span class=\"token punctuation\">(</span>wolf<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>é‚£ä¹ˆä¸ºå•¥ä¸ç”¨ <code>&#123;&#125;</code>  ç›´æ¥æ‹¬èµ·æ¥å‘¢</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name function\">foo</span><span class=\"token expression\"><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>  <span class=\"token punctuation\">&#123;</span> <span class=\"token function\">bar</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token function\">baz</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">&#125;</span></span></span></pre></td></tr></table></figure><p>è¿™å¯¹äºä¸Šé¢ä¸¾çš„ if è¯­å¥çš„ç¡®èƒ½è¢«æ­£ç¡®æ‰©å±•ï¼Œä½†æ˜¯é’ˆå¯¹ä¸‹é¢è¿™æ®µä»£ç å°±ä¼šå‡ºé”™</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>feral<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token function\">foo</span><span class=\"token punctuation\">(</span>wolf<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token function\">bin</span><span class=\"token punctuation\">(</span>wolf<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>å¯¹åº”æ‹“å±•ä¸º</p>\n<pre><code class=\"language-C\">if (!feral) \n&#123;\n    bar(wolf);\n    baz(wolf);\n&#125;;\nelse\n    bin(wolf);\n</code></pre>\n<p>å¾ˆæ˜¾ç„¶ï¼Œå­˜åœ¨è¯­æ³•é”™è¯¯.<br />\n è‡³äºå¾ªç¯çš„é—®é¢˜ï¼Œå…¶å®ä¸ç”¨æ‹…å¿ƒï¼Œä¸€èˆ¬æ¥è¯´ï¼Œwhile éƒ½ä¼šè¢«ç¼–è¯‘å™¨ä¼˜åŒ–</p>\n<h3 id=\"ä¸€äº›æ€è€ƒ\"><a class=\"anchor\" href=\"#ä¸€äº›æ€è€ƒ\">#</a> ä¸€äº›æ€è€ƒ</h3>\n<p>å…¶å®è®¤çœŸä¸€æƒ³ï¼Œå¦‚æœæˆ‘åªæœ‰ä¸€æ¡è¯­å¥ä¹Ÿç»™ <code>if</code>  æˆ–è€… <code>while</code>  åŠ ä¸Šæ‹¬å·<br />\né‚£ä¹ˆï¼Œå¯¹äº <code>#define foo(x)  &#123; bar(x); baz(x); &#125;</code>  è¿™ä¸ªå®<br />\nåœ¨ä¸‹é¢è¿™æ®µä»£ç ä¹Ÿæ˜¯æ­£å¸¸è¿è¡Œçš„</p>\n<pre><code class=\"language-C\">```C\nif (!feral) \n&#123;\n    &#123;\n        bar(wolf);\n        baz(wolf);\n    &#125;   ;\n&#125;\nelse\n&#123; \n    bin(wolf);\n&#125;\n</code></pre>\n<p>æ˜¯ä¸æ˜¯çªç„¶åœ¨æƒ³è¿™ä¸ªä¸œè¥¿çš„æ„ä¹‰æ˜¯å•¥äº† (ç‹—å¤´), å…¶å®è®¤çœŸæƒ³ä¸€æƒ³ï¼Œå’±ä»¬å†™ä»£ç é™¤äº†è‡ªå·±ç”¨ï¼Œè¿˜ä¼šç»™åˆ«äººä½¿ç”¨<br />\nä½ æ°¸è¿œä¸çŸ¥é“ä½ çš„é˜Ÿå‹ä½¿ç”¨å“ªç§é£çš„ç¼–ç æ–¹å¼ï¼Œè¿™ä¹Ÿæ˜¯ Google é‚£ä½å¤§ä½¬æƒ³è¦è¡¨ç¤ºçš„æœ¬æ„:<br />\n æ— è®ºä½ æ€ä¹ˆè°ƒç”¨è¿™ç§é£æ ¼çš„å®å®ƒéƒ½ä¸ä¼šå‡ºç°è¯­æ³•é”™è¯¯</p>\n<h1 id=\"ç¼–è¯‘å™¨ç‰¹æ€§\"><a class=\"anchor\" href=\"#ç¼–è¯‘å™¨ç‰¹æ€§\">#</a> ç¼–è¯‘å™¨ç‰¹æ€§</h1>\n<h2 id=\"æ¡ä»¶åˆ†æ”¯å’Œå¾ªç¯åˆ†æ”¯å¯èƒ½ä¼ è°£\"><a class=\"anchor\" href=\"#æ¡ä»¶åˆ†æ”¯å’Œå¾ªç¯åˆ†æ”¯å¯èƒ½ä¼ è°£\">#</a> æ¡ä»¶åˆ†æ”¯å’Œå¾ªç¯åˆ†æ”¯ (å¯èƒ½ä¼ è°£)</h2>\n<p>å·¥ä½œçš„æ—¶å€™å¬åˆ°å‰è¾ˆè¯´: while ä¸åŠ æ‹¬å·åªæœ‰åˆ†å·ä¼šå¯¼è‡´é‡èµ·ï¼Œif è¯­å¥ä¹Ÿæ˜¯<br />\nå°±ç±»ä¼¼è¿™æ ·çš„ä»£ç </p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">/* while éƒ¨åˆ† */</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">//...</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span>condition<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">/* if éƒ¨åˆ† */</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">//...</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>condition<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  <span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>æˆ‘å»è¿½é—®äº†ä¸€ä¸‹ï¼Œä½†æ˜¯ä»–ä»¬è¯´æ²¡åŠæ³•å¤ç°ï¼Œæ˜¯ä¹‹å‰é‡åˆ°çš„é—®é¢˜ï¼Œä¸Š google å’Œ Bing é€›äº†ä¸€åœˆæ²¡å‘ç°ç›¸å¯¹åº”çš„ bug<br />\n ä¸è¿‡è¿˜æ˜¯å…ˆè®°å½•ä¸‹æ¥ï¼Œæ¯•ç«Ÿå…¬å¸ç”¨çš„ ADS 1.2, å¯èƒ½æ˜¯ç¼–è¯‘å™¨çš„é—®é¢˜ï¼Œä¸€åˆ‡æ£€æµ‹è¿˜æ˜¯æ‘å¯» ANSI C<br />\n è‡ªå·±å† Keil çš„ ARMCCV5 å’Œ ARMCLANGV6 ä¸­éƒ½æš‚æ—¶æœªå‘ç°å¯¹åº”çš„é—®é¢˜ï¼Œç­‰åé¢å¦‚æœé‡åˆ°ï¼Œé‚£å°±ç”¨å¯¹åº”çš„ç¼–è¯‘å™¨ç”Ÿæˆæ±‡ç¼–çœ‹çœ‹</p>\n<p>------------20230615----------------</p>\n<hr />\n<p>å¤§é“äº”åï¼Œå¤©è¡å››åä¹ï¼Œäººéå…¶ä¸€ï¼</p>\n",
            "tags": [
                "è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯",
                "Cè¯­è¨€",
                "å£°æ˜,å­¦ä¹ ç¬”è®°"
            ]
        },
        {
            "id": "https://to-ywz.github.io/work/%E9%9D%A2%E8%AF%95%E5%B0%8F%E7%BB%93/",
            "url": "https://to-ywz.github.io/work/%E9%9D%A2%E8%AF%95%E5%B0%8F%E7%BB%93/",
            "title": "é¢è¯•å°ç»“",
            "date_published": "2023-03-14T03:23:33.000Z",
            "content_html": "<p>ä»Šå¤©é¢è¯•äº†ä¸€ä¸ªå¾ˆæœ‰è¶£çš„ä¼ä¸šï¼ŒHR è¶…çº§å‹å–„ï¼Œè™½ç„¶æŠ€æœ¯æœ‰ä¸€äº›é—®é¢˜æ²¡æœ‰å›ç­”ä¸Šæ¥ï¼Œï¼ˆæŒ å¤´ï¼‰</p>\n<p>ä¾‹å¦‚ï¼Œèˆµæœºçš„æ§åˆ¶è„‰å®½ï¼Œå’Œè„‰å®½å‘¨æœŸ è¿˜æœ‰ modbus rtu åè®®çš„å¼€å§‹å’Œç»“æŸçš„æ¡ä»¶ï¼Œä»¥åŠä½ç½® PIDï¼ˆæœ¬è´¨æ˜¯ä¸€æ ·çš„å˜›ï¼‰</p>\n<p>è¶è¿™æ¬¡æœºä¼šå›é¡¾ä¸€ä¸‹è¿™äº›å†…å®¹</p>\n<h1 id=\"èˆµæœºè„‰å®½\"><a class=\"anchor\" href=\"#èˆµæœºè„‰å®½\">#</a> èˆµæœºè„‰å®½</h1>\n<h2 id=\"èˆµæœºæ§åˆ¶ä¿¡å·\"><a class=\"anchor\" href=\"#èˆµæœºæ§åˆ¶ä¿¡å·\">#</a> èˆµæœºæ§åˆ¶ä¿¡å·</h2>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.6hyx804jeqc0.jpg\" alt=\"image\" /></p>\n<h1 id=\"uart\"><a class=\"anchor\" href=\"#uart\">#</a> UART</h1>\n<h2 id=\"ç–‘æƒ‘\"><a class=\"anchor\" href=\"#ç–‘æƒ‘\">#</a> ç–‘æƒ‘</h2>\n<h3 id=\"uartæ˜¯ä¸æ˜¯åè®®\"><a class=\"anchor\" href=\"#uartæ˜¯ä¸æ˜¯åè®®\">#</a> UART æ˜¯ä¸æ˜¯åè®®</h3>\n<p>æŠ€æœ¯é¢è¯´ UART ä¸æ˜¯åè®®ï¼Œå½“æ—¶æ²¡ååº”è¿‡æ¥å°±é¡ºç€è¯´ UART æ˜¯å¤–è®¾ã€‚</p>\n<p>ä½†æ˜¯ç­‰ç¼“è¿‡æ¥æ€è€ƒ UART çš„ç¡®æ˜¯ä¸€ä¸ªåè®®ï¼Œå› ä¸ºä»–æ˜¯è¢«è®¾è®¡å‡ºæ¥ç”¨äºå°†å¹¶è¡Œæ•°æ®è½¬åŒ–ä¸ºå¹¶è¡Œæ•°æ®çš„ï¼Œæœ‰å¼€å§‹ä¿¡å·ï¼Œæœ‰ç»“æŸä¿¡å·ï¼Œè¿˜å¯ä»¥æœ‰æ ¡éªŒä½ï¼Œä¸¥æ ¼æ„ä¹‰ä¸Šæ¥è¯´ä¸²å£æ˜¯ç‰©ç†å±‚é€šä¿¡åè®®ã€‚</p>\n<p>ä¸ IIC å’Œ SPI å®åœ¨åŒä¸€å±‚çš„ï¼Œåªä¸è¿‡ IIC å’Œ SPI è¿˜æ¶‰åŠæ•°æ®é“¾è·¯å±‚ æ›´åå‘äº LLC å­å±‚</p>\n<p>è€Œ Modbus-RTU è™½ç„¶æ˜¯åœ¨ç‰©ç†å±‚å’Œæ•°æ®é“¾è·¯å±‚å®ç°çš„åè®®ï¼Œä½†æ˜¯åœ¨å®é™…çš„å·¥ä¸šæ§åˆ¶ä¸­ä¼šè¢«åˆ—ä¸ºåº”ç”¨å±‚ï¼Œéœ€è¦å…·ä½“é—®é¢˜å…·ä½“åˆ†æ</p>\n<h3 id=\"uartä¸ä¸²å£çš„å…³ç³»\"><a class=\"anchor\" href=\"#uartä¸ä¸²å£çš„å…³ç³»\">#</a> UART ä¸ä¸²å£çš„å…³ç³»</h3>\n<p>UART æ˜¯ä¸€ç§ä¸²è¡Œé€šä¿¡æ¥å£ï¼Œå®ƒå®šä¹‰äº†æ•°æ®ä¼ è¾“çš„æ ¼å¼å’Œæœºåˆ¶</p>\n<p>è€Œä¸²å£é€šå¸¸æŒ‡çš„æ˜¯è¿æ¥è®¡ç®—æœºä¸å¤–éƒ¨è®¾å¤‡çš„ä¸²è¡Œé€šä¿¡æ¥å£ï¼Œå®ƒä¹Ÿæ˜¯ä¸€ç§ä¸²è¡Œé€šä¿¡æ¥å£</p>\n<p>åœ¨è®¡ç®—æœºä¸­ï¼Œä¸²å£é€šå¸¸æ˜¯æŒ‡ RS-232 ä¸²å£ï¼Œå®ƒæ˜¯ä¸€ç§æ ‡å‡†çš„ä¸²è¡Œé€šä¿¡æ¥å£</p>\n<p>RS-232 ä¸²å£æ”¯æŒå¼‚æ­¥é€šä¿¡æ–¹å¼ï¼Œå¹¶ä¸”ä½¿ç”¨äº† UART åè®®æ¥è¿›è¡Œæ•°æ®ä¼ è¾“</p>\n<p>åœ¨ RS-232 ä¸²å£ä¸­ï¼Œæ¯ä¸ªå­—èŠ‚éƒ½ç”±èµ·å§‹ä½ã€æ•°æ®ä½ã€æ ¡éªŒä½å’Œåœæ­¢ä½ç»„æˆï¼Œæ„æˆäº† UART åè®®å®šä¹‰çš„æ•°æ®å¸§ç»“æ„</p>\n<p>æ‰€ä»¥ UART å’Œä¸²å£ä¹‹é—´çš„å…³ç³»æ˜¯ï¼ŒUART å®šä¹‰äº†æ•°æ®ä¼ è¾“çš„æ ¼å¼å’Œæœºåˆ¶ï¼Œè€Œä¸²å£ï¼ˆå¦‚ RS-232 ä¸²å£ï¼‰åˆ™æ˜¯ä¸€ç§æ”¯æŒ UART åè®®çš„ç‰©ç†æ¥å£</p>\n<h2 id=\"åè®®\"><a class=\"anchor\" href=\"#åè®®\">#</a> åè®®</h2>\n<h3 id=\"æ³¢ç‰¹ç‡\"><a class=\"anchor\" href=\"#æ³¢ç‰¹ç‡\">#</a> æ³¢ç‰¹ç‡</h3>\n<p>æ³¢ç‰¹ç‡æ˜¯ UART åè®®ï¼Œæˆ–è€…è¯´æ‰€æœ‰å¼‚æ­¥ä¸²è¡Œåè®®ï¼Œéå¸¸é‡è¦çš„ä¸€ä¸ªæ¦‚å¿µï¼Œå³å•ä½æ—¶é—´å†…ï¼ˆ1 ç§’ï¼‰å¯è¡¨ç¤ºçš„ bit ä½ä¸ªæ•°ï¼Œæˆ–è€…ä¹Ÿå¯ä»¥è¡¨è¿°ä¸º bit ä½å®½çš„å€’æ•°</p>\n<p>ä¾‹å¦‚ä¸€ä¸ªæ³¢ç‰¹ç‡ä¸º 115200 çš„ UART æ³¢å½¢è¡¨ç¤º 1 ç§’å¯å®¹çº³ 115200 ä¸ª bit ä½ï¼Œä¹Ÿå°±æ˜¯è¯´æ¯ä¸€ä½ bit æ•°æ®å å¤§çº¦ 8.68uS çš„æ—¶é•¿ï¼Œå³ 8.68bit/s<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.29t68ob44aqs.jpg\" alt=\"image\" /></p>\n<h3 id=\"æ—¶åº\"><a class=\"anchor\" href=\"#æ—¶åº\">#</a> æ—¶åº</h3>\n<h4 id=\"ç©ºé—²ä¿¡å·\"><a class=\"anchor\" href=\"#ç©ºé—²ä¿¡å·\">#</a> ç©ºé—²ä¿¡å·</h4>\n<p>è®¾å¤‡ä¹‹é—´ä¸ä¼ è¾“æ•°æ®æ—¶ä»¥æŒç»­çš„é«˜ç”µå¹³è¡¨ç¤ºç©ºé—²</p>\n<p>ç©ºé—²ä½æŒç»­æ—¶é—´è¶Šé•¿ï¼Œä¸¤ä¸ªæ•°æ®å¸§é—´éš”ä¹Ÿè¶Šé•¿ï¼Œå•ä½æ—¶é—´ä¼ è¾“çš„æ•°æ®å°±è¶Šå°‘</p>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.6d7lfqh2aac0.jpg\" alt=\"image\" /></p>\n<h4 id=\"èµ·å§‹ä½\"><a class=\"anchor\" href=\"#èµ·å§‹ä½\">#</a> èµ·å§‹ä½</h4>\n<p>UART æ¥æ”¶ç«¯ä¼šä¸€ç›´æ£€æµ‹ä¿¡å·çº¿ä¸Šçš„ç”µå¹³å˜åŒ–</p>\n<p>å¼€å§‹ä¼ è¾“æ•°æ®æ—¶ï¼Œå‘é€ç«¯å°†ä¿¡å·çº¿ä»é«˜ç”µå¹³æ‹‰åˆ°ä½ç”µå¹³ç»“æŸç©ºé—²çŠ¶æ€ï¼Œå¹¶ä¿æŒä¸€ä¸ª bit ä½çš„æ—¶é•¿</p>\n<p>æ¥æ”¶å™¨æ£€æµ‹åˆ°é«˜ä½ç”µå¹³è½¬æ¢æ—¶ï¼Œå¼€å§‹æ¥æ”¶ä¿¡å·</p>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.6d7lfqh2aac0.jpg\" alt=\"image\" /></p>\n<h4 id=\"æ•°æ®\"><a class=\"anchor\" href=\"#æ•°æ®\">#</a> æ•°æ®</h4>\n<p>æ•°æ®ä½åŒ…å«ä¼ è¾“çš„å®é™…æ•°æ®ï¼Œå¦‚æœä½¿ç”¨äº†å¥‡å¶æ ¡éªŒï¼Œé‚£ä¹ˆæ•°æ®ä½é•¿ä¸º 5~8 bits<br />\n å¦‚æœæ²¡æœ‰ä½¿ç”¨å¥‡å¶æ ¡éªŒï¼Œåˆ™ä½é•¿ä¸º 5~9 bits<br />\n åœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ•°æ®ä½ä¸º 8 bitsï¼Œæ•°æ®é¦–å…ˆä»æœ€ä½æœ‰æ•ˆä½å¼€å§‹å‘é€ï¼Œé«˜ä½åœ¨å</p>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.hftmmwctz1s.jpg\" alt=\"image\" /></p>\n<h4 id=\"æ ¡éªŒä½\"><a class=\"anchor\" href=\"#æ ¡éªŒä½\">#</a> æ ¡éªŒä½</h4>\n<p>æ ¡éªŒä½å¯ä»¥ç”¨æ¥æé«˜ä¼ è¾“çš„å¯é æ€§ã€‚å¦‚æœä¿¡å·åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­å› ä¸ºå¹²æ‰°è€Œå¯¼è‡´æŸäº›ä½ç½®çš„ç”µå¹³äº§ç”Ÿé”™è¯¯ï¼Œé€šè¿‡è®¡ç®—æ¥æ”¶çš„æ•°æ®å’Œæ ¡éªŒä½æ˜¯å¦åŒ¹é…å³å¯åˆ¤æ–­æ•°æ®æ˜¯å¦æœ‰ä¼ è¾“é”™è¯¯ï¼Œä»è€Œç»™åº”ç”¨å±‚æä¾›æœ‰æ•ˆä¿¡æ¯æ¥å†³å®šæ¥å— / ä¸¢å¼ƒå¯¹åº”çš„æ•°æ®ã€‚</p>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.52o4r1mqv6c0.jpg\" alt=\"image\" /></p>\n<h4 id=\"åœæ­¢ä½\"><a class=\"anchor\" href=\"#åœæ­¢ä½\">#</a> åœæ­¢ä½</h4>\n<p>åœæ­¢ä½è¡¨ç¤ºä¸€å¸§æ•°æ®çš„ç»“æŸï¼Œå®é™…æ˜¯ä¸€æ®µæ—¶é—´çš„é«˜ç”µå¹³</p>\n<p>åœæ­¢ä½çš„æ—¶é—´é•¿çŸ­å¯ä»¥è®¾ç½®ä¸º 1ã€1.5 æˆ–è€… 2bits çš„åœæ­¢ä½</p>\n<p>å¤§éƒ¨åˆ†æƒ…å†µä½¿ç”¨ 1bit çš„åœæ­¢ä½ã€‚</p>\n<p>UART æ˜¯ä¸€ä¸ªå¼‚æ­¥åè®®ï¼Œæ¯ä¸€å¸§çš„å¼€å¤´å¯ä»¥ç”¨è·³å˜æ²¿æ¥åŒæ­¥</p>\n<p>ä½†æ˜¯åœæ­¢ä½åªèƒ½é€šè¿‡æ³¢ç‰¹ç‡æ¥è®¡ç®—ç›¸å¯¹ä½ç½®ï¼Œå¦‚æœåœ¨åœæ­¢ä½çš„ä½ç½®è¯†åˆ«åˆ°ä¸€ä¸ªä½ç”µå¹³ï¼Œåˆ™ä¼šäº§ç”Ÿå¸§é”™è¯¯</p>\n<p>æ‰€ä»¥åœ¨é€šè®¯è¿‡ç¨‹ä¸­ï¼Œä¸ºäº†å‡å°‘æ³¢ç‰¹ç‡çš„è¯¯å·®å¯¼è‡´çš„é—®é¢˜ï¼Œå¯ä»¥è®¾ç½®ä¸åŒçš„åœæ­¢ä½é•¿åº¦æ¥é€‚é…</p>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.1jkb9cvxp7b4.jpg\" alt=\"image\" /></p>\n<h3 id=\"æ•°æ®å¸§\"><a class=\"anchor\" href=\"#æ•°æ®å¸§\">#</a> æ•°æ®å¸§</h3>\n<p>UART çš„åè®®å¸§ç”± 1 ä½èµ·å§‹ä½ï¼Œæ•°æ®ä¸º 5-8 ä½ï¼Œæ ¡éªŒä½ 1 ä½ (å¯é€‰) å’Œä¸€ä½çš„åœæ­¢ä½</p>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.6qksemj3abc0.jpg\" alt=\"image\" /></p>\n<p>ä»¥å­—ç¬¦ D ä¸ºä¾‹å­ï¼Œä½¿ç”¨ 8 ä½æ•°æ®ä¸ºï¼Œ0 ä½æ ¡éªŒä½ï¼Œå½¢æˆçš„æ³¢å½¢ç†è®ºå¦‚ä¸‹</p>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.1lez0vxuwr0g.jpg\" alt=\"image\" /></p>\n<p>ä»¥å­—ç¬¦  <code>D</code>  ä¸ºä¾‹ï¼Œå…¶æ³¢å½¢åœ¨ç¤ºæ³¢å™¨ä¸­å®é™…ä¸ºä¸‹å›¾</p>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.6qmgnzg9p040.webp\" alt=\"image\" /></p>\n<h1 id=\"modbus\"><a class=\"anchor\" href=\"#modbus\">#</a> MODBUS</h1>\n<p>modbus åˆ†ä¸ºä¸‰ç§ï¼Œå¸¸ç”¨çš„æ˜¯ modbus-RTU, å°‘éƒ¨åˆ†æ˜¯ Modbus-ASCII</p>\n<p>æ€»ä½“æ¥è¯´ï¼ŒMODBUS-RTU æ¯” MODBUS-ASCII å…·æœ‰æ›´é«˜çš„ä¼ è¾“æ•ˆç‡ï¼ŒMODBUS-RTU çš„ä¼ è¾“é€Ÿç‡é€šå¸¸å¯ä»¥è¾¾åˆ° 9600bps æˆ–æ›´é«˜ï¼Œè€Œ MODBUS-ASCII çš„ä¼ è¾“é€Ÿç‡ä¸€èˆ¬åœ¨ 1200bps å·¦å³</p>\n<h2 id=\"modbus-rtu\"><a class=\"anchor\" href=\"#modbus-rtu\">#</a> Modbus RTU</h2>\n<p>ModBus RTUï¼ˆRemote Terminal Unitï¼‰æ˜¯ ModBus åè®®æœ€å¸¸è§çš„å®ç°æ–¹å¼ï¼Œé‡‡ç”¨äºŒè¿›åˆ¶æ•°æ®ä¼ è¾“ï¼Œå…·æœ‰è¾ƒé«˜çš„ä¼ è¾“æ•ˆç‡å’Œç¨³å®šæ€§ã€‚å®ƒä½¿ç”¨ä¸²è¡Œé€šä¿¡ï¼Œæ”¯æŒ RS232 å’Œ RS485 ä¸¤ç§æ¥å£ã€‚åœ¨ RTU æ¨¡å¼ä¸‹ï¼Œæ¯ä¸ªå­—èŠ‚å¯ä»¥ä¼ è¾“ä¸¤ä½åå…­è¿›åˆ¶å­—ç¬¦ã€‚æ¯”å¦‚ 0xAB ä¼šç›´æ¥ä»¥åå…­è¿›åˆ¶ 0xABï¼ˆäºŒè¿›åˆ¶ 10101011ï¼‰è¿›è¡Œå‘é€ã€‚å…¶æ¶ˆæ¯å¸§æ ¼å¼ç”±ä»¥ä¸‹éƒ¨åˆ†ç»„æˆï¼š</p>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.1lc0olvrbnr4.jpg\" alt=\"image\" /></p>\n<p>RTU æ¨¡å¼é‡‡ç”¨ 16 ä½ CRC æ ¡éªŒï¼Œåç»­çš„å‘½ä»¤ / æ•°æ®å¸¦æœ‰å¾ªç¯å†—ä½™æ ¡éªŒçš„æ ¡éªŒå’Œã€‚RTU æ¨¡å¼æ¯”è¾ƒå¸¸ç”¨ï¼Œè€Œ ASCII ä¸€èˆ¬å¾ˆå°‘ç”¨</p>\n<h3 id=\"ä»‹è´¨ç®¡ç†\"><a class=\"anchor\" href=\"#ä»‹è´¨ç®¡ç†\">#</a> ä»‹è´¨ç®¡ç†</h3>\n<p>å¯¹äº ModBus-RTU æ¥è¯´ï¼Œå¯¹å¸§çš„æ—¶é—´ç®¡ç†ï¼Œå°±æ˜¯å¯¹ä»‹è´¨çš„å†²çªç®¡ç†</p>\n<p>ModBus-RTU å¯¹äºä»‹è´¨ç®¡ç†è§„å®šäº† 2 ä¸ªé‡è¦çš„æ—¶é—´å‚æ•°ï¼Œä»¥å®ç°æˆå¸§ã€å†²çªç®¡ç†ç­‰ã€‚å‚è€ƒä¸‹å›¾</p>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/1678957117951.68d47yw77t80.jpg\" alt=\"1678957117951\" /></p>\n<p>è¿™ä¸ªå›¾å¯ä»¥ç”¨äºæ–­å¸§ï¼Œä¹Ÿå°±æ—¶åˆ¤æ–­æ˜¯å¦æ¥æ”¶åˆ°ä¸€ä¸ªå®Œæ•´çš„å¸§ï¼Œå› æ­¤åªéœ€è¦ä½¿ç”¨ä¸€ä¸ªå®šæ—¶å™¨åœ¨æ¯æ¬¡æ”¶åˆ°ä¸€ä¸ªå­—èŠ‚åï¼Œå°±é‡å¯ä¸€ä¸ª 3.5 å­—èŠ‚å®šæ—¶å™¨ï¼Œå¦‚æœè¿™ä¸ª 3.5 å­—èŠ‚å®šæ—¶å™¨ä¸­æ–­äº†ï¼Œå°±è¯æ˜æ”¶åˆ°äº†ä¸€ä¸ª Modbus æŠ¥æ–‡ï¼Œè‡³äºè¿™ä¸ªæŠ¥æ–‡æ˜¯ä¸æ˜¯æ­£ç¡®çš„æŠ¥æ–‡ï¼Œå¯ä»¥åœ¨è¿›ä¸€æ­¥æ ¹æ®å¸§æ ¼å¼è¿›è¡Œæ ¡éªŒ</p>\n<p>é™¤æ­¤ä¹‹å¤–è¿˜è§„å®šäº†ï¼Œå½“æŠ¥æ–‡éœ€è¦è¿ç»­å‘é€ï¼Œå­—èŠ‚é—´éš”ä¸å¾—è¶…è¿‡ 1.5 å­—èŠ‚æ—¶é—´<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.6hrmwwuzn5s0.jpg\" alt=\"image\" /></p>\n<h3 id=\"modbus-ascii\"><a class=\"anchor\" href=\"#modbus-ascii\">#</a> Modbus ASCII</h3>\n<p>ModBus ASCII é‡‡ç”¨ ASCII ç ä¼ è¾“æ–‡æœ¬ä¿¡æ¯ï¼Œæ¯ä¸ª 8Bit å­—èŠ‚éƒ½ä½œä¸ºä¸¤ä¸ª ASCII å­—ç¬¦å‘é€ã€‚ç›¸å¯¹ ModBus RTU è€Œè¨€ï¼Œå®ƒçš„ä¼ è¾“æ•ˆç‡è¾ƒä½ï¼Œä½†å…·æœ‰æ›´å¥½çš„å¯è¯»æ€§ã€‚ModBus ASCII ä¹Ÿä½¿ç”¨ä¸²è¡Œé€šä¿¡ï¼Œå¹¶æ”¯æŒ RS232 å’Œ RS485 ä¸¤ç§æ¥å£ï¼Œé€‚ç”¨äºçŸ­è·ç¦»é€šä¿¡ã€‚åœ¨ ASCII æ¨¡å¼ä¸‹ï¼Œæ¯ä¸ª 8 ä½çš„å­—èŠ‚æ‹†åˆ†ä¸ºä¸¤ä¸ª ASCII å­—ç¬¦è¿›è¡Œå‘é€ï¼Œæ¶ˆæ¯å¸§ä»¥è‹±æ–‡å†’å· â€œï¼šâ€ å¼€å§‹ï¼Œä»¥å›è½¦å’Œæ¢è¡Œï¼ˆCRLFï¼‰ç¬¦å·ç»“æŸã€‚ä¾‹å¦‚åå…­è¿›åˆ¶æ•° 0xABï¼Œä¼šè¢«åˆ†è§£æˆ ASCII å­—ç¬¦ â€œAâ€ å’Œ â€œBâ€ è¿›è¡Œå‘é€</p>\n<h1 id=\"pid\"><a class=\"anchor\" href=\"#pid\">#</a> PID</h1>\n<p>æŠ€æœ¯é¢è¯´ ä½ç½®å¼ PID å’Œ å¢é‡å¼ PID æ²¡æœ‰åŒºåˆ«</p>\n<p>è™½ç„¶æˆ‘è§‰å¾—å“ªé‡Œä¸å¤ªå¯¹ï¼Œä½†æ˜¯æ²¡æ•¢åé©³ï¼Œæ¯•ç«Ÿæˆ‘å¯¹ PID çš„ç†è§£è¿˜æ˜¯æœ‰é™çš„ï¼Œæ‰€ä»¥æˆ‘å…ˆæ¥æ•´ç†ä¸€ä¸‹</p>\n<h2 id=\"æ™®é€špid\"><a class=\"anchor\" href=\"#æ™®é€špid\">#</a> æ™®é€š PID</h2>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.5eos6j11aog0.jpg\" alt=\"image\" /></p>\n<p>æ­£å„¿å…«ç»çš„ PID å…¬å¼å¦‚ä¸Šï¼Œ ç¦»æ•£åŒ–ä¹‹åï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>K</mi><mi>d</mi></msub></mrow><annotation encoding=\"application/x-tex\">K_d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> å’Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>K</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">K_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> éƒ½ä¸ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>K</mi><mi>p</mi></msub></mrow><annotation encoding=\"application/x-tex\">K_p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15139200000000003em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> ä»¥åŠé‡‡æ ·æ—¶é—´  <code>T</code>  ç›¸å…³</p>\n<h2 id=\"ä½ç½®å¼pid\"><a class=\"anchor\" href=\"#ä½ç½®å¼pid\">#</a> ä½ç½®å¼ PID</h2>\n<p>åœ¨ä¸è€ƒè™‘ PI çš„æƒ…å†µä¸‹</p>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.6iofatrs17g0.jpg\" alt=\"image\" /></p>\n<p>ä»å…¬å¼ä¸­å¯ä»¥çœ‹å‡ºï¼Œæ¯”ä¾‹éƒ¨åˆ†åªä¸å½“å‰çš„è¯¯å·®é‡æœ‰å…³ï¼Œè€Œç§¯åˆ†éƒ¨åˆ†åˆ™æ˜¯ç³»ç»Ÿè¿‡å»åå·®çš„ç´¯ç§¯</p>\n<p>æ‰€ä»¥å¾ˆæ˜¾ç„¶çš„å¯ä»¥çœ‹åˆ°ä½ç½®å¼ PI éœ€è¦è¿›è¡Œä¸€ä¸ªè®¡ç®—çš„ç´¯åŠ ä»<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>e</mi><mn>0</mn></msub></mrow><annotation encoding=\"application/x-tex\">e_0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>~<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>e</mi><mi>k</mi></msub></mrow><annotation encoding=\"application/x-tex\">e_k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></p>\n<p>å½“ k å€¼è¾ƒå¤§æ—¶ï¼Œæ¶ˆè€—å¤§é‡çš„ç©ºé—´</p>\n<p>ä½†æ˜¯ï¼Œåœ¨å®é™…å®ç°ä¸­æˆ‘ä»¬åªä¼šä¿ç•™æ¯ä¸€æ¬¡ç§¯åˆ†çš„ç´¯è®¡å’Œï¼Œæ ¹æœ¬ä¸éœ€è¦å¤§é‡çš„å†…å­˜ç©ºé—´</p>\n<p>å¦å¤–ç”±äºè¾“å‡ºæœ‰å¯èƒ½è¶…è¿‡å…è®¸å€¼ï¼Œå› æ­¤éœ€è¦å¯¹è¾“å‡ºè¿›è¡Œé™å¹…ï¼Œ *** è€Œå½“è¾“å‡ºé™å¹…çš„æ—¶å€™ï¼Œç§¯åˆ†ç´¯åŠ éƒ¨åˆ†ä¹Ÿåº”åŒæ—¶è¿›è¡Œé™å¹… ***ï¼Œä»¥é˜²è¾“å‡ºä¸å˜è€Œç§¯åˆ†é¡¹ç»§ç»­ç´¯åŠ ï¼Œä¹Ÿå³æ‰€è°“çš„ç§¯åˆ†é¥±å’Œè¿‡æ·±</p>\n<h2 id=\"å¢é‡å¼pid\"><a class=\"anchor\" href=\"#å¢é‡å¼pid\">#</a> å¢é‡å¼ PID</h2>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.6t49fpp59zk0.jpg\" alt=\"image\" /></p>\n<p>ç”±äº<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">u(0)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">0</span></span></span></span>ï¼Œåœ¨å…·ä½“ç¼–ç¨‹æ“ä½œä¸­ï¼Œå¯¹æ¯ä¸€æ‹çš„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">Î”</mi><mi>u</mi><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">Î”u(k)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">Î”</span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mclose\">)</span></span></span></span> è¿›è¡Œç´¯ç§¯ï¼Œå³ä¸º PI è°ƒèŠ‚å™¨çš„è¾“å‡º</p>\n<p>åŒæ ·åœ°ï¼Œä¸ºäº†é¿å…è¶…è¿‡å…è®¸å€¼ï¼Œ ** ä»…éœ€å¯¹è¾“å‡ºé™å¹…å³å¯ **</p>\n<h2 id=\"å°ç»“\"><a class=\"anchor\" href=\"#å°ç»“\">#</a> å°ç»“</h2>\n<p>å¯ä»¥ç†è§£ä¸ºæ— è®ºç”¨å¢é‡å åŠ çš„æ–¹å¼æ¥è®¡ç®—ä½ç½®å¼ PIï¼Œè¿˜æ˜¯ç›´æ¥è®¡ç®—ï¼Œç»“æœéƒ½æ˜¯ç›¸åŒçš„</p>\n<p><strong>å”¯ä¸€çš„åŒºåˆ«ï¼šä½ç½®å¼ PI éœ€è¦åŒæ—¶è®¾ç½®ç§¯åˆ†é™å¹…å’Œè¾“å‡ºé™å¹…ï¼Œè€Œå¢é‡å¼ PI åªéœ€è¾“å‡ºé™å¹…</strong></p>\n<hr />\n<p>å¤§é“äº”åï¼Œå¤©è¡å››åä¹ï¼Œäººéå…¶ä¸€ï¼</p>\n",
            "tags": [
                "æ±‚èŒ",
                "é¢è¯•"
            ]
        },
        {
            "id": "https://to-ywz.github.io/win11/Question/win11%E5%85%B3%E9%97%AD%E8%87%AA%E5%B8%A6%E7%9A%84%E7%B9%81%E4%BD%93%E5%88%87%E6%8D%A2/",
            "url": "https://to-ywz.github.io/win11/Question/win11%E5%85%B3%E9%97%AD%E8%87%AA%E5%B8%A6%E7%9A%84%E7%B9%81%E4%BD%93%E5%88%87%E6%8D%A2/",
            "title": "win11å…³é—­è‡ªå¸¦çš„ç¹ä½“åˆ‡æ¢",
            "date_published": "2023-01-22T10:01:15.000Z",
            "content_html": "<p>æœ€è¿‘åœ¨ä½¿ç”¨ï¼ŒCCS çš„æ—¶å€™æ€»æ˜¯ä¼šå‡ºç°è¾“å…¥æ³•å˜æˆç¹ä½“çš„é—®é¢˜ï¼Œéƒ½æ˜¯æ‰‹åŠ¨è®¾ç½®å›å»ï¼Œä¸€ç›´æ²¡ç®¡å®ƒã€‚æ–°å¹´æ–°æ°”è±¡ï¼Œè¿™ä¸ªé—®é¢˜å¹´åˆä¸€å°±è¦è§£å†³.</p>\n<p>å»çœ‹äº†ä¸€ä¸‹ win11 çš„å¿«æ·é”®æ˜ å°„ã€‚å¥½å®¶ä¼™ï¼Œç®€ä½“ç¹ä½“åˆ‡æ¢çš„å¿«æ·é”®å’Œæºç æ ¼å¼åŒ–çš„å¿«æ·é”®å†²çªäº†ï¼Œè¿™å°±å¿ä¸äº†</p>\n<p>ç¹ä½“æˆ‘å‹æ ¹ç”¨ä¸åˆ°ï¼Œæ‰€ä»¥è¿™ä¸ªç»™å¿«æ·é”®ç­‰äºæµªè´¹ï¼Œéš¾æ€ªæœ‰äº›æ—¶å€™æ ¼å¼åŒ–æºç ä¸å¥½ä½¿ï¼Œæ‰€ä»¥æˆ‘å†³å®šå…³é—­è¿™ä¸ªæ²¡ç”¨çš„å¿«æ·é”®</p>\n<h1 id=\"ç¬¬ä¸€æ­¥-æ‰“å¼€è¯­è¨€è®¾ç½®\"><a class=\"anchor\" href=\"#ç¬¬ä¸€æ­¥-æ‰“å¼€è¯­è¨€è®¾ç½®\">#</a> ç¬¬ä¸€æ­¥ï¼šæ‰“å¼€è¯­è¨€è®¾ç½®</h1>\n<h2 id=\"æ–¹æ¡ˆä¸€-wins-æœç´¢è¯­è¨€è®¾ç½®\"><a class=\"anchor\" href=\"#æ–¹æ¡ˆä¸€-wins-æœç´¢è¯­è¨€è®¾ç½®\">#</a> æ–¹æ¡ˆä¸€:  <code>WIN+S</code>  æœç´¢è¯­è¨€è®¾ç½®</h2>\n<p><code>win+s</code>  é”®ï¼Œè¾“å…¥<strong>è¯­è¨€è®¾ç½®</strong></p>\n<p>è¯´å®è¯è¿™æ˜¯æˆ‘æœ€å–œæ¬¢çš„æ–¹æ¡ˆï¼Œå¤§éƒ¨åˆ†ç³»ç»Ÿè®¾ç½®æˆ‘éƒ½æ˜¯ç›´æ¥  <code>win+s</code>  ç„¶åæœç´¢çš„ï¼Œæœç´¢åˆ°ç›´æ¥å›è½¦å°±èƒ½è¿›å…¥ç•Œé¢ï¼Œæ–¹ä¾¿å¿«æ·<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.50zve2dt86w0.jpg\" alt=\"image\" /></p>\n<h2 id=\"æ–¹æ¡ˆäºŒ-å³é”®è¾“å…¥æ³•å›¾æ ‡\"><a class=\"anchor\" href=\"#æ–¹æ¡ˆäºŒ-å³é”®è¾“å…¥æ³•å›¾æ ‡\">#</a> æ–¹æ¡ˆäºŒï¼šå³é”®è¾“å…¥æ³•å›¾æ ‡</h2>\n<p>å³é”®ä¸­æ–‡çš„ä¸­å­—ï¼Œé€‰æ‹©è®¾ç½® (<strong>ç”¨è¿™ç§æ–¹æ³•è¿›å…¥çš„å¯ä»¥ç›´æ¥è½¬è·³åˆ° ç¬¬å››æ­¥</strong>)</p>\n<p>è¿™ä¸ªæ˜¯åœ¨æˆ‘ä¸ç†Ÿæ‚‰  <code>win+s</code>  æŒ‰é”®å¸¸ç”¨çš„å®šä½æ–¹æ³•ï¼Œä¹Ÿå¾ˆå¿«æ·ï¼Œä¸éœ€è¦è¾“å…¥ï¼Œæ¯•ç«Ÿå¯èƒ½å¤„äºè¿™ä¸ªé—®é¢˜æ—¶ï¼Œè¾“å…¥æ³•éƒ½æ˜¯ç¹ä½“ï¼Œå­—éƒ½ä¸ä¸€å®šè®¤å¾—å…¨<br />\nè€Œä¸”è¿™ä¸ªæ–¹æ³•è¿˜å¯ä»¥é…ç½®ä¸€äº›ç®€å•çš„ è¾“å…¥æ³•è®¾ç½®ï¼Œä¸éœ€è¦æ‰“å¼€æ–°é¡µé¢ï¼Œä¹‹å‰æˆ‘å°±æ˜¯åœ¨è¿™æ‰‹åŠ¨é…ç½®å›ç®€ä½“çš„</p>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.3p7erwis5we0.jpg\" alt=\"image\" /></p>\n<h1 id=\"ç¬¬äºŒæ­¥-è¿›å…¥-è¯­è¨€ä¸åŒºåŸŸ-ç•Œé¢\"><a class=\"anchor\" href=\"#ç¬¬äºŒæ­¥-è¿›å…¥-è¯­è¨€ä¸åŒºåŸŸ-ç•Œé¢\">#</a> ç¬¬äºŒæ­¥ï¼šè¿›å…¥ è¯­è¨€ä¸åŒºåŸŸ ç•Œé¢</h1>\n<p>å…ˆè¿›å…¥è¿™ä¸ªç•Œé¢<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.46fqesz4laa0.jpg\" alt=\"image\" /></p>\n<p>è¿›å…¥ç•Œé¢åå…ˆç‚¹å‡» <strong>ä¸­æ–‡ (ç®€ä½“ï¼Œä¸­å›½)</strong> æœ€å³ä¾§çš„ä¸‰ä¸ªç‚¹ï¼Œç„¶åé€‰æ‹© <strong>è¯­è¨€é€‰é¡¹</strong></p>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.2zvxg5ln1yk0.jpg\" alt=\"image\" /></p>\n<h1 id=\"ç¬¬ä¸‰æ­¥-è¿›å…¥-å¾®è½¯æ‹¼éŸ³-ç•Œé¢\"><a class=\"anchor\" href=\"#ç¬¬ä¸‰æ­¥-è¿›å…¥-å¾®è½¯æ‹¼éŸ³-ç•Œé¢\">#</a> ç¬¬ä¸‰æ­¥ï¼šè¿›å…¥ å¾®è½¯æ‹¼éŸ³ ç•Œé¢</h1>\n<p>æ‰¾åˆ° <strong>å¾®è½¯</strong> æ‹¼éŸ³é€‰é¡¹ç‚¹å‡»ä¸‰ä¸ªç‚¹ï¼Œç„¶åé€‰æ‹©<strong>é”®ç›˜é€‰é¡¹</strong></p>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.4ilwcer93jw0.jpg\" alt=\"image\" /></p>\n<h1 id=\"ç¬¬å››æ­¥-è¿›å…¥-æŒ‰é”®-ç•Œé¢\"><a class=\"anchor\" href=\"#ç¬¬å››æ­¥-è¿›å…¥-æŒ‰é”®-ç•Œé¢\">#</a> ç¬¬å››æ­¥ï¼šè¿›å…¥ æŒ‰é”® ç•Œé¢</h1>\n<p>ç‚¹å‡»æŒ‰é”®é€‰é¡¹ï¼Œè½¬è·³åˆ°æŒ‰é”®ç•Œé¢<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.5uq2s32lhkg0.jpg\" alt=\"image\" /></p>\n<h1 id=\"ç¬¬äº”æ­¥-å…³é—­çƒ­é”®\"><a class=\"anchor\" href=\"#ç¬¬äº”æ­¥-å…³é—­çƒ­é”®\">#</a> ç¬¬äº”æ­¥ï¼šå…³é—­çƒ­é”®</h1>\n<p>æ‰¾åˆ°çƒ­é”®ï¼Œé€‰æ‹©å…³é—­å³å¯ï¼Œå¦‚æœæœ‰éœ€è¦å¯ä»¥è‡ªè¡Œè®¾ç½®çƒ­é”®</p>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.4hedl2see1i0.jpg\" alt=\"image\" /></p>\n<hr />\n<p>å¤§é“äº”åï¼Œå¤©è¡å››åä¹ï¼Œäººéå…¶ä¸€ï¼</p>\n",
            "tags": [
                "win11",
                "Question"
            ]
        },
        {
            "id": "https://to-ywz.github.io/Embedded/DSP/TMS320F28379D%E5%AD%A6%E4%B9%A0-%E6%97%B6%E9%92%9F/",
            "url": "https://to-ywz.github.io/Embedded/DSP/TMS320F28379D%E5%AD%A6%E4%B9%A0-%E6%97%B6%E9%92%9F/",
            "title": "TMS320F28379Då­¦ä¹ -æ—¶é’Ÿ",
            "date_published": "2023-01-15T12:47:39.000Z",
            "content_html": "<p>è™½ç„¶ 28379D æœ‰ä¸¤ä¸ªæ ¸ï¼Œä½†å·¥ä½œæ—¶é’Ÿçš„é…ç½®æ–¹æ³•è¿˜æ˜¯ä¸€è‡´çš„ï¼Œæ‰€ä»¥å¯ä»¥ä»å•æ ¸çš„è§’åº¦æ¥å­¦ä¹ æ—¶é’Ÿé…ç½®çš„æ–¹æ³•</p>\n<h1 id=\"æ—¶é’Ÿæ¡†å›¾\"><a class=\"anchor\" href=\"#æ—¶é’Ÿæ¡†å›¾\">#</a> æ—¶é’Ÿæ¡†å›¾</h1>\n<p>æ— è®ºä»€ä¹ˆå¤–è®¾éƒ½ç¦»ä¸å¼€åŠŸèƒ½æ¡†å›¾ï¼Œæ‰€ä»¥è¿˜æ˜¯å…ˆä»åŠŸèƒ½æ¡†å›¾å…¥æ‰‹åˆ†ææ—¶é’Ÿé…ç½®çš„åŸºæœ¬ä¿¡æ¯</p>\n<p><img data-src=\"https://i.loli.net/2021/10/26/4zBDCj3R5gtWqw2.png\" alt=\"complete\" /></p>\n<h2 id=\"æ—¶é’Ÿæºéƒ¨åˆ†\"><a class=\"anchor\" href=\"#æ—¶é’Ÿæºéƒ¨åˆ†\">#</a> æ—¶é’Ÿæºéƒ¨åˆ†</h2>\n<p><img data-src=\"https://i.loli.net/2021/10/26/QA5NatRko9GxDWF.png\" alt=\"Timer_source\" /></p>\n<p>TMS320F28379D æœ‰ä¸‰ä¸ªæ—¶é’Ÿæºï¼Œä¸¤ä¸ªå†…éƒ¨æ—¶é’Ÿæºå’Œä¸€ä¸ªå†…éƒ¨æ—¶é’Ÿæºï¼Œé€šè¿‡ CLKSRCCTL1 æ¥é€‰æ‹©æ—¶é’Ÿæº</p>\n<p><code>INTOSC2</code>  æ˜¯é»˜è®¤çš„ 10M å†…éƒ¨æ™¶æŒ¯ï¼Œä½†æ˜¯å®¹å·®å¤ªå·®ï¼Œå¦‚æœè¦ä½¿ç”¨ USB æˆ–è€… CAN å¤–è®¾åˆ™éœ€è¦ä½¿ç”¨å¤–éƒ¨æ™¶æŒ¯</p>\n<p><code>INTOSC1</code>  æ˜¯å¤‡ç”¨çš„ 10M å†…éƒ¨æ™¶æŒ¯ï¼Œä½†æ˜¯åªèƒ½ç”¨äº DCM å’Œçœ‹é—¨ç‹—ã€‚</p>\n<p><code>XTAL</code>  æ˜¯å¤–éƒ¨æ™¶æŒ¯æ¥å£ï¼Œæä¾›ç¨³å®šçš„æ—¶é’Ÿé¢‘ç‡</p>\n<h2 id=\"æŒ¯è¡å™¨å€é¢‘\"><a class=\"anchor\" href=\"#æŒ¯è¡å™¨å€é¢‘\">#</a> æŒ¯è¡å™¨ + å€é¢‘</h2>\n<p><img data-src=\"https://i.loli.net/2021/10/26/Pd9olFHmZ2R4hvu.png\" alt=\"Oscillator\" /></p>\n<p>æ—¶é’Ÿäº§ç”Ÿéœ‡è¡ç¨³å®šåï¼Œé€šè¿‡  <code>SYSPLLCTL1</code>  æ¥é€‰æ‹© æ˜¯é€šè¿‡ PLL å¯¹  <code>OSCCLK</code>  è¿›è¡Œå€é¢‘åè¾“å‡ºï¼Œæˆ–æ˜¯ç›´æ¥è¾“å‡º  <code>OSCCLK</code></p>\n<h2 id=\"åˆ†é¢‘\"><a class=\"anchor\" href=\"#åˆ†é¢‘\">#</a> åˆ†é¢‘</h2>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.5ozsmhngvng0.jpg\" alt=\"image\" /></p>\n<p>è¾“å‡ºçš„æ—¶é’Ÿè¦ç»è¿‡åˆ†é¢‘å™¨å°†ä¸»é¢‘é™ä½åˆ°æƒ³è¦çš„é¢‘ç‡ï¼Œç„¶ååˆ†åˆ«ä¼ è¾“ç»™ CPU å’Œ å¤–è®¾</p>\n<h1 id=\"å¯„å­˜å™¨\"><a class=\"anchor\" href=\"#å¯„å­˜å™¨\">#</a> å¯„å­˜å™¨</h1>\n<p>æ—¶é’Ÿçš„å†…å®¹åœ¨ç¬¬ä¸‰ç« çš„ç¬¬ 7 èŠ‚ï¼Œä½†å¯„å­˜å™¨å†…å®¹åœ¨ç¬¬ä¸‰ç« çš„æœ«å°¾<br />\nè¿™ä¸€å¼ æ¶‰åŠçš„åŠŸèƒ½é…ç½®æ¯”è¾ƒå¤šï¼Œæ‰€ä»¥å¯„å­˜å™¨ç« èŠ‚çš„å†…å®¹ä¹Ÿæ¯”è¾ƒæ‚<br />\næˆ‘è¿™é‡Œåªè°ƒç”¨åˆ°çš„å¯„å­˜å™¨æ¥è®²<br />\n PS: è¯´å®è¯ï¼ŒTI åœ¨æ—¶é’Ÿå¯„å­˜å™¨ä¸Šå¸¸å¸¸ æ ‡å¿—ä½å’Œæ§åˆ¶ä½ æ··åœ¨ä¸€å—ï¼Œçœ‹çš„å¤´å¤§</p>\n<h2 id=\"clksrcctl1\"><a class=\"anchor\" href=\"#clksrcctl1\">#</a> CLKSRCCTL1</h2>\n<p>ç”¨äºé€‰æ‹©å’Œå¼€å¯æ—¶é’Ÿæºï¼Œä»¥åŠ CPU1 çœ‹é—¨ç‹—çš„å·¥ä½œçŠ¶æ€</p>\n<table>\n<thead>\n<tr>\n<th>åç§°</th>\n<th>åŠŸèƒ½</th>\n<th>æ³¨è§£</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>OSCCLKSRCSEL</code></td>\n<td>é€‰æ‹©  <code>OSCCLK</code>  çš„æ—¶é’Ÿæº</td>\n<td>00:Â INTOSC2&lt;br /&gt;01:Â XTAL&lt;br /&gt;10:Â INTOSC1</td>\n</tr>\n<tr>\n<td><code>INTOSC2OFF</code></td>\n<td>æ§åˆ¶ <code>INTOSC2</code>  æ˜¯å¦å¼€å¯</td>\n<td>0: å¼€å¯ &lt;br /&gt;1: å…³é—­</td>\n</tr>\n<tr>\n<td><code>XTALOFF</code></td>\n<td>æ§åˆ¶  <code>XTAL</code>  æ˜¯å¦å¼€å¯</td>\n<td>0: å¼€å¯ &lt;br /&gt;1: å…³é—­</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"syspllctl1\"><a class=\"anchor\" href=\"#syspllctl1\">#</a> SYSPLLCTL1</h2>\n<table>\n<thead>\n<tr>\n<th>åç§°</th>\n<th>åŠŸèƒ½</th>\n<th>æ³¨è§£</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>PLLEN</code></td>\n<td>æ§åˆ¶ PLL æ˜¯å¦å¼€å¯</td>\n<td>0: å¼€å¯ &lt;br /&gt;1: å…³é—­ &lt;br /&gt; é»˜è®¤ä¸º 0</td>\n</tr>\n<tr>\n<td><code>PLLCLKEN</code></td>\n<td>æ§åˆ¶æ˜¯å¦ç»è¿‡ <code>PLL</code></td>\n<td>0: PLL å€é¢‘è¾“å‡º &lt;br /&gt; 1: PLL æ—è·¯</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"syspllmult\"><a class=\"anchor\" href=\"#syspllmult\">#</a> SYSPLLMULT</h2>\n<table>\n<thead>\n<tr>\n<th>åç§°</th>\n<th>åŠŸèƒ½</th>\n<th>æ³¨è§£</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>IMULT</code></td>\n<td><code>PLL</code>  å€é¢‘å‚æ•°çš„æ•´æ•°éƒ¨åˆ†</td>\n<td>1~127</td>\n</tr>\n<tr>\n<td><code>FMULT</code></td>\n<td><code>PLL</code>  å€é¢‘å‚æ•°çš„å°é¼ éƒ¨åˆ†</td>\n<td>00: 0&lt;br /&gt;01: 0.25&lt;br /&gt;10: 0.5&lt;br /&gt;11: 0.75&lt;br /&gt;</td>\n</tr>\n</tbody>\n</table>\n<p>PS: å€é¢‘å‚æ•°ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msub><mi>I</mi><mrow><mi>M</mi><mi>U</mi><mi>L</mi><mi>T</mi></mrow></msub><mo>+</mo><msub><mi>F</mi><mrow><mi>M</mi><mi>U</mi><mi>L</mi><mi>T</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(I_{MULT}+F_{MULT})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">M</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">U</span><span class=\"mord mathnormal mtight\">L</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">M</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">U</span><span class=\"mord mathnormal mtight\">L</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></p>\n<h2 id=\"sysclkdivsel\"><a class=\"anchor\" href=\"#sysclkdivsel\">#</a> SYSCLKDIVSEL</h2>\n<table>\n<thead>\n<tr>\n<th>åç§°</th>\n<th>åŠŸèƒ½</th>\n<th>æ³¨è§£</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>LLSYSCLKDIV</code></td>\n<td><code>PLL</code>  åˆ†é¢‘å‚æ•°çš„æ•´æ•°éƒ¨åˆ†</td>\n<td>2 çš„å€æ•°ï¼Œä»  <code>/1</code>  åˆ°  <code>/126</code></td>\n</tr>\n</tbody>\n</table>\n<h1 id=\"pllå·¥ä½œæ¨¡å¼\"><a class=\"anchor\" href=\"#pllå·¥ä½œæ¨¡å¼\">#</a> PLL å·¥ä½œæ¨¡å¼</h1>\n<p>è¿›è¡Œå®ä¾‹è¯´æ˜ä¹‹å‰å…ˆç§‘æ™®ä¸€ä¸‹ PLL çš„ä¸‰ç§å·¥ä½œæ¨¡å¼ï¼šå…³é—­ã€æ—è·¯ã€ä½¿èƒ½</p>\n<table>\n<thead>\n<tr>\n<th>åŠŸèƒ½</th>\n<th>è¯´æ˜</th>\n<th>é…ç½®</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>å…³é—­</td>\n<td>æ—¶é’Ÿç›´æ¥ä¼ å…¥  <code>OSCCLK</code>  å¯ä»¥å‡å°‘ç³»ç»Ÿå™ªå£°å’ŒåŠŸè€—.</td>\n<td><code>SYSPLLCTL1.PLLEN = 0;</code></td>\n</tr>\n<tr>\n<td>æ—è·¯</td>\n<td>ä¸Šç”µå¤ä½æˆ–å¤ä½åï¼Œ <code>PLL</code>  ä¼šè¿›å…¥è¯¥æ¨¡å¼.&lt;br /&gt; æ—¶é’Ÿä¿¡å·ä¸ç»è¿‡  <code>PLL</code>  è€Œæ˜¯ä»  <code>PLL</code>  è¾¹ä¸Šç»•å¼€ï¼Œä½†  <code>PLL</code>  å¤„äºå·¥ä½œçŠ¶æ€</td>\n<td><code>SYSPLLCTL1.PLLEN = 1;</code> &lt;br /&gt; <code>SYSPLLCTL. PLLCLKEN = 0;</code></td>\n</tr>\n<tr>\n<td>ä½¿èƒ½</td>\n<td><code>PLL</code>  å¤„äºä½¿èƒ½çŠ¶æ€ï¼Œæ—¶é’Ÿä¿¡å·å€é¢‘åè¾“å…¥åˆ°  <code>OSCCLK</code>  ä¸­</td>\n<td><code>SYSPLLCTL1.PLLEN = 1;</code>   <code>SYSPLLCTL. PLLCLKEN = 1;</code></td>\n</tr>\n</tbody>\n</table>\n<h1 id=\"æ—¶é’Ÿé…ç½®\"><a class=\"anchor\" href=\"#æ—¶é’Ÿé…ç½®\">#</a> æ—¶é’Ÿé…ç½®</h1>\n<h2 id=\"æ–‡æ¡£é…ç½®æ–¹æ³•\"><a class=\"anchor\" href=\"#æ–‡æ¡£é…ç½®æ–¹æ³•\">#</a> æ–‡æ¡£é…ç½®æ–¹æ³•</h2>\n<p>åœ¨æ–‡æ¡£ 3.7.6.2 å¤„å¯çŸ¥ï¼Œå…·ä½“çš„æ—¶é’Ÿé…ç½®æ–¹æ³•ï¼Œå¤§è‡´æ„æ€å¦‚ä¸‹</p>\n<ol>\n<li>é€‰æ‹©æ—¶é’Ÿæºï¼Œå°†å¯¹åº”å€¼å†™å…¥  <code>CLKSRCCTL1.OSCCLKSRCSEL</code></li>\n<li>æ¸…é™¤  <code>SYSPLLCTL1.PLLCLKEN</code> , å°†æ—¶é’Ÿæºåˆ‡æ¢ä¸ºæ—è·¯</li>\n<li>é€šè¿‡æ¸…é™¤  <code>SYSCLKDIVSEL[ PLLSYSCLKDIV]</code>  çš„å€¼ï¼Œå°† æ—¶é’Ÿåˆ†é¢‘è®¾ç½®ä¸º  <code>\\1</code>  , ä¿è¯ PLL æœ€å¿«çš„è¢«é…ç½®</li>\n<li>åŒæ—¶å°†ç§¯åˆ†ä¹˜æ³•å™¨å’Œåˆ†æ•°ä¹˜æ³•å™¨å†™å…¥ SYSPLLMULT, å°±å¯ä»¥è‡ªåŠ¨ä½¿èƒ½ PLL (å€é¢‘åï¼Œéœ€è¦ä¿éšœä¸»é¢‘åœ¨é¢å®šå·¥ä½œèŒƒå›´å†…)</li>\n<li>è‡³å°‘é”å®š PLL äº”æ¬¡ï¼Œæ¬¡æ•°è¶Šå¤šæˆåŠŸæ¦‚ç‡è¶Šé«˜ï¼Œå½“ç„¶æœ€å¥½æ”¾ä¸€ä¸ªçœ‹é—¨ç‹—ï¼Œé˜²æ­¢ä¸€ç›´å°è¯•</li>\n<li>å°†åˆ†é¢‘å™¨çš„åˆ†é¢‘æ•°å€¼ é…ç½®ä¸º æ¯”ç›®æ ‡å€¼å¤§ä¸€æ¡£ï¼Œä¾¿äº PLL æ¨¡å—å¿«é€Ÿæ‰“åˆ°ç›®æ ‡å€¼</li>\n<li>ä¿è¯  <code>SCRS.WDOVERRIDE</code>  åœ¨ PLL é”å®šä¹‹åæ¸…é™¤</li>\n<li><code>SYSDBGCTL.BIT_0</code>  ç½®ä½ï¼Œè¿™é‡Œå¯ä»¥æ£€æµ‹åˆ° PLL å¯åŠ¨çš„é”™è¯¯</li>\n<li>é€šè¿‡ç½®ä½  <code>SYSPLLCTL1.PLLCLKEN</code> , å°† PLL ä½œä¸ºç³»ç»Ÿæ—¶é’Ÿ</li>\n<li>æ¸…é™¤  <code>SYSDBGCTL.BIT_0</code></li>\n<li>å°†åˆ†é…å™¨ä¸­çš„æ•°å€¼ï¼Œä¿®æ”¹ä¸ºç›®æ ‡æ•°å€¼</li>\n<li>é‡æ–°ä¸ºåº”ç”¨é…ç½®å¯¹åº”çš„ çœ‹é—¨ç‹—</li>\n</ol>\n<h2 id=\"æ€è·¯\"><a class=\"anchor\" href=\"#æ€è·¯\">#</a> æ€è·¯</h2>\n<p>PS: è¿™é‡Œä»¥ ä½¿ç”¨ 10M çš„å¤–éƒ¨æ™¶æŒ¯ç”Ÿæˆ 100M çš„ç³»ç»Ÿæ—¶é’Ÿä¸ºä¾‹</p>\n<p>ä»æ–‡æ¡£ä¸­å¯ä»¥çœ‹å‡º æ—¶é’Ÿé…ç½®çš„æ ¸å¿ƒæ­¥éª¤ä¸º:</p>\n<ol>\n<li>é€‰æ‹©æ—¶é’Ÿæº</li>\n<li>é€‰æ‹© PLL å·¥ä½œæ¨¡å¼</li>\n<li>è®¾å®š PLL å‚æ•°</li>\n<li>è®¾å®š åˆ†é¢‘å™¨ å‚æ•°</li>\n</ol>\n<p>é‚£ä¹ˆä»å¯„å­˜å™¨è¡¨ä¸­å¯çŸ¥ä¼šæ¶‰åŠåˆ°ä»¥ä¸‹å¯„å­˜å™¨çš„æ“ä½œ</p>\n<ol>\n<li><code>ClkCfgRegs.CLKSRCCTL1.bit.OSCCLKSRCSEL = 0x1;  // å¤–éƒ¨æ™¶æŒ¯</code></li>\n<li><code>ClkCfgRegs.SYSCLKDIVSEL.bit.PLLEN = 0x00;// å¼€å¯PLL</code> <br />\n <code>ClkCfgRegs.SYSCLKDIVSEL.bit.PLLCLKEN = 0x00;// PLL ä½¿èƒ½æ¨¡å¼</code></li>\n<li><code>ClkCfgRegs.SYSPLLMULT.bit.IMULT = 0x0A;         // 10å€é¢‘</code> <br />\n <code>ClkCfgRegs.SYSPLLMULT.bit.FMULT = 0x00;         // ä¸ä½¿ç”¨å°æ•°</code></li>\n<li><code>ClkCfgRegs.SYSCLKDIVSEL.bit.PLLSYSCLKDIV = 0x00;// ä¸åˆ†é¢‘</code></li>\n</ol>\n<p>æŒ‰ç…§æ€è·¯æ¥å®ç°ä»£ç ï¼Œå¯¹åº”çš„å¯„å­˜å™¨åœ¨ç¬¬ä¸‰ç« çš„æœ€åä¸€èŠ‚ä¸­å¯ä»¥æŸ¥æ‰¾<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.71qbphuqbdk0.jpg\" alt=\"image\" /></p>\n<p>è¿™é‡Œç”¨ç”µå¹³ç¿»è½¬æ¥å®ç° å’Œ è®¡æ•° 100 æ¬¡æ¥ä½œä¸ºè¡¡é‡æ—¶é—´çš„æ ‡å‡†<br />\nè™½ç„¶æœ‰äº›ä¸é è°±ï¼Œä½†æ˜¯ç”±äºæ²¡æœ‰å­¦ ePWM çš„é…ç½®åªèƒ½å…ˆå°†å°±ä¸€ä¸‹ï¼Œç­‰ä»¥åå­¦å®Œä¹‹åå†æ¥æ›´æ–°</p>\n<p>å‡½æ•°åº“ç‰ˆæœ¬çš„ æ—¶é’Ÿåˆå§‹åŒ–å‡½æ•°æœ‰ä¸¤ä¸ªï¼Œåˆ†ä¸ºä¸åŒçš„åº“æ–‡ä»¶ï¼Œå¯ä»¥æŒ‰éœ€é€‰æ‹©<br />\n <code>SysCtl_setClock(DEVICE_SETCLOCK_CFG);</code> <br />\n <code>InitSysPll(XTAL_OSC,IMULT_40,FMULT_0,PLLCLK_BY_2);</code> <br />\n ç¬¬ä¸€ä¸ªå‡½æ•°éœ€è¦ <code>driverlib</code>  åº“çš„æ”¯æŒ<br />\nç¬¬äºŒä¸ªå‡½æ•°éœ€è¦ <code>device_support</code>  åº“çš„æ”¯æŒ<br />\nç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå°†æ‰€æœ‰å·¥ä½œæ¨¡å¼è®¾ç½®äº†ä¸€ä¸ªä½ï¼Œå‡½æ•° å¯¹åº”æ©ç æŒ‰ä½ &amp; æ¥ç¡®å®šæ˜¯å¦éœ€è¦å¼€å¯å½“å‰æ¨¡å¼<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.6u69ov30ojg0.jpg\" alt=\"image\" /><br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.2q8cn5h0u9g0.jpg\" alt=\"image\" /><br />\n ç›¸å¯¹è€Œè¨€ç¬¬äºŒä¸ªå‡½æ•°çš„å‚æ•°è¦æ›´åŠ å®¹æ˜“ç†è§£ä¸€äº›ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä½¿ç”¨çš„æ—¶é’Ÿæºï¼Œç¬¬äºŒä¸ª <code>PLL</code>  çš„å€é¢‘å‚æ•°ï¼Œç¬¬ä¸‰ä¸ªåˆ†é¢‘å™¨çš„ åˆ†é¢‘å‚æ•°</p>\n<h2 id=\"ä»£ç å®ç°\"><a class=\"anchor\" href=\"#ä»£ç å®ç°\">#</a> ä»£ç å®ç°</h2>\n<h3 id=\"å¯„å­˜å™¨å®ç°\"><a class=\"anchor\" href=\"#å¯„å­˜å™¨å®ç°\">#</a> å¯„å­˜å™¨å®ç°</h3>\n<p>100M ä¸»é¢‘</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"F28x_Project.h\"</span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"driverlib.h\"</span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"device.h\"</span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">randomDelay</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">sysclk_cfg</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">gpio_cfg</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\">//</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\">// Main</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\">//</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token function\">sysclk_cfg</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token function\">gpio_cfg</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        GpioDataRegs<span class=\"token punctuation\">.</span>GPATOGGLE<span class=\"token punctuation\">.</span>bit<span class=\"token punctuation\">.</span>GPIO25 <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token function\">randomDelay</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"25\"></td><td><pre> * @b GPIO åˆå§‹åŒ– 25pin è¾“å‡º</pre></td></tr><tr><td data-num=\"26\"></td><td><pre> */</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">gpio_cfg</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    EALLOW<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    GpioDataRegs<span class=\"token punctuation\">.</span>GPASET<span class=\"token punctuation\">.</span>bit<span class=\"token punctuation\">.</span>GPIO25 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    GpioCtrlRegs<span class=\"token punctuation\">.</span>GPAMUX2<span class=\"token punctuation\">.</span>bit<span class=\"token punctuation\">.</span>GPIO25 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    GpioCtrlRegs<span class=\"token punctuation\">.</span>GPADIR<span class=\"token punctuation\">.</span>bit<span class=\"token punctuation\">.</span>GPIO25 <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    GpioCtrlRegs<span class=\"token punctuation\">.</span>GPAODR<span class=\"token punctuation\">.</span>bit<span class=\"token punctuation\">.</span>GPIO25 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    EDIS<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"38\"></td><td><pre> * @b éšæœºå»¶æ—¶æµ‹è¯•å‡½æ•°</pre></td></tr><tr><td data-num=\"39\"></td><td><pre> */</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">randomDelay</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    Uint32 i <span class=\"token operator\">=</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>        i<span class=\"token operator\">--</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre></pre></td></tr><tr><td data-num=\"50\"></td><td><pre><span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"51\"></td><td><pre> * @b æ—¶é’Ÿåˆå§‹åŒ–</pre></td></tr><tr><td data-num=\"52\"></td><td><pre> */</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">sysclk_cfg</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>    EALLOW<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>    <span class=\"token comment\">// 10M * 10 / 1</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>    ClkCfgRegs<span class=\"token punctuation\">.</span>CLKSRCCTL1<span class=\"token punctuation\">.</span>bit<span class=\"token punctuation\">.</span>OSCCLKSRCSEL <span class=\"token operator\">=</span> <span class=\"token number\">0x1</span><span class=\"token punctuation\">;</span>   <span class=\"token comment\">// å¤–éƒ¨æ™¶æŒ¯</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>    ClkCfgRegs<span class=\"token punctuation\">.</span>SYSPLLMULT<span class=\"token punctuation\">.</span>bit<span class=\"token punctuation\">.</span>IMULT <span class=\"token operator\">=</span> <span class=\"token number\">0x0a</span><span class=\"token punctuation\">;</span>         <span class=\"token comment\">// 10 å€é¢‘</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>    ClkCfgRegs<span class=\"token punctuation\">.</span>SYSPLLMULT<span class=\"token punctuation\">.</span>bit<span class=\"token punctuation\">.</span>FMULT <span class=\"token operator\">=</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">;</span>         <span class=\"token comment\">// ä¸ä½¿ç”¨å°æ•°</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>    ClkCfgRegs<span class=\"token punctuation\">.</span>SYSCLKDIVSEL<span class=\"token punctuation\">.</span>bit<span class=\"token punctuation\">.</span>PLLSYSCLKDIV <span class=\"token operator\">=</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">;</span>         <span class=\"token comment\">// ä¸åˆ†é¢‘</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>    EDIS<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.3v27ziqdrpk0.jpg\" alt=\"image\" /></p>\n<h3 id=\"å‡½æ•°åº“å®ç°\"><a class=\"anchor\" href=\"#å‡½æ•°åº“å®ç°\">#</a> å‡½æ•°åº“å®ç°</h3>\n<p>å†ç”Ÿæˆä¸€ä¸ª 200M çš„ç³»ç»Ÿæ—¶é’Ÿ</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"F28x_Project.h\"</span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"driverlib.h\"</span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"device.h\"</span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">randomDelay</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">sysclk_cfg</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">gpio_cfg</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\">//</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\">// Main</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\">//</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token comment\">// äºŒé€‰ä¸€å³å¯ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ¯”è¾ƒä¸å®¹æ˜“ç†è§£ï¼Œç¬¬äºŒå‚æ•°å®¹æ˜“ç†è§£</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token function\">SysCtl_setClock</span><span class=\"token punctuation\">(</span>DEVICE_SETCLOCK_CFG<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\">//    InitSysPll(XTAL_OSC,IMULT_40,FMULT_0,PLLCLK_BY_2);</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token function\">gpio_cfg</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        GpioDataRegs<span class=\"token punctuation\">.</span>GPATOGGLE<span class=\"token punctuation\">.</span>bit<span class=\"token punctuation\">.</span>GPIO25 <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token function\">randomDelay</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"26\"></td><td><pre> * @b GPIO åˆå§‹åŒ– 25pin è¾“å‡º</pre></td></tr><tr><td data-num=\"27\"></td><td><pre> */</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">gpio_cfg</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    EALLOW<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    GpioDataRegs<span class=\"token punctuation\">.</span>GPASET<span class=\"token punctuation\">.</span>bit<span class=\"token punctuation\">.</span>GPIO25 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    GpioCtrlRegs<span class=\"token punctuation\">.</span>GPAMUX2<span class=\"token punctuation\">.</span>bit<span class=\"token punctuation\">.</span>GPIO25 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    GpioCtrlRegs<span class=\"token punctuation\">.</span>GPADIR<span class=\"token punctuation\">.</span>bit<span class=\"token punctuation\">.</span>GPIO25 <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    GpioCtrlRegs<span class=\"token punctuation\">.</span>GPAODR<span class=\"token punctuation\">.</span>bit<span class=\"token punctuation\">.</span>GPIO25 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    EDIS<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre></pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"39\"></td><td><pre> * @b éšæœºå»¶æ—¶æµ‹è¯•å‡½æ•°</pre></td></tr><tr><td data-num=\"40\"></td><td><pre> */</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">randomDelay</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    Uint32 i <span class=\"token operator\">=</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>        i<span class=\"token operator\">--</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>æµ‹è¯•æ•ˆæœå¦‚å›¾</p>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/1674374649290.66111iy769s0.jpg\" alt=\"1674374649290\" /></p>\n<p>-------2023 å¹´ 1 æœˆ 23 æ—¥ -------</p>\n<h1 id=\"ä½¿ç”¨lunchpadçš„æ³¨æ„äº‹é¡¹\"><a class=\"anchor\" href=\"#ä½¿ç”¨lunchpadçš„æ³¨æ„äº‹é¡¹\">#</a> ä½¿ç”¨ LunchPad çš„æ³¨æ„äº‹é¡¹</h1>\n<p>æœ€å¼€å§‹çš„æ—¶å€™ä¸çŸ¥é“ä¸ºä»€ä¹ˆ C2000Ware çš„ä¾‹å­è¿è¡Œåœ¨ LunchPad ä¸Š é¢‘ç‡æ€»æ„Ÿè§‰ä¸å¯¹ï¼Œ å¥½åƒæ˜¯æ˜¯ä¸€åŠçš„æ„Ÿè§‰ã€‚ åæ¥è¿›åˆ°  <code>Device_init()</code>  å’Œ  <code>InitSysCtrl()</code>  ä¸¤ä¸ªå‡½æ•° é»˜è®¤ä½¿ç”¨å¤–éƒ¨æ™¶æŒ¯ï¼Œè€Œä¸”ç¨‹åºé»˜è®¤å¤–éƒ¨æ™¶æŒ¯æ˜¯  <code>20MHz</code>  çš„ï¼Œæ‰€ä»¥å¯¼è‡´é¢‘ç‡ä¸ºåŸæœ¬çš„ä¸€åŠã€‚</p>\n<p>ä¸¤ä¸ªå‡½æ•°çš„å‡½æ•°çš„æ—¶é’Ÿé…ç½®æ˜¯åœ¨  <code>SysCtl_setClock()</code>  å’Œ  <code>InitSysPll()</code></p>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.2kkj3spidpk0.jpg\" alt=\"image\" /></p>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.21rvwcj4excw.jpg\" alt=\"image\" /></p>\n<p>å›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼Œéœ€è¦å®šä¹‰ä¸€ä¸ª  <code>_LAUNCH_F28379D</code>  çš„å®ï¼Œæ‰€ä»¥éœ€è¦åœ¨  <code>properties</code>  ä¸­å»é…ç½®ï¼Œè¿›å»ååœ¨  <code>C2000 Compiler &gt;&gt; Build &gt;&gt; predefined symbols</code>  ä¸­æ·»åŠ å®å®šä¹‰</p>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.5u8cqeg1sxs0.jpg\" alt=\"image\" /></p>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.684cqoftduk0.jpg\" alt=\"image\" /></p>\n<p>æœ€å¼€å§‹çš„æ—¶å€™ä¸çŸ¥é“ä¸ºä»€ä¹ˆ C2000Ware çš„ä¾‹å­è¿è¡Œåœ¨ LunchPad ä¸Š é¢‘ç‡æ€»æ„Ÿè§‰ä¸å¯¹ï¼Œ å¥½åƒæ˜¯æ˜¯ä¸€åŠçš„æ„Ÿè§‰ã€‚ åæ¥è¿›åˆ°  <code>Device_init()</code>  å’Œ  <code>InitSysCtrl()</code>  ä¸¤ä¸ªå‡½æ•° é»˜è®¤ä½¿ç”¨å¤–éƒ¨æ™¶æŒ¯ï¼Œè€Œä¸”ç¨‹åºé»˜è®¤å¤–éƒ¨æ™¶æŒ¯æ˜¯  <code>20MHz</code>  çš„ï¼Œæ‰€ä»¥å¯¼è‡´é¢‘ç‡ä¸ºåŸæœ¬çš„ä¸€åŠã€‚</p>\n<p>ä¸¤ä¸ªå‡½æ•°çš„å‡½æ•°çš„æ—¶é’Ÿé…ç½®æ˜¯åœ¨  <code>SysCtl_setClock()</code>  å’Œ  <code>InitSysPll()</code></p>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.2kkj3spidpk0.jpg\" alt=\"image\" /></p>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.21rvwcj4excw.jpg\" alt=\"image\" /></p>\n<p>å›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼Œéœ€è¦å®šä¹‰ä¸€ä¸ª  <code>_LAUNCH_F28379D</code>  çš„å®ï¼Œæ‰€ä»¥éœ€è¦åœ¨  <code>properties</code>  ä¸­å»é…ç½®ï¼Œè¿›å»ååœ¨  <code>C2000 Compiler &gt;&gt; Build &gt;&gt; predefined symbols</code>  ä¸­æ·»åŠ å®å®šä¹‰</p>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.5u8cqeg1sxs0.jpg\" alt=\"image\" /></p>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/1674299279513.6pgt966tdtc0.jpg\" alt=\"1674299279513\" /></p>\n<p>ç›®å‰åªå­¦æœ€ç®€å•çš„æ—¶é’Ÿé…ç½®ï¼Œå¯¹åº”çš„çš„å¼‚å¸¸å¤„ç†ï¼Œä»¥åŠå¤–è®¾æ—¶é’Ÿï¼Œå®šæ—¶å™¨ï¼ŒePWM é…ç½®è¿˜æœªæ¥å¾—æ€¥æ¶‰è¶³<br />\nç­‰ä»¥åå­¦å®Œåœ¨æ¥å®Œå–„è¿™ç¯‡æ–‡ç« </p>\n<p>å¦‚æœ‰é”™è¯¯ä¹‹å¤„ï¼Œæœ›å¤§ä½¬æ–§æ­£</p>\n<hr />\n<p>å¤§é“äº”åï¼Œå¤©è¡å››åä¹ï¼Œäººéå…¶ä¸€ï¼</p>\n",
            "tags": [
                "åµŒå…¥å¼",
                "DSP",
                "DSP"
            ]
        },
        {
            "id": "https://to-ywz.github.io/Embedded/DSP/TMS320F28379D%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85-GPIO%E8%BE%93%E5%85%A5/",
            "url": "https://to-ywz.github.io/Embedded/DSP/TMS320F28379D%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85-GPIO%E8%BE%93%E5%85%A5/",
            "title": "TMS320F28379Då­¦ä¹ ä¹‹æ—…-GPIOè¾“å…¥",
            "date_published": "2023-01-08T12:47:39.000Z",
            "content_html": "<h3 id=\"è¯´æ˜\"><a class=\"anchor\" href=\"#è¯´æ˜\">#</a> è¯´æ˜</h3>\n<p>æœ¬æ–‡ç¡¬ä»¶åŸºäº<em> LaunchXL-F28379D</em> å’Œ é€»è¾‘åˆ†æä»ªï¼Œè½¯ä»¶åŸºäº CCS 10.4 ç‰ˆæœ¬ï¼Œ å¸®åŠ©æ–‡æ¡£ä¸º C2000 çš„ä¾‹ç¨‹å’Œ<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cudGkuY29tL2xpdC91Zy9zcHJ1aG04aS9zcHJ1aG04aS5wZGY/dHM9MTY3Mjk3MzMwMzA0NSZhbXA7cmVmX3VybD1odHRwcyUyNTNBJTI1MkYlMjUyRnd3dy50aS5jb20lMjUyRnByb2R1Y3QlMjUyRlRNUzMyMEYyODM3OUQ=\">å®˜æ–¹æ–‡æ¡£</span><br />\nå› ä¸º GPIO è¾“å…¥è¯¦ç»†çš„è¯´æ˜äº†å¦‚ä½•æ‰¾å¯„å­˜å™¨å’Œåˆ†ææ–‡æ¡£ï¼Œæ‰€ä»¥è¿™é‡Œå°±ç®€å•çš„å¯¹å¯„å­˜å’Œä¸€äº›ä¸ MCU ä¸åŒçš„åœ°æ–¹è¿›è¡Œç®€å•åˆ†æï¼Œä¸å†é•¿ç¯‡å¤§è®ºçš„åšæ€è·¯åˆ†æ</p>\n<h1 id=\"é€»è¾‘æ¡†å›¾\"><a class=\"anchor\" href=\"#é€»è¾‘æ¡†å›¾\">#</a> é€»è¾‘æ¡†å›¾</h1>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.zih14yh8l6o.webp\" alt=\"image\" /></p>\n<p>è€æ ·å­ï¼Œå…ˆæä¸ŠåŸç†ï¼Œç›¸è¾ƒäº GPIO è¾“å‡ºæ¨¡å¼ï¼Œè¾“å…¥æ¨¡å¼å°±æ›´ä¸ºå¤æ‚ä¸€äº›.</p>\n<p>ä»åŸç†å›¾ä¸­å¯ä»¥å¾—åˆ°ï¼Œè¾“å…¥éœ€è¦é…ç½® GPyPUDã€GPyINVã€GPyCTRL å’Œ GPyQSELn å¯„å­˜å™¨ï¼Œå½“ç„¶è¿˜æœ‰ä¹‹å‰ è¾“å‡ºæ¨¡å¼æ‰€æåŠåˆ°åˆ°çš„å¯„å­˜å™¨ã€‚</p>\n<h1 id=\"å¯„å­˜å™¨\"><a class=\"anchor\" href=\"#å¯„å­˜å™¨\">#</a> å¯„å­˜å™¨</h1>\n<p>æ‰€æœ‰ç›¸å…³çš„å¯„å­˜å™¨è¿˜æ˜¯ä»æ–‡æ¡£çš„å¯„å­˜å™¨è¡¨ä»¥åŠ GPIO ç« èŠ‚çš„è¾“å…¥é…ç½®çš„çš„è¯´æ˜ä¸­åˆ†æå¾—æ¥</p>\n<table>\n<thead>\n<tr>\n<th>å¯„å­˜å™¨</th>\n<th>åŠŸèƒ½</th>\n<th>å¤‡æ³¨</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>GPyINV</td>\n<td>æ˜¯å¦å°†è¾“å…¥åå‘</td>\n<td>ç½® 1ï¼šé…ç½®éé—¨</td>\n</tr>\n<tr>\n<td>GPyQSELn</td>\n<td>é€‰æ‹©è¾“å…¥æ¨¡å¼</td>\n<td>2bit&lt;br /&gt;00ï¼šåŒæ­¥æ¨¡å¼ &lt; br /&gt;01ï¼š3 æ¬¡é‡‡æ · &lt; br /&gt;10ï¼š6 æ¬¡é‡‡æ · &lt; br /&gt;11ï¼šå¼‚æ­¥æ¨¡å¼</td>\n</tr>\n<tr>\n<td>GPyCTRL</td>\n<td>é…ç½®é‡‡æ ·å‘¨æœŸ</td>\n<td>2bit&lt;br /&gt;PPLSCLK å¤šå°‘åˆ†é¢‘ &lt; br /&gt; å…·ä½“æƒ…å†µå‚ç…§æ‰‹å†Œ 970 é¡µ</td>\n</tr>\n<tr>\n<td>GPyPUD</td>\n<td>è®¾ç½®å¼•è„šåˆå§‹ç”µå¹³</td>\n<td>1bit&lt;br /&gt; ç½® 0ï¼šå¼€å¯ä¸Šæ‹‰æ¨¡å¼ &lt; br /&gt; é»˜è®¤ä¸º 1</td>\n</tr>\n</tbody>\n</table>\n<p>æ‰€ä»¥ï¼Œå¦‚æœè¦å°† å¼•è„š 24 é…ç½®ä¸º ä¸Šæ‹‰è¾“å‡ºæ¨¡å¼ï¼Œå°±éœ€è¦å°†ä¸€ä¸‹å‡ æ­¥</p>\n<ol>\n<li>GPAMUXn é…ç½®ä¸º 0,</li>\n<li>GPADIR é…ç½®ä¸º 0</li>\n<li>GPAPUD é…ç½®ä¸º 0</li>\n<li>GPyINV é…ç½®ä¸º 0</li>\n<li>GPyQSELn é…ç½®ä¸º 00</li>\n</ol>\n<p>ä¸è¿‡è¿™é‡Œéœ€è¦æ³¨æ„ä¸€ä¸ªé—®é¢˜</p>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.oet2sv5zoxs.jpg\" alt=\"image\" /></p>\n<p>åœ¨æ–‡æ¡£ä¸­å¯¹ pin çš„ GPIO è¾“å…¥æ¨¡å¼ è¿›è¡Œäº†ç‰¹åˆ«çš„è¯´æ˜ã€‚å½“ å¼•è„š å·¥ä½œåœ¨ GPIO æ¨¡å¼æ—¶ï¼Œå¼‚æ­¥é…ç½®æ— æ•ˆï¼Œä¼šè‡ªåŠ¨è½¬æ¢ä¸º åŒæ­¥é…ç½®</p>\n<p>æˆ‘åœ¨å­¦ä¹ çš„è¿‡ç¨‹ä¸­ï¼Œå‚è€ƒäº†ä¸€äº›åšå®¢ï¼Œä½†æ˜¯ä»–ä»¬éƒ½è®¾ç½®ä¸ºå¼‚æ­¥è¾“å…¥æ¨¡å¼ã€‚ç°åœ¨å¯ä»¥æ˜ç¡®ï¼Œè™½ç„¶ä»–ä»¬å®ç°äº†çœŸæ­£çš„æ•ˆæœï¼Œä½†åœ¨åŸç†å±‚é¢ä¸Šæ˜¯é”™è¯¯çš„</p>\n<h1 id=\"å®éªŒè®¾è®¡\"><a class=\"anchor\" href=\"#å®éªŒè®¾è®¡\">#</a> å®éªŒè®¾è®¡</h1>\n<h2 id=\"ç›®çš„\"><a class=\"anchor\" href=\"#ç›®çš„\">#</a> ç›®çš„</h2>\n<p>å½“ GPIO24 ä¸ºä½ç”µå¹³æ—¶ï¼ŒGPIO25 è¾“å‡ºä½ç”µå¹³ï¼›ä¸ºé«˜ç”µå¹³æ—¶è¾“å‡º 5 ä¸ªæ–¹æ³¢</p>\n<h2 id=\"æ€è·¯\"><a class=\"anchor\" href=\"#æ€è·¯\">#</a> æ€è·¯</h2>\n<p>å°† GPIO24 é…ç½®ä¸ºè¾“å…¥æ¨¡å¼ï¼Œå°† GPIO25 é…ç½®ä¸ºè¾“å‡ºæ¨¡å¼</p>\n<p>ç¼–å†™å‡½æ•°ï¼Œå‚æ•°ä¸ºè¾“å‡ºæ¬¡æ•°</p>\n<p>ä¸»å‡½æ•°æ£€æµ‹  <code>GpioDataReg.GPADAT.bit.GPIO24</code>  ç”µå¹³çŠ¶æ€ï¼Œå½“ä¸ºä½ç”µå¹³æ—¶ï¼ŒGPIO25 è¾“å‡ºä½ç”µå¹³</p>\n<h2 id=\"ä»£ç å®ç°\"><a class=\"anchor\" href=\"#ä»£ç å®ç°\">#</a> ä»£ç å®ç°</h2>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"driverlib.h\"</span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"device.h\"</span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">gpioInputCfg</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">test_function</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint8_t</span> n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">//</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\">// Main</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\">//</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token comment\">// åˆå§‹å¤–è®¾</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token function\">Device_init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token comment\">// åˆå§‹åŒ– å¼•è„š</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token function\">gpioInputCfg</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token function\">test_function</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">GPIO_readPin</span><span class=\"token punctuation\">(</span><span class=\"token number\">24</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span><span class=\"token comment\">// å¼•è„šæ£€æµ‹</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>            <span class=\"token function\">DEVICE_DELAY_US</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span> <span class=\"token operator\">*</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// æ¶ˆæŠ–ï¼ˆæš´åŠ›ï¼‰</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">GPIO_readPin</span><span class=\"token punctuation\">(</span><span class=\"token number\">24</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>            <span class=\"token punctuation\">&#123;</span><span class=\"token comment\">// ç¡®è®¤å¼•è„šæ£€æµ‹</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>                <span class=\"token function\">GPIO_writePin</span><span class=\"token punctuation\">(</span><span class=\"token number\">25</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>   <span class=\"token comment\">// è¾“å‡ºä½ç”µå¹³</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>                <span class=\"token function\">DEVICE_DELAY_US</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000L</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// ç»´æŒ 1ms</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">test_function</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint8_t</span> n<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> n<span class=\"token operator\">*</span><span class=\"token number\">2</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>        <span class=\"token function\">GPIO_togglePin</span><span class=\"token punctuation\">(</span><span class=\"token number\">25</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// ç¿»è½¬ç”µå¹³</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>        <span class=\"token function\">DEVICE_DELAY_US</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre></pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"42\"></td><td><pre> * é…ç½® GPIO24 ä¸º</pre></td></tr><tr><td data-num=\"43\"></td><td><pre> */</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">gpioInputCfg</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    <span class=\"token function\">GPIO_setPinConfig</span><span class=\"token punctuation\">(</span><span class=\"token number\">24</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                              <span class=\"token comment\">// é…ç½®ä¸º GPIO æ¨¡å¼</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    <span class=\"token function\">GPIO_setQualificationMode</span><span class=\"token punctuation\">(</span><span class=\"token number\">24</span><span class=\"token punctuation\">,</span> GPIO_QUAL_SYNC<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>      <span class=\"token comment\">// é…ç½®ä¸ºåŒæ­¥é‡‡æ ·</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>    <span class=\"token function\">GPIO_setDirectionMode</span><span class=\"token punctuation\">(</span><span class=\"token number\">24</span><span class=\"token punctuation\">,</span> GPIO_DIR_MODE_IN<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>        <span class=\"token comment\">// é…ç½®ä¸ºè¾“å…¥æ¨¡å¼</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>    <span class=\"token function\">GPIO_setPadConfig</span><span class=\"token punctuation\">(</span><span class=\"token number\">24</span><span class=\"token punctuation\">,</span> GPIO_PIN_TYPE_PULLUP<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>        <span class=\"token comment\">// é…ç½®ä¸ºä¸Šæ‹‰æ¨¡å¼</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>    <span class=\"token comment\">// é…ç½®ä¸ºè¾“å‡ºæ¨¡å¼</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>    <span class=\"token function\">GPIO_setPinConfig</span><span class=\"token punctuation\">(</span><span class=\"token number\">25</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>    <span class=\"token function\">GPIO_setDirectionMode</span><span class=\"token punctuation\">(</span><span class=\"token number\">25</span><span class=\"token punctuation\">,</span> GPIO_DIR_MODE_OUT<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>    <span class=\"token function\">GPIO_setPadConfig</span><span class=\"token punctuation\">(</span><span class=\"token number\">25</span><span class=\"token punctuation\">,</span> GPIO_PIN_TYPE_STD<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h3 id=\"ç°è±¡\"><a class=\"anchor\" href=\"#ç°è±¡\">#</a> ç°è±¡</h3>\n<h4 id=\"gpio24-é«˜ç”µå¹³\"><a class=\"anchor\" href=\"#gpio24-é«˜ç”µå¹³\">#</a> GPIO24 é«˜ç”µå¹³</h4>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.e4vmh4tzxps.jpg\" alt=\"image\" /></p>\n<h4 id=\"gpio24ä½ç”µå¹³\"><a class=\"anchor\" href=\"#gpio24ä½ç”µå¹³\">#</a> GPIO24 ä½ç”µå¹³</h4>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.o5csaybwsi8.jpg\" alt=\"image\" /></p>\n<h1 id=\"å·¥ç¨‹\"><a class=\"anchor\" href=\"#å·¥ç¨‹\">#</a> å·¥ç¨‹</h1>\n<p>driverlib çš„å·¥ç¨‹é“¾æ¥<br />\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL3RvLXl3ei9EU1AyMzc5RA==\">ğŸ±</span>(â¬…ï¸ç‚¹æˆ‘)</p>\n<hr />\n<p>å¤§é“äº”åï¼Œå¤©è¡å››åä¹ï¼Œäººéå…¶ä¸€ï¼</p>\n",
            "tags": [
                "åµŒå…¥å¼",
                "DSP",
                "DSP"
            ]
        },
        {
            "id": "https://to-ywz.github.io/Embedded/DSP/TMS320F28379D%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85-GPIO/",
            "url": "https://to-ywz.github.io/Embedded/DSP/TMS320F28379D%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85-GPIO/",
            "title": "TMS320F28379Då­¦ä¹ ä¹‹æ—…-GPIOè¾“å‡º",
            "date_published": "2023-01-07T12:47:39.000Z",
            "content_html": "<p>ç¦»å¤§è°±ï¼Œæ²¡ commit å°±å›æ»šäº†ï¼Œå±…ç„¶å¾—é‡å†™<br />\nåŸæœ¬ï¼Œæ²¡æœ‰æ€ä¹ˆå•°å—¦çš„ï¼Œæ²¡æƒ³åˆ°ï¼Œç¬¬ä¸‰æ¬¡å†™ï¼Œå°±è¶Šå†™è¶Šå•°å—¦äº†ï¼Œè¯¸ä½è§è°…</p>\n<h3 id=\"è¯´æ˜\"><a class=\"anchor\" href=\"#è¯´æ˜\">#</a> è¯´æ˜</h3>\n<p>æœ¬æ–‡ç¡¬ä»¶åŸºäº<em> LaunchXL-F28379D</em> å’Œ é€»è¾‘åˆ†æä»ªï¼Œè½¯ä»¶åŸºäº CCS 10.4 ç‰ˆæœ¬ï¼Œ å¸®åŠ©æ–‡æ¡£ä¸º C2000 çš„ä¾‹ç¨‹å’Œ<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cudGkuY29tL2xpdC91Zy9zcHJ1aG04aS9zcHJ1aG04aS5wZGY/dHM9MTY3Mjk3MzMwMzA0NSZhbXA7cmVmX3VybD1odHRwcyUyNTNBJTI1MkYlMjUyRnd3dy50aS5jb20lMjUyRnByb2R1Y3QlMjUyRlRNUzMyMEYyODM3OUQ=\">å®˜æ–¹æ–‡æ¡£</span></p>\n<p>åœ¨æ­¤è¯´æ˜ï¼Œè¿™ä¸€ç³»åˆ—çš„æ–‡ç« ä¸»è¦æ˜¯è®°å½•æˆ‘å­¦ä¹ æ€è€ƒçš„è¿‡ç¨‹ï¼Œå¯èƒ½ä¼šå•°é‡Œå•°å”†</p>\n<p>ä¸ªäººè§‚ç‚¹ï¼Œæˆäººä»¥é±¼ä¸å¦‚æˆäººä»¥æ¸”ï¼Œæœ€åä¼šç»™å‡ºå®Œæ•´çš„ä»£ç å’Œå·¥ç¨‹çš„é“¾æ¥</p>\n<h1 id=\"é€»è¾‘æ¡†å›¾\"><a class=\"anchor\" href=\"#é€»è¾‘æ¡†å›¾\">#</a> é€»è¾‘æ¡†å›¾</h1>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.zih14yh8l6o.webp\" alt=\"image\" /></p>\n<p>ä¸€èˆ¬æ¥è¯´ï¼Œä¸€ä¸ªå¤„ç†å™¨è¦é…ç½®å¼•è„šéƒ½ä¼šæœ‰ä¸¤ç§æ–¹å¼ï¼š<strong>å¯„å­˜å™¨å’Œåº“å‡½æ•°</strong>ã€‚</p>\n<p>ä½†æ— è®ºå“ªä¸€ç§éƒ½éœ€è¦å»ç†è§£ç¡¬ä»¶çš„æ¶æ„ï¼Œè™½ç„¶è¿™å¹…æ¡†å›¾æœ‰äº›å¤æ‚ï¼Œä½†æ˜¯å¤§è‡´çš„å¯ä»¥çœ‹å‡ºï¼Œä¸‹åŠéƒ¨åˆ†æ˜¯ç”¨äºé…ç½®è¾“å‡ºæ¨¡å¼çš„ã€‚ä»å¯„å­˜å™¨çš„åç§° ä¹Ÿå¯ä»¥çœ‹å‡ºä¸€äº›å¯„å­˜å™¨æ˜¯ç”¨äºæ§åˆ¶è¾“å‡ºå€¼çš„ã€‚ä¾‹å¦‚ï¼Œ <code>GPySET</code> ã€ <code>GPyDAT</code>  ç­‰ã€‚</p>\n<p>ä½†æ˜¯è¦çŸ¥é“å¦‚ä½•é…ç½®ï¼Œè¿˜æ˜¯éœ€è¦å»é˜…è¯»æ–‡æ¡£çš„å¯„å­˜å™¨éƒ¨åˆ†å’Œå…¶ä»–éƒ¨åˆ†çš„è®²è§£çš„æ³¨æ„äº‹é¡¹</p>\n<p>å¯¹åº”æ–‡æ¡£åœ°å€<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cudGkuY29tL2xpdC91Zy9zcHJ1aG04aS9zcHJ1aG04aS5wZGY/dHM9MTY3Mjk3MzMwMzA0NSZhbXA7cmVmX3VybD1odHRwcyUyNTNBJTI1MkYlMjUyRnd3dy50aS5jb20lMjUyRnByb2R1Y3QlMjUyRlRNUzMyMEYyODM3OUQ=\">é“¾æ¥</span>ï¼Œå¯æƒœè½¬è·³ä¸åˆ°å¯¹åº”ç« èŠ‚</p>\n<h1 id=\"ç¬¬ä¸€æ­¥-gpio-å·¥ä½œæ¨¡å¼é…ç½®\"><a class=\"anchor\" href=\"#ç¬¬ä¸€æ­¥-gpio-å·¥ä½œæ¨¡å¼é…ç½®\">#</a> ç¬¬ä¸€æ­¥: GPIO å·¥ä½œæ¨¡å¼é…ç½®</h1>\n<p>åœ¨æ–‡æ¡£çš„ 8.2 èŠ‚ä¸­å¯ä»¥æ‰¾åˆ° GPIO å„ç§æ¨¡å¼é…ç½®çš„æ¦‚è¦å’Œè¯´æ˜<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.kk2l7qxy8dc.jpg\" alt=\"image\" /></p>\n<p>ä»æ–‡æ¡£ä¸­å¯ä»¥å¾—çŸ¥ï¼Œè¦å°† å¼•è„šè®¾ç½®ä¸º é€šç”¨è¾“å…¥è¾“å‡ºæ¨¡å¼ï¼Œéœ€è¦é…ç½®  <code>GPyMUXn</code>  å’Œ  <code>GPyGMUXn</code> .</p>\n<p>ä½†è¿™é‡Œå¹¶æ²¡æœ‰ç»™å‡º ä¸ªå¯„å­˜å™¨ éœ€è¦å¦‚ä½•é…ç½®ã€‚ä¸è¿‡æ–‡æ¡£æœ€åä¸€å¥ç»™å‡ºäº†ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œå¼•è„šå¤„äº é€šç”¨è¾“å…¥è¾“å‡ºæ¨¡å¼</p>\n<p>ç¿»é˜…æ–‡æ¡£åï¼Œæ‰¾åˆ°äº† å¤ç”¨è¡¨</p>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.661f7xwuu840.jpg\" alt=\"image\" /></p>\n<p>å¯ä»¥çœ‹å‡º å½“  <code>GPyMUXn</code>  ä¸º 0 æ—¶ï¼Œ <code>GPyGMUXn</code>  çš„å€¼ä¸æ¨¡å¼é…ç½®æ— å…³.</p>\n<p>æ‰€ä»¥æˆ‘ä»¬å¾—åˆ°äº†ç¬¬ä¸€æ­¥ï¼Œå°†  <code>GPyMUXn</code>  è®¾ç½®ä¸º 0</p>\n<p>ä½†ï¼Œè¡¨æ ¼ä¸­  <code>GPyMUXn</code>  çš„  <code>y</code>  å’Œ  <code>n</code>  åˆ†åˆ«ä»£è¡¨ä»€ä¹ˆå‘¢ï¼Œè¿˜æ˜¯å¾—å»æŸ¥æ‰¾ä¸€ä¸‹å¯„å­˜å™¨è¡¨</p>\n<p>åœ¨æ‰¾å¯„å­˜å™¨è¡¨çš„æ—¶å€™ï¼Œå‘ç° GPIO çš„å¯„å­˜å™¨åˆ†ä¸ºä¸¤å¤§ç±»ï¼Œ <code>GpioCtrlReg</code>  å’Œ  <code>GpioDataReg</code> , åˆ†åˆ«ç”¨äºé…ç½® GPIO å’Œ æ§åˆ¶å¼•è„šè¾“å‡ºå€¼</p>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.1v85vjrekhts.jpg\" alt=\"image\" /></p>\n<p>å¾ˆæ˜¾ç„¶  <code>GPyMUXn</code>  å±äºæ§åˆ¶å¯„å­˜å™¨ï¼Œæ‰€ä»¥å¾ˆè½»æ¾çš„å°±æ‰¾åˆ°äº† å¯¹åº”çš„å¯„å­˜å™¨</p>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.1id6odtaqvi8.jpg\" alt=\"image\" /></p>\n<p>ä»å›¾ä¸­æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œ <code>GPyMUXn</code>  çš„  <code>y</code>  ä»£è¡¨ GPIO çš„åˆ†ç»„ï¼Œä¸åŒçš„èŠ¯ç‰‡å¼•è„šæ•°ä¸åŒï¼Œå…·ä½“å¤šå°‘ä¸ªåˆ†ç»„å¾—çœ‹èŠ¯ç‰‡</p>\n<p><code>n</code>  åˆ™æ˜¯ 1 æˆ– 2, çœ‹åœ°å€å·®å€¼ä¸º 2 , ç„¶åä»ä¹‹å‰çš„å¤ç”¨è¡¨ä¸­å¾—åˆ°ä¸€ä¸ªå¼•è„šå  2 ä¸ªæ•°æ®ä½ï¼Œè€Œ TMS320 æ˜¯åœ°å€æ€»çº¿å’Œæ•°æ®æ€»çº¿çš„ä½å®½ä¸º 16, æ‰€ä»¥å¾— 2*16/2 = 16, ä¸€ä¸ª  <code>GPxMUXn</code>  æ§åˆ¶ 16 ä¸ªå¼•è„šã€‚è¿™åªæ˜¯å†™æ–‡ç« çš„æ—¶å€™çªç„¶æƒ³åˆ°çš„ï¼Œäº‹å®ä¸Šæˆ‘ä»¬å¯ä»¥ç›´æ¥çœ‹åé¢çš„è¯´æ˜ï¼ŒGPAMUX1 æ§åˆ¶ 0~15, ä¸€çœ‹å°±çŸ¥é“æ˜¯ 16 ä¸ª (æ‚è„¸)</p>\n<p>äº‹å®ä¸ŠçŸ¥é“è¿™äº›å°±å¯ä»¥å»é…ç½® GPIO çš„å·¥ä½œæ¨¡å¼äº†ï¼Œä½†æ˜¯é—®äº†é¢„é˜²ä¸‡ä¸€ï¼Œè¿˜æ˜¯å»çœ‹ä¸€çœ¼å¯„å­˜å™¨è¡¨ä¸ºå¥½</p>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.3laiawhj2jc0.jpg\" alt=\"image\" /></p>\n<p>äº‹å®ä¸Šï¼Œä¹Ÿæ²¡æœ‰ä»€ä¹ˆè¦æ³¨æ„çš„.</p>\n<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº† GPIO é…ç½®çš„ç¬¬ä¸€æ­¥ï¼šå°†  <code>GpioCtrlReg.GPyMUxn</code>  çš„å¯¹åº”å¼•è„šè®¾ç½®ä¸º 0.</p>\n<h1 id=\"ç¬¬äºŒæ­¥gpio-è¾“å…¥è¾“å‡ºé…ç½®\"><a class=\"anchor\" href=\"#ç¬¬äºŒæ­¥gpio-è¾“å…¥è¾“å‡ºé…ç½®\">#</a> ç¬¬äºŒæ­¥ï¼šGPIO è¾“å…¥è¾“å‡ºé…ç½®</h1>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.7825mzefgek.jpg\" alt=\"image\" /></p>\n<p>ç»§ç»­é˜…è¯»æ–‡æ¡£ï¼Œä¼šå‘ç° 2, 3 æ­¥åŸºæœ¬æ²¡ä»€ä¹ˆç”¨ (å¯¹è¾“å‡ºæ¨¡å¼è€Œè¨€), ODR å¯„å­˜å™¨æ˜¯åœ¨è¾“å…¥æ¨¡å¼æ—¶é…ç½®çš„ï¼Œä¸”é»˜è®¤æ˜¯å…³é—­çš„ï¼Œæ‰€ä»¥ç›´æ¥åˆ°ç¬¬ 4 æ­¥ï¼Œä¹Ÿæ˜¯ 8.2 èŠ‚æœ€åæœ‰ç”¨çš„åœ°æ–¹äº†ï¼Œé…ç½® å¼•è„š çš„è¾“å…¥è¾“å‡ºæ–¹å‘</p>\n<p>ä»æ–‡æ¡£ä¸­å¯ä»¥çŸ¥é“ï¼Œé»˜è®¤æƒ…å†µä¸‹ GPIO çš„å¼•è„š æ˜¯è¾“å…¥çš„ã€‚å¹¶ä¸”åœ¨æ”¹å˜ å¼•è„š ä¸ºè¾“å‡ºæ¨¡å¼æ—¶ï¼Œå»ºè®®å…ˆå†™å…¥è¦è¾“å‡ºçš„å€¼åˆ° æ•°æ®å¯„å­˜å™¨ä¸­ï¼Œè¾“å‡ºæ¨¡å¼ä¸‹é»˜è®¤è¾“å‡ºçš„ç”µå¹³éƒ½ä¸ºä½ç”µå¹³.</p>\n<p>ä¸ªäººè§‰å¾—å®˜æ–¹ï¼Œè®©æˆ‘ä»¬å…ˆè®¾ç½®è¾“å‡ºå€¼æ˜¯ä¸ºäº†é˜²æ­¢ï¼Œé…ç½®ä¸ºè¾“å‡ºæ¨¡å¼æ—¶é»˜è®¤çš„ä½ç”µå¹³å¯¼è‡´ï¼Œå¤–éƒ¨è®¾å¤‡å‡ºç°å¥‡æ€ªçš„ååº”ã€‚å’±ä»¬ç°åœ¨æ˜¯ç©ºè½½æ‰€ä»¥è¾“å‡ºå•¥ç”µå¹³æ²¡å•¥åŒºåˆ«.</p>\n<p>ç„¶ååˆåˆ°äº†ç¿»çœ‹å¯„å­˜å™¨çš„æ—¶å€™äº†ï¼Œè¿˜æ˜¯å»ä¹‹å‰çš„  <code>GpioCtrReg</code>  å¯„å­˜å™¨è¡¨ä¸­æŸ¥æ‰¾</p>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.6tcfn7knrnk0.jpg\" alt=\"image\" /></p>\n<p>ä¸å¾—ä¸è¯´ TI çš„ Go å’Œ è¿”å›æ€»è¡¨ åšçš„æ˜¯çœŸçš„è®©äººèˆ’å¿ƒ</p>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.ota5d4p3wu8.jpg\" alt=\"image\" /></p>\n<p>ä»å¯„å­˜å™¨æ•°ç ä¸­å¯ä»¥å¾—çŸ¥ å½“ GPyDIR ä¸º 1 æ—¶ï¼Œå¼•è„šä¸ºè¾“å‡ºæ¨¡å¼</p>\n<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å¾—åˆ°äº†ç¬¬äºŒæ­¥:  <code>GpioCtrlReg.GPADIR</code>  å¯¹åº”çš„å¼•è„šç½®ä½ä¸º 1</p>\n<h1 id=\"ç¬¬ä¸‰æ­¥-è¾“å‡ºæ¨¡å¼é…ç½®\"><a class=\"anchor\" href=\"#ç¬¬ä¸‰æ­¥-è¾“å‡ºæ¨¡å¼é…ç½®\">#</a> ç¬¬ä¸‰æ­¥ï¼šè¾“å‡ºæ¨¡å¼é…ç½®</h1>\n<p>åˆ°äº†è¿™é‡Œï¼Œ8.2 èŠ‚æ²¡æœ‰ç»§ç»­è¯´æ˜å’Œå•çº¯çš„è¾“å‡ºæ¨¡å¼ç›¸å…³çš„ä¿¡æ¯äº†ï¼Œä½†æ˜¯æ ¹æ®æˆ‘ä»¬ä¹‹å‰çš„é…ç½®ç»éªŒå¯ä»¥çŸ¥é“ è¿˜æœ‰è¾“å‡ºæ¨¡å¼éœ€è¦é…ç½®</p>\n<p>è¾“å‡ºæ¨¡å¼åˆ†ä¸ºå¼€æ¼å’Œæ¨æŒ½è¾“å‡ºï¼Œé—®é¢˜æ˜¯è¿™ä¸ªå¯„å­˜å™¨å«å•¥å‘¢ï¼Œè¿™å°±éœ€è¦ä»æ¡†å›¾ä¸­æŸ¥çœ‹äº†ï¼Œä»æ¡†å›¾ä¸­å¯ä»¥çœ‹å‡º è¿™æ˜¯ä¸€ä¸ªåä¸º  <code>GPyODR</code>  çš„å¯„å­˜å™¨ã€‚è¿™å°±è¦å†æ¬¡å¼€å§‹ç¿»æ‰¾  <code>GpioCtrlReg</code>  çš„å¯„å­˜å™¨åˆ—è¡¨</p>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/1673011610331.6xpojcdwxkc0.jpg\" alt=\"1673011610331\" /></p>\n<p>ç”±äº TI çš„äººæ€§åŒ–è®¾è®¡ï¼Œè¿˜æ˜¯å¾ˆå¿«å°±èƒ½æ‰¾åˆ°çš„ï¼Œä»æ–‡æ¡£ä¸­å¯çŸ¥ å½“ GPyODR ä¸º 0 çš„æ—¶å€™ï¼Œä¸ºæ­£å¸¸è¾“å‡º.</p>\n<p>è‡³æ­¤æˆ‘ä»¬å°±å¾—åˆ°äº†é…ç½®å¼•è„šä¸ºè¾“å‡ºçš„ç¬¬ä¸‰æ­¥ï¼šå°†  <code>GpioCtrlReg.GPyODR</code>  å¯¹åº”çš„ å¼•è„šä½å¤ä½</p>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.23fcwdjw08qo.jpg\" alt=\"image\" /></p>\n<h1 id=\"å°ç»“\"><a class=\"anchor\" href=\"#å°ç»“\">#</a> å°ç»“</h1>\n<p>åˆ°æ­¤æˆ‘ä»¬å°±çŸ¥é“äº†ï¼Œå¼•è„šé…ç½®ä¸ºè¾“å‡ºæ¨¡å¼æ‰€éœ€è¦çš„æ­¥éª¤:</p>\n<ol>\n<li>é…ç½®å¼•è„šä¸º é€šç”¨è¾“å…¥è¾“å‡ºæ¨¡å¼</li>\n<li>è®¾ç½®å¼•è„šè¾“å‡ºå€¼</li>\n<li>é…ç½®å¼•è„šä¸º è¾“å‡ºæ¨¡å¼</li>\n<li>é…ç½®å¼•è„šä¸º æ¨æŒ½è¾“å‡º</li>\n</ol>\n<p>æ¥ä¸‹æ¥ç”¨ä¸¤ç§æ–¹å¼æ¥å®ç° GPIO é…ç½®<br />\n<strong>è¿™é‡Œå‡è®¾ æˆ‘ä»¬è¦å°† GPIO24 é…ç½®ä¸ºè¾“å‡ºæ¨¡å¼å¹¶è¾“å‡º 5 ä¸ªæ–¹æ³¢</strong><br />\nä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯å¯¼å…¥çš„ç©ºæ–‡ä»¶å·¥ç¨‹éœ€è¦ä¸åŒå¯èƒ½ä¼šå¯¼è‡´ åº“å‡½æ•°ä¸åŒï¼Œç›´æ¥æ“ä½œå¯„å­˜çš„æ–¹å¼ä¹Ÿä¸åŒ<br />\nä»  <code>C2000Ware_4_01_00_00\\driverlib</code>  è·¯å¾„ä¸‹å¯¼å…¥çš„å·¥ç¨‹ï¼Œå¯„å­˜å™¨æ“ä½œä¼šéº»çƒ¦å¾ˆå¤šï¼Œä½†æ˜¯åº“å‡½æ•°èµ„æ–™å¤š<br />\nè€Œä»  <code>C2000Ware_4_01_00_00\\device_support</code>  è·¯å¾„ä¸‹å¯¼å…¥åˆ™æ˜¯å¯„å­˜å™¨æ“ä½œæ›´åŠ è´´è¿‘æ‰‹å†Œã€ä¾¿äºæ“ä½œï¼Œåº“å‡½æ•°ä½“ç³»è‡ªæˆä¸€å®¶<br />\nç®€å•æŸ¥çœ‹ä¸€ä¸‹æºæ–‡ä»¶å°±çœ‹å¯ä»¥çŸ¥é“ä¸¤ä¸ªå·¥ç¨‹çš„é£æ ¼ç›¸å·®ç”šè¿œ (è¯´å®è¯ï¼Œä¸¤ç§åº“çš„åº•å±‚æ„å»ºéƒ½ç»™æˆ‘æå¤§çš„å¯å‘)<br />\n ä¸‹é¢æˆ‘ä¼šç”¨ä¸¤ä¸ªåº“åˆ†åˆ«å®ç°å¯„å­˜å™¨ç‰ˆæœ¬å’Œåº“å‡½æ•°ç‰ˆæœ¬çš„æ“ä½œ</p>\n<h2 id=\"device_support\"><a class=\"anchor\" href=\"#device_support\">#</a> device_support</h2>\n<h3 id=\"å¯„å­˜å™¨ç‰ˆæœ¬\"><a class=\"anchor\" href=\"#å¯„å­˜å™¨ç‰ˆæœ¬\">#</a> å¯„å­˜å™¨ç‰ˆæœ¬</h3>\n<p>è¿™ä¸ªå½“åˆæˆ‘æ˜¯ç›´æ¥ç¿»çœ‹ï¼Œæºç çœ‹æ˜ç™½çš„ï¼Œå¤§è‡´è®²ä¸€ä¸‹æ€è·¯</p>\n<p>æ–‡æ¡£ä¸­ç»™å‡ºäº†ä¸¤ä¸ªå¯„å­˜å™¨çš„åç§°ï¼Œç„¶åæˆ‘ç›´æ¥è¾“è¿›å»ç„¶åå‡ºç°è‡ªåŠ¨è¡¥å…¨ï¼Œç„¶åå°±æ²¡æœ‰ç„¶åäº†</p>\n<p>ä¸è¿‡ï¼Œåœ¨è¾“å…¥å¯„å­˜å™¨åç§°çš„æ—¶å€™ï¼Œæˆ‘è·³è½¬åˆ°æºç æŸ¥çœ‹äº†ä¸€ä¸‹</p>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.1guu00zddyrk.jpg\" alt=\"image\" /></p>\n<p>æ‰¾åˆ°äº†å¯¹åº”çš„ç»“æ„ä½“ï¼Œç¿»é˜…äº†ä¸€ä¸‹æˆå‘˜ï¼Œå‘ç°ä¸æ–‡æ¡£ç›¸ç¬¦ç„¶åå°±ç›´æ¥æ“ä½œäº†ï¼Œ <code>GpioDataReg</code>  ä¹Ÿæ˜¯åŒæ ·çš„é“ç†<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.3ck7lv300vc0.jpg\" alt=\"image\" /></p>\n<p>æ ¹æ®ä¸Šé¢çš„å°ç»“æˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸€ä¸‹ä»£ç </p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"2\"></td><td><pre> * @b å¯„å­˜å™¨é…åˆ¶å¼•è„š</pre></td></tr><tr><td data-num=\"3\"></td><td><pre> */</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">Reg_GpioCfg</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    EALLOW<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    GpioDataRegs<span class=\"token punctuation\">.</span>GPADAT<span class=\"token punctuation\">.</span>bit<span class=\"token punctuation\">.</span>GPIO24 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>      \t<span class=\"token comment\">// é¢„è®¾ pin è¾“å‡ºç”µå¹³</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    GpioCtrlRegs<span class=\"token punctuation\">.</span>GPAMUX2<span class=\"token punctuation\">.</span>bit<span class=\"token punctuation\">.</span>GPIO24 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\t<span class=\"token comment\">// è®¾ç½® pin ä¸ºé€šç”¨è¾“å…¥è¾“å‡ºæ¨¡å¼</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    GpioCtrlRegs<span class=\"token punctuation\">.</span>GPADIR<span class=\"token punctuation\">.</span>bit<span class=\"token punctuation\">.</span>GPIO24 <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\t\t<span class=\"token comment\">// è®¾ç½® pin ä¸ºè¾“å‡º</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    GpioCtrlRegs<span class=\"token punctuation\">.</span>GPAODR<span class=\"token punctuation\">.</span>bit<span class=\"token punctuation\">.</span>GPIO24 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\t\t<span class=\"token comment\">// è®¾ç½® pin ä¸ºæ¨æŒ½è¾“å‡º</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    EDIS<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><code>EALLOW</code>  æ˜¯ç”¨äºè§£é™¤å†™ä¿æŠ¤ï¼Œ <code>EDIS</code>  æ˜¯ç”¨äºæ¢å¤å†™ä¿æŠ¤çš„ï¼Œè¿™ä¸ªåœ¨å¯„å­˜å™¨è¡¨ä¸­å¯ä»¥å¾—åˆ°</p>\n<p>æ¥ä¸‹å»æˆ‘ä»¬è¦å® IO24 è¾“å‡º 5 ä¸ªé«˜ç”µå¹³ï¼Œè¿™ä¸ªå°±æ¯”è¾ƒç®€å•å•¦ï¼Œæ— éå°±æ˜¯å†™ä¸ªéšæœºå»¶æ—¶ + ä¸Š for å¾ªç¯ï¼Œç”¨  <code>GPADAT</code>  æˆ–è€…  <code>GPASET</code>  å’Œ  <code>GPACLEAR</code>  ä»¥åŠ  <code>GPATOGGLE</code>  æ¥æ“ä½œ</p>\n<p>è¿™é‡Œï¼Œæˆ‘é€‰æ‹©ç”¨  <code>GPATOGGLE</code>  ç›´æ¥æ“ä½œï¼Œèƒ½å°‘äº›å¥½å¤šè¡Œä»£ç </p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"2\"></td><td><pre> * @b æµ‹è¯•å‡½æ•°ï¼šäº§ç”Ÿ 5 ä¸ªæ–¹æ³¢</pre></td></tr><tr><td data-num=\"3\"></td><td><pre> */</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">test_function</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">volatile</span> <span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">10</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        GpioDataRegs<span class=\"token punctuation\">.</span>GPATOGGLE<span class=\"token punctuation\">.</span>bit<span class=\"token punctuation\">.</span>GPIO24 <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// ç¿»è½¬ç”µå¹³</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t<span class=\"token comment\">// éšæœºå»¶æ—¶</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token keyword\">int</span> j <span class=\"token operator\">=</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>j<span class=\"token operator\">--</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            <span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h3 id=\"åº“å‡½æ•°ç‰ˆæœ¬\"><a class=\"anchor\" href=\"#åº“å‡½æ•°ç‰ˆæœ¬\">#</a> åº“å‡½æ•°ç‰ˆæœ¬</h3>\n<p>ç”±äºæ²¡æ‰¾åˆ°ç›¸å…³çš„æ–‡æ¡£ï¼Œå°±åªèƒ½ç›´æ¥è¯»æºç äº†<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.412jp8t6tg40.jpg\" alt=\"image\" /><br />\n ç›´æ¥ç¿»é˜…  <code>Gpio.c</code>  æ–‡ä»¶ï¼Œå°±å¯ä»¥çœ‹åˆ°å’Œ GPIO é…ç½®ç›¸å…³çš„ä»£ç äº†<br />\nä¸€é¡¿ç¿»çœ‹å‡½æ•°æ³¨é‡Šåå°±å¯ä»¥çŸ¥é“  <code>GPIO_SetupPinMux</code>  å’Œ  <code>GPIO_SetupPinOptions</code>  å¯ä»¥å®Œæˆå¯¹ å¼•è„šçš„é…ç½®<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.jaz44znv1l4.jpg\" alt=\"image\" /><br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.5nrdyny0q3c0.jpg\" alt=\"image\" /><br />\n <code>GPIO_SetupPinMux</code>  æ˜¯ç”¨äº å°† å¼•è„šè®¾ç½®ä½ é€šç”¨ I/O æ¨¡å¼ï¼Œ <code>GPIO_SetupPinOptions</code>  åˆ™æ˜¯ç”¨äºé€‰æ‹© è¾“å…¥è¾“å‡ºå’Œè¾“å‡ºæ¨¡å¼</p>\n<p>ç”±æ­¤å¯ä»¥å¾—åˆ°æœ€ç»ˆä»£ç </p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"2\"></td><td><pre> * @b å‡½æ•°é…ç½® å¼•è„š</pre></td></tr><tr><td data-num=\"3\"></td><td><pre> */</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">Fun_GpioCfg</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token function\">GPIO_SetupPinMux</span><span class=\"token punctuation\">(</span><span class=\"token number\">24</span><span class=\"token punctuation\">,</span> GPIO_MUX_CPU1<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                 <span class=\"token comment\">// 31 è„šé…ç½®ä¸º GPIO</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token function\">GPIO_SetupPinOptions</span><span class=\"token punctuation\">(</span><span class=\"token number\">24</span><span class=\"token punctuation\">,</span> GPIO_OUTPUT<span class=\"token punctuation\">,</span> GPIO_PULLUP<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>     <span class=\"token comment\">// 31 è„šé…ç½®ä¸º æ¨æŒ½è¾“å‡º</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"driverlib\"><a class=\"anchor\" href=\"#driverlib\">#</a> driverlib</h2>\n<p>ç”±äºè¿™ä¸ªçš„å¯„å­˜å™¨ç‰ˆæœ¬ï¼Œä¼šæ¶‰åŠåˆ°é˜…è¯»åº“å‡½æ•°ï¼Œæ‰€ä»¥å…ˆè®²åº“å‡½æ•°</p>\n<h3 id=\"åº“å‡½æ•°ç‰ˆæœ¬-2\"><a class=\"anchor\" href=\"#åº“å‡½æ•°ç‰ˆæœ¬-2\">#</a> åº“å‡½æ•°ç‰ˆæœ¬</h3>\n<p>ç¿»é˜…æ–‡æ¡£åœ¨ 8.9.4 å°ç»“å¯ä»¥çœ‹åˆ°å¯¹åº”çš„ æ“ä½œå‡½æ•°</p>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.nplmsp3sjww.jpg\" alt=\"image\" /></p>\n<p>å½“ç„¶ä¹Ÿå¯ä»¥å»å®˜ç½‘ä¸‹è½½  <code> F2837xD_DriverLib_Users_Guide.pdf</code>  , è¿™ä¸ªæ–‡æ¡£ åˆ†æ¨¡å—çš„ä»‹ç»äº†å„ä¸ª API å’Œè¯¥æ¨¡å—å¯¹åº”çš„ç»“æ„ä½“</p>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.579gb2gfqxc0.jpg\" alt=\"image\" /></p>\n<p>æˆ–è€…ç›´æ¥æŸ¥çœ‹  <code>device.h</code>  å¤´æ–‡ä»¶ä¸­åŒ…å«çš„  <code>gpio.h</code>  æ–‡ä»¶ï¼Œé‡Œé¢å¯¹å„ä¸ªå‡½æ•°çš„ç”¨é€”åŠå…¶å‚æ•°è¿›è¡Œäº†è¯¦ç»†çš„è¯´æ˜<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.qpbjffv9s1s.jpg\" alt=\"image\" /></p>\n<p>é€”å¾„å¾ˆå¤šï¼Œå°±æˆ‘çš„ä¹ æƒ¯è€Œè¨€ï¼Œä¼šå…ˆä»æ–‡æ¡£ä¸­è·å–ç›¸å…³å‡½æ•°ï¼Œç„¶åå†å»ä»£ç æ³¨è§£ä¸­å»é…ç½®å‡½æ•°å¦‚ä½•ä½¿ç”¨ï¼Œç­‰å®ç°æ•ˆæœåå†å›å¤´åˆ†æ è¿™ä¸ªå‡½æ•°çš„åº•å±‚çš„å®ç°<br />\næ‰€ä»¥ï¼Œè¿™æˆ‘ä¹ŸæŒ‰è¿™ç§æ–¹å¼ä»‹ç».</p>\n<p>é¦–å…ˆï¼Œç¬¬ä¸€æ­¥éœ€è¦æ“ä½œ  <code>GPyMUXn</code> , ä»æ–‡æ¡£çš„ 8.9.4 èŠ‚å¯çŸ¥ï¼Œéœ€è¦æŸ¥çœ‹  <code>GPIO_setPinConfig</code> ,<br />\n æŸ¥çœ‹æºç å¾—åˆ°ï¼Œè¿™ä¸ªå‡½æ•°åªéœ€è¦ å°†è¦é…ç½®çš„å¼•è„š çš„å¼•è„šå·ä¼ å…¥å³å¯  <code>GPIO_setPinConfig(24);</code> <br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/1673098106423.lzgxaucs174.jpg\" alt=\"1673098106423\" /></p>\n<p>ç¬¬äºŒæ­¥ï¼Œéœ€è¦æ“ä½œè®¾ç½® å¼•è„šè¦è¾“å‡º çš„å€¼ï¼Œæˆ‘æƒ³è¾“å‡º ä½ç”µå¹³ï¼Œé»˜è®¤å°±æ˜¯ä½ç”µå¹³ï¼Œæ‰€ä»¥ä¸éœ€è¦é…ç½®<br />\nä¸è¿‡éœ€è¦ä¸€å¼€å§‹è¾“å‡ºé«˜ç”µå¹³åˆ™ï¼Œä»æ–‡æ¡£ä¸­å¯çŸ¥ å¯ä»¥ä½¿ç”¨  <code>GPIO_writePin</code>  å’Œ  <code>GPIO_setPortPins</code>  æ¥å°†ç”µå¹³æ‹‰é«˜<br />\næŸ¥çœ‹æºç æ³¨é‡Šå¯çŸ¥é…ç½®ä¸ºé«˜ç”µå¹³çš„æ–¹å¼  <code>GPIO_writePin(24, 1)</code>  æˆ–  <code>GPIO_setPortPins(GPIO_PORT_A, (uint32_t)1 &lt;&lt; 24)</code></p>\n<p>ç¬¬ä¸‰æ­¥ï¼Œå°† å¼•è„š é…ç½®ä¸ºè¾“å‡ºæ¨¡å¼ï¼Œä»æ–‡æ¡£å¾— éœ€è¦æ“ä½œ  <code>GPIO_setDirectionMode</code> <br />\n æŸ¥çœ‹æºç å¯çŸ¥ï¼Œå‡½æ•°éœ€è¦é…ç½®ä¸¤ä¸ªå‚æ•°ï¼šå¼•è„šå·å’Œè¾“å‡ºæ¨¡å¼ã€‚ä»æ³¨é‡Šä¸­çœ‹å¯ä»¥çŸ¥é“ï¼Œè¾“å‡ºæ¨¡å¼æœ‰å®å®šä¹‰ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥å¥—ç”¨å®å®šä¹‰<br />\nå¾—åˆ°æºç   <code>GPIO_setDirectionMode(24, GPIO_DIR_MODE_OUT);</code> <br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.i3ct7366c28.jpg\" alt=\"image\" /></p>\n<p>æœ€åä¸€æ­¥ï¼Œé…ç½®å¼•è„šçš„è¾“å‡ºæ¨¡å¼ï¼Œä»æ–‡æ¡£ä¸­å¯çŸ¥ï¼Œéœ€è¦æ“ä½œ  <code>GPIO_setPadConfig</code> <br />\n æŸ¥çœ‹æºç åè¿”ç°ï¼Œè¿™ä¸ªå‡½æ•°éœ€è¦ä¸¤ä¸ªå‚æ•°ï¼šå¼•è„šå·å’Œè¾“å…¥ | è¾“å‡ºæ¨¡å¼å¼•è„šçŠ¶æ€<br />\næœ‰æ„æ€çš„æ˜¯ï¼Œè¿™ä¸ªå‡½æ•° å¯ä»¥è¿›è¡Œ è¾“å‡ºæ¨¡å¼çš„æ¨æŒ½å¼€æ¼é…ç½® å’Œ è¾“å…¥æ¨¡å¼çš„ä¸Šæ‹‰å’Œä¸‹æ‹‰é…ç½®.<br />\n é€šè¿‡ å®æ¥è¿›è¡ŒåŒºåˆ†ï¼Œå½“å‰å¼•è„šéœ€è¦é…ç½®ä»€ä¹ˆ.(çœŸå°±æ²¡æœ‰é˜²æŠ¤)<br />\n å¾—åˆ°ä»£ç   <code>GPIO_setPadConfig(24, GPIO_PIN_TYPE_STD);</code> <br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.53bkdzvvgqs0.jpg\" alt=\"image\" /></p>\n<p>æœ€åå¾—åˆ°å¯¹åº”çš„æºç å¦‚ä¸‹</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"2\"></td><td><pre> * @b åˆå§‹åŒ– pin ä¸ºè¾“å‡ºæ¨¡å¼</pre></td></tr><tr><td data-num=\"3\"></td><td><pre> */</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">Fun_setupOutputPin</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint32_t</span> pin<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token function\">GPIO_setPinConfig</span><span class=\"token punctuation\">(</span>pin<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                          <span class=\"token comment\">// é…ç½®ä¸º é€šç”¨è¾“å…¥è¾“å‡ºæ¨¡å¼</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token function\">GPIO_setDirectionMode</span><span class=\"token punctuation\">(</span>pin<span class=\"token punctuation\">,</span> GPIO_DIR_MODE_OUT<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>   <span class=\"token comment\">// é…ç½®ä¸º è¾“å‡ºæ¨¡å¼</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token function\">GPIO_setPadConfig</span><span class=\"token punctuation\">(</span>pin<span class=\"token punctuation\">,</span> GPIO_PIN_TYPE_STD<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>       <span class=\"token comment\">// é…ç½®ä¸º æ¨æŒ½è¾“å‡º</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h3 id=\"å¯„å­˜å™¨ç‰ˆæœ¬-2\"><a class=\"anchor\" href=\"#å¯„å­˜å™¨ç‰ˆæœ¬-2\">#</a> å¯„å­˜å™¨ç‰ˆæœ¬</h3>\n<p>è¿™ä¸ªåº“é‡Œçš„å¯„å­˜å™¨å°±æ²¡æœ‰ç‰¹å®šçš„ç»“æ„ä½“äº†ï¼Œæœ‰çš„æ˜¯å¤§é‡çš„æšä¸¾å’Œå¼ºåˆ¶è½¬æ¢ï¼Œæ¯”è¾ƒè€ƒéªŒæŒ‡é’ˆæ“ä½œå’Œå¯¹å¯„å­˜å™¨çš„ç†Ÿæ‚‰ç¨‹åº¦<br />\næ‰€ä»¥æˆ‘ä»¬å°±éœ€è¦å»çœ‹ä¸€ä¸‹åº“å‡½æ•°æ˜¯å¦‚ä½•å®ç°çš„<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.50wivby5o4w0.jpg\" alt=\"image\" /></p>\n<p>ä»æºç ä¸­å¯ä»¥çœ‹å‡ºï¼Œè¿™çš„å¯„å­˜å™¨æ“ä½œæ˜¯é€šè¿‡ GPIO çš„åŸºåœ°å€å¼ºè½¬ä¸º æŒ‡é’ˆï¼Œé€šè¿‡è®¿é—®æ•°ç»„çš„æ–¹å¼æ¥å®ç°ä¿®æ”¹å€¼<br />\nç›¸å…³çš„å® åˆ†å¸ƒåœ¨  <code>gpio.h</code>  å’Œ  <code>hw_gpio.h</code>  ä»¥åŠ  <code>hw_memmap.h</code>  ä¸­å®šä¹‰ï¼Œå…·ä½“æƒ…å†µè‡ªè¡ŒæŸ¥çœ‹</p>\n<p>è¿™é‡Œå°±ç›´æ¥è´´å‡ºæºç ï¼Œå› ä¸ºçº¯ç²¹çš„ç¿»çœ‹å¯„å­˜å™¨ å’Œ ç®—å†…å­˜åå·®å®åœ¨æ˜¯æ²¡ä»€ä¹ˆå¯ä»¥è¯´çš„äº†<br />\næ³¨é‡Šé‡Œå·²ç»å†™çš„å¾ˆæ¸…æ¥šäº†</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"2\"></td><td><pre> * @b åˆå§‹åŒ– pin ä¸ºè¾“å‡ºæ¨¡å¼</pre></td></tr><tr><td data-num=\"3\"></td><td><pre> */</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">Reg_setupOutputPin</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint32_t</span> pin<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token class-name\">uint32_t</span> pinMask <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>                   <span class=\"token comment\">// å…¶ä»– 1 ä½å¯„å­˜å™¨æ©ç </span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token class-name\">uint32_t</span> muxPinMask <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>                <span class=\"token comment\">// MUX å¯„å­˜å™¨æ©ç </span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">volatile</span> <span class=\"token class-name\">uint32_t</span> <span class=\"token operator\">*</span>gpioCtrlReg <span class=\"token operator\">=</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// æŒ‡å‘ gpioCtrlReg çš„ æŒ‡é’ˆ</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token comment\">// å®šä½ GPIOA æ‰€æœ‰å¯„å­˜å™¨çš„é¦–åœ°å€ï¼ŒGPIO_CTRL_REGS_STEP æ˜¯å¯„å­˜å™¨æ­¥é•¿ï¼Œä¸€ç»„ GPIO å¯„å­˜å™¨çš„é•¿åº¦</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    gpioCtrlReg <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">uint32_t</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uintptr_t</span><span class=\"token punctuation\">)</span> GPIOCTRL_BASE</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>pin <span class=\"token operator\">/</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> GPIO_CTRL_REGS_STEP<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token comment\">// è¦è¢«ç½®ä½çš„å¼•è„šæ©ç è®¡ç®—</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    pinMask <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">uint32_t</span><span class=\"token punctuation\">)</span> <span class=\"token number\">1U</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token punctuation\">(</span>pin <span class=\"token operator\">%</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token comment\">// ä¸€ä¸ª MUX ç®¡ç† 16 ä¸ªå¼•è„šï¼Œæ‰€ä»¥ å¯¹ 16 å–ä½™æ•°</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token comment\">// ä¹˜ 2 æ˜¯å› ä¸ºä¸€ä¸ªå¼•è„šå¯¹åº”ä¸¤ä¸ªä½ï¼Œæ¯è¿‡ä¸€ä¸ªå¼•è„šè¦ ç§»ä¸¤ä½</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    muxPinMask <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint32_t</span><span class=\"token punctuation\">)</span> <span class=\"token number\">3U</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>pin <span class=\"token operator\">%</span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    EALLOW<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token comment\">// è®¾ç½®ä¸ºè¾“å‡ºæ¨¡å¼</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    gpioCtrlReg<span class=\"token punctuation\">[</span>GPIO_GPxDIR_INDEX<span class=\"token punctuation\">]</span> <span class=\"token operator\">|=</span> pinMask<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token comment\">// è®¾ç½®ä¸ºæ¨æŒ½è¾“å‡º</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    gpioCtrlReg<span class=\"token punctuation\">[</span>GPIO_GPxODR_INDEX<span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;=</span> <span class=\"token operator\">~</span>pinMask<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token comment\">// è®¾ç½®ä½ é€šç”¨è¾“å‡ºæ¨¡å¼</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>pin <span class=\"token operator\">%</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">16</span> <span class=\"token operator\">>=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>    <span class=\"token comment\">// åˆ¤æ–­å¼•è„šå±äº MUX1 è¿˜æ˜¯ MUX2</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span><span class=\"token comment\">// ä¸ºä»€ä¹ˆ + 1 è€Œä¸æ˜¯ +2 æˆ‘ä¹Ÿæ²¡å¼„æ‡‚ï¼ŒæŒ å¤´ï¼Œç­‰å¼„æ‡‚å†æ›´æ–°</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        gpioCtrlReg<span class=\"token punctuation\">[</span>GPIO_GPxMUX_INDEX <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;=</span> <span class=\"token operator\">~</span>muxPinMask<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        gpioCtrlReg<span class=\"token punctuation\">[</span>GPIO_GPxMUX_INDEX<span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;=</span> <span class=\"token operator\">~</span>muxPinMask<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    EDIS<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h1 id=\"ä»£ç å®ç°\"><a class=\"anchor\" href=\"#ä»£ç å®ç°\">#</a> ä»£ç å®ç°</h1>\n<h2 id=\"device_support-2\"><a class=\"anchor\" href=\"#device_support-2\">#</a> device_support</h2>\n<p>ä½¿ç”¨  <code>C2000Ware_4_01_00_00\\device_support</code>  ç©ºå·¥ç¨‹ å¯¼å…¥ å®ç°çš„æºç </p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"F28x_Project.h\"</span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">Fun_GpioCfg</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">Reg_GpioCfg</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">test_function</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token function\">InitSysCtrl</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// åˆå§‹åŒ–ç³»ç»Ÿé…ç½®ï¼Œ(ä¾‹å¦‚é…ç½®æ—¶é’Ÿï¼Œå…³é—­çœ‹é—¨ç‹—...)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token function\">InitGpio</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>     <span class=\"token comment\">// åˆå§‹åŒ– GPIO æ¨¡å—</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token comment\">// å…³ä¸­æ–­</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    DINT<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token function\">InitPieCtrl</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>      <span class=\"token comment\">// åˆå§‹åŒ–ä¸­æ–­æ§åˆ¶å™¨</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token function\">InitPieVectTable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// åˆå§‹åŒ–ä¸­æ–­å‘é‡è¡¨</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token comment\">// å¼€ä¸­æ–­</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    EINT<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token comment\">// åˆå§‹åŒ– GPIO, äºŒé€‰ä¸€å³å¯</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token function\">Reg_GpioCfg</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token comment\">//Fun_GpioCfg();</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token function\">test_function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"34\"></td><td><pre> * @b æµ‹è¯•å‡½æ•°ï¼šäº§ç”Ÿ 5 ä¸ªæ–¹æ³¢</pre></td></tr><tr><td data-num=\"35\"></td><td><pre> */</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">test_function</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">volatile</span> <span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">10</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>        GpioDataRegs<span class=\"token punctuation\">.</span>GPATOGGLE<span class=\"token punctuation\">.</span>bit<span class=\"token punctuation\">.</span>GPIO24 <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>        <span class=\"token keyword\">int</span> j <span class=\"token operator\">=</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>        <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>j<span class=\"token operator\">--</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>            <span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre></pre></td></tr><tr><td data-num=\"47\"></td><td><pre><span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"48\"></td><td><pre> * @b å‡½æ•°é…ç½® å¼•è„š</pre></td></tr><tr><td data-num=\"49\"></td><td><pre> */</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">Fun_GpioCfg</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>    <span class=\"token function\">GPIO_SetupPinMux</span><span class=\"token punctuation\">(</span><span class=\"token number\">24</span><span class=\"token punctuation\">,</span> GPIO_MUX_CPU1<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                 <span class=\"token comment\">// 31 è„šé…ç½®ä¸º GPIO</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>    <span class=\"token function\">GPIO_SetupPinOptions</span><span class=\"token punctuation\">(</span><span class=\"token number\">24</span><span class=\"token punctuation\">,</span> GPIO_OUTPUT<span class=\"token punctuation\">,</span> GPIO_PULLUP<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>     <span class=\"token comment\">// 31 è„šé…ç½®ä¸º æ¨æŒ½è¾“å‡º</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre></pre></td></tr><tr><td data-num=\"56\"></td><td><pre><span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"57\"></td><td><pre> * @b å¯„å­˜å™¨é…åˆ¶å¼•è„š</pre></td></tr><tr><td data-num=\"58\"></td><td><pre> */</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">Reg_GpioCfg</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>    EALLOW<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>    GpioCtrlRegs<span class=\"token punctuation\">.</span>GPAMUX2<span class=\"token punctuation\">.</span>bit<span class=\"token punctuation\">.</span>GPIO24 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>    GpioCtrlRegs<span class=\"token punctuation\">.</span>GPADIR<span class=\"token punctuation\">.</span>bit<span class=\"token punctuation\">.</span>GPIO24 <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>    GpioCtrlRegs<span class=\"token punctuation\">.</span>GPAODR<span class=\"token punctuation\">.</span>bit<span class=\"token punctuation\">.</span>GPIO24 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>    EDIS<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"driverlib-2\"><a class=\"anchor\" href=\"#driverlib-2\">#</a> driverlib</h2>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"driverlib.h\"</span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"device.h\"</span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">Reg_setupOutputPin</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint32_t</span> pin<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">Fun_setupOutputPin</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint32_t</span> pin<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">test_function</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\">//</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\">// Main</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\">//</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token comment\">// ç³»ç»Ÿåˆå§‹åŒ–</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token function\">Device_init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token comment\">// Reg_setupOutputPin(24);</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token function\">Fun_setupOutputPin</span><span class=\"token punctuation\">(</span><span class=\"token number\">24</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token comment\">// æµ‹è¯•å‡½æ•°</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token function\">test_function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"27\"></td><td><pre> * @b åˆå§‹åŒ– pin ä¸ºè¾“å‡ºæ¨¡å¼</pre></td></tr><tr><td data-num=\"28\"></td><td><pre> */</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">Fun_setupOutputPin</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint32_t</span> pin<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token function\">GPIO_setPinConfig</span><span class=\"token punctuation\">(</span>pin<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                          <span class=\"token comment\">// é…ç½®ä¸º é€šç”¨è¾“å…¥è¾“å‡ºæ¨¡å¼</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token function\">GPIO_setDirectionMode</span><span class=\"token punctuation\">(</span>pin<span class=\"token punctuation\">,</span> GPIO_DIR_MODE_OUT<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>   <span class=\"token comment\">// é…ç½®ä¸º è¾“å‡ºæ¨¡å¼</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token function\">GPIO_setPadConfig</span><span class=\"token punctuation\">(</span>pin<span class=\"token punctuation\">,</span> GPIO_PIN_TYPE_STD<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>       <span class=\"token comment\">// é…ç½®ä¸º æ¨æŒ½è¾“å‡º</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"37\"></td><td><pre> * @b åˆå§‹åŒ– pin ä¸ºè¾“å‡ºæ¨¡å¼</pre></td></tr><tr><td data-num=\"38\"></td><td><pre> */</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">Reg_setupOutputPin</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint32_t</span> pin<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    <span class=\"token class-name\">uint32_t</span> pinMask <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>                   <span class=\"token comment\">// å…¶ä»– 1 ä½å¯„å­˜å™¨æ©ç </span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    <span class=\"token class-name\">uint32_t</span> muxPinMask <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>                <span class=\"token comment\">// MUX å¯„å­˜å™¨æ©ç </span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    <span class=\"token keyword\">volatile</span> <span class=\"token class-name\">uint32_t</span> <span class=\"token operator\">*</span>gpioCtrlReg <span class=\"token operator\">=</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// æŒ‡å‘ gpioCtrlReg çš„ æŒ‡é’ˆ</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    <span class=\"token comment\">// å®šä½ GPIOA æ‰€æœ‰å¯„å­˜å™¨çš„é¦–åœ°å€ï¼ŒGPIO_CTRL_REGS_STEP æ˜¯å¯„å­˜å™¨æ­¥é•¿ï¼Œä¸€ç»„ GPIO å¯„å­˜å™¨çš„é•¿åº¦</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    gpioCtrlReg <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">uint32_t</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uintptr_t</span><span class=\"token punctuation\">)</span> GPIOCTRL_BASE</pre></td></tr><tr><td data-num=\"47\"></td><td><pre>            <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>pin <span class=\"token operator\">/</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> GPIO_CTRL_REGS_STEP<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>    <span class=\"token comment\">// è¦è¢«ç½®ä½çš„å¼•è„šæ©ç è®¡ç®—</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>    pinMask <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">uint32_t</span><span class=\"token punctuation\">)</span> <span class=\"token number\">1U</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token punctuation\">(</span>pin <span class=\"token operator\">%</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>    <span class=\"token comment\">// ä¸€ä¸ª MUX ç®¡ç† 16 ä¸ªå¼•è„šï¼Œæ‰€ä»¥ å¯¹ 16 å–ä½™æ•°</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>    <span class=\"token comment\">// ä¹˜ 2 æ˜¯å› ä¸ºä¸€ä¸ªå¼•è„šå¯¹åº”ä¸¤ä¸ªä½ï¼Œæ¯è¿‡ä¸€ä¸ªå¼•è„šè¦ ç§»ä¸¤ä½</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>    muxPinMask <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint32_t</span><span class=\"token punctuation\">)</span> <span class=\"token number\">3U</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>pin <span class=\"token operator\">%</span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>    EALLOW<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>    <span class=\"token comment\">// è®¾ç½®ä¸ºè¾“å‡ºæ¨¡å¼</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>    gpioCtrlReg<span class=\"token punctuation\">[</span>GPIO_GPxDIR_INDEX<span class=\"token punctuation\">]</span> <span class=\"token operator\">|=</span> pinMask<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>    <span class=\"token comment\">// è®¾ç½®ä¸ºæ¨æŒ½è¾“å‡º</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>    gpioCtrlReg<span class=\"token punctuation\">[</span>GPIO_GPxODR_INDEX<span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;=</span> <span class=\"token operator\">~</span>pinMask<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>    <span class=\"token comment\">// è®¾ç½®ä½ é€šç”¨è¾“å‡ºæ¨¡å¼</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>pin <span class=\"token operator\">%</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">16</span> <span class=\"token operator\">>=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>    <span class=\"token comment\">// åˆ¤æ–­å¼•è„šå±äº MUX1 è¿˜æ˜¯ MUX2</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span><span class=\"token comment\">// ä¸ºä»€ä¹ˆ + 1 è€Œä¸æ˜¯ +2 æˆ‘ä¹Ÿæ²¡å¼„æ‡‚ï¼ŒæŒ å¤´ï¼Œç­‰å¼„æ‡‚å†æ›´æ–°</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>        gpioCtrlReg<span class=\"token punctuation\">[</span>GPIO_GPxMUX_INDEX <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;=</span> <span class=\"token operator\">~</span>muxPinMask<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>    <span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>        gpioCtrlReg<span class=\"token punctuation\">[</span>GPIO_GPxMUX_INDEX<span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;=</span> <span class=\"token operator\">~</span>muxPinMask<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>    EDIS<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre></pre></td></tr><tr><td data-num=\"72\"></td><td><pre><span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"73\"></td><td><pre> * @b æµ‹è¯•å‡½æ•°ï¼šäº§ç”Ÿ 6 ä¸ªæ–¹æ³¢</pre></td></tr><tr><td data-num=\"74\"></td><td><pre> */</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">test_function</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>    <span class=\"token class-name\">uint32_t</span> pin <span class=\"token operator\">=</span> <span class=\"token number\">24</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>    <span class=\"token class-name\">uint32_t</span> pinMask <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>    <span class=\"token keyword\">volatile</span> <span class=\"token class-name\">uint32_t</span> <span class=\"token operator\">*</span>gpioDataRegs <span class=\"token operator\">=</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>    gpioDataRegs <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">uint32_t</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uintptr_t</span><span class=\"token punctuation\">)</span> GPIODATA_BASE <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>pin <span class=\"token operator\">/</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">0x8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre>    pinMask <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">uint32_t</span><span class=\"token punctuation\">)</span> <span class=\"token number\">1U</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token punctuation\">(</span>pin <span class=\"token operator\">%</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">volatile</span> <span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">12</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre>        gpioDataRegs<span class=\"token punctuation\">[</span>GPIO_GPxTOGGLE_INDEX<span class=\"token punctuation\">]</span> <span class=\"token operator\">|=</span> pinMask<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre>        <span class=\"token keyword\">int</span> j <span class=\"token operator\">=</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre>        <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>j<span class=\"token operator\">--</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"89\"></td><td><pre>            <span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"90\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"91\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"ç°è±¡\"><a class=\"anchor\" href=\"#ç°è±¡\">#</a> ç°è±¡</h2>\n<p>äº§ç”Ÿ 6 ä¸ªæ–¹æ³¢</p>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.401bsws9ja00.jpg\" alt=\"image\" /></p>\n<h1 id=\"å·¥ç¨‹é“¾æ¥\"><a class=\"anchor\" href=\"#å·¥ç¨‹é“¾æ¥\">#</a> å·¥ç¨‹é“¾æ¥</h1>\n<p>ç”±äº device_support ç§»åŠ¨åä¾èµ–æœ‰ç‚¹éš¾ä¿®å¤ï¼Œæ‰€ä»¥å·¥ç¨‹æ–‡ä»¶ä¸­åªæœ‰ driverlib çš„å·¥ç¨‹é“¾æ¥<br />\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL3RvLXl3ei9EU1AyMzc5RA==\">ğŸ±</span>(â¬…ï¸ç‚¹æˆ‘)</p>\n<hr />\n<p>å¤§é“äº”åï¼Œå¤©è¡å››åä¹ï¼Œäººéå…¶ä¸€ï¼</p>\n",
            "tags": [
                "åµŒå…¥å¼",
                "DSP",
                "DSP"
            ]
        },
        {
            "id": "https://to-ywz.github.io/Embedded/Linux/%E6%A0%91%E8%8E%93%E6%B4%BE%E9%BB%98%E8%AE%A4%E5%AF%86%E7%A0%81%E6%97%A0%E6%B3%95%E7%99%BB%E5%BD%95/",
            "url": "https://to-ywz.github.io/Embedded/Linux/%E6%A0%91%E8%8E%93%E6%B4%BE%E9%BB%98%E8%AE%A4%E5%AF%86%E7%A0%81%E6%97%A0%E6%B3%95%E7%99%BB%E5%BD%95/",
            "title": "æ ‘è“æ´¾é»˜è®¤å¯†ç æ— æ³•ç™»å½•",
            "date_published": "2022-12-04T14:58:49.000Z",
            "content_html": "<h2 id=\"èµ·å› \"><a class=\"anchor\" href=\"#èµ·å› \">#</a> èµ·å› </h2>\n<p>æœ€è¿‘å¼€å§‹æ£é¼“æ ‘è“æ´¾ï¼Œä¹‹å‰é‚£å®ƒåšäº†ä¸ªæ—è·¯ç”±ï¼Œæœ€åå‘ç°ä½¿ç”¨ç‡å¤ªä½ï¼Œå‡†å¤‡æ¢æˆ Home Assistant</p>\n<p>ç»“æœåœ¨åˆ· Raspberry Pi OS çš„æ—¶å€™ï¼Œå‘ç°åˆ›å»º  <code>wpa_supplicant.conf</code>  å’Œ  <code>SSH</code>  æ–‡ä»¶çš„æ–¹å¼å®Œå…¨æ²¡æœ‰ç”¨äº†</p>\n<p>ä¸€å¼€å§‹æˆ‘ä»¥ä¸ºæ˜¯ wifi å¯†ç å¤§å°å†™é—®é¢˜ï¼Œæ”¹äº†å‡ æ¬¡éƒ½ä¸è¡Œï¼Œç„¶åæ¥å…¥æœ‰çº¿ç½‘ç»œåç™»å½• SSH å‘ç°ï¼Œé»˜è®¤çš„è´¦å·å¯†ç éƒ½ä¸å¥½ä½¿</p>\n<h2 id=\"ç»“æœ\"><a class=\"anchor\" href=\"#ç»“æœ\">#</a> ç»“æœ</h2>\n<p>åˆ°å®˜ç½‘æŸ¥é˜…äº†ä¸€ä¸‹æ›´æ–°è®°å½•ï¼Œå‘ç°</p>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.7bi1e1dof300.webp\" alt=\"image\" /></p>\n<p>å¤§è‡´æ„æ€å°±æ˜¯ï¼Œä¸ºäº†å®‰å…¨èµ·è§åˆ é™¤äº†é»˜è®¤è´¦å·</p>\n<h2 id=\"è§£å†³æ–¹æ³•\"><a class=\"anchor\" href=\"#è§£å†³æ–¹æ³•\">#</a> è§£å†³æ–¹æ³•</h2>\n<h3 id=\"æ–¹æ¡ˆä¸€æ¨è\"><a class=\"anchor\" href=\"#æ–¹æ¡ˆä¸€æ¨è\">#</a> æ–¹æ¡ˆä¸€ (æ¨è)</h3>\n<p>ä½¿ç”¨å®˜æ–¹çš„çƒ§å½•è½¯ä»¶:<span class=\"exturl\" data-url=\"aHR0cHM6Ly9kb3dubG9hZHMucmFzcGJlcnJ5cGkub3JnL2ltYWdlci9pbWFnZXJfMS43LjMuZXhl\"> åœ°å€</span></p>\n<p>æœ‰æ¢¯å­çš„å»ºè®®å…³æ‰å“¦ï¼Œæˆ‘æŒ‚æ¢¯å­åè€Œä¸‹çš„æ…¢</p>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.4gbdvpyp1s40.webp\" alt=\"image\" /></p>\n<h3 id=\"æ–¹æ¡ˆäºŒ\"><a class=\"anchor\" href=\"#æ–¹æ¡ˆäºŒ\">#</a> æ–¹æ¡ˆäºŒ</h3>\n<p>è¯´å®è¯ï¼Œç¬¬ä¸€ç§æ–¹æ³•æœ€å¤§çš„é—®é¢˜å°±æ˜¯æ…¢ï¼Œç£¨ç£¨å”§å”§çš„è£…ä¸ª 64bit ç‰ˆæœ¬ç®€ç›´çš„æ²¡è¯è¯´ï¼ˆå¯ä»¥å®‰å¿ƒçš„å‡ºå»åƒä¸ªé¥­å†å›æ¥çœ‹çœ‹ï¼‰ã€‚</p>\n<p>æ‰€ä»¥ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥è€ƒè™‘é€šè¿‡åœ¨ SD çš„å¯åŠ¨åˆ†åŒºä¸­åˆ›å»ºä¸€ä¸ªåä¸º  <code>userconf</code>  æˆ–  <code>userconf.txt</code>  çš„æ–‡ä»¶ï¼Œæ·»åŠ ç”¨æˆ·åå’Œå¯†ç </p>\n<p>å†…å®¹æ ¼å¼ä¸º  <code>username:encrypted-password</code> , å…¶ä¸­  <code>username</code>  æ˜¯ç”¨æˆ·åï¼Œ <code>encrypted-password</code>  æ˜¯å¯†ç çš„åŠ å¯†ä»£ç  (é€šè¿‡ OpenSSL ç”Ÿæˆ)</p>\n<p>é€šè¿‡ OpenSSL ç”ŸæˆåŠ å¯†å¯†ç çš„æŒ‡ä»¤</p>\n<pre><code>echo 'mypassword' | openssl passwd -6 -stdin\n</code></pre>\n<p>é‡Œé¢çš„  <code>'password'</code>  è‡ªè¡Œæ›¿æ¢æˆè‡ªå·±çš„å¯†ç </p>\n<p>è¿™é‡Œå¯ä»¥æä¾›ä¸€ä¸ªç°æˆçš„</p>\n<pre><code>pi:$6$Q7yQqYO94B9fI9jn$trNI8/yvcZ8WYleaYKN5qlrzQ3AhZXLZtcNkYJlSH16xGloh2ZiM4KeAay8GSBoQ09LZI/wMOxM3qeou7uZXq.\n</code></pre>\n<p>å¯¹åº”çš„è´¦å·å¯†ç å°±æ˜¯ä¹‹å‰çš„é»˜è®¤è´¦å·å¯†ç   <code>pi:raspberry</code></p>\n<hr />\n<p>å¤§é“äº”åï¼Œå¤©è¡å››åä¹ï¼Œäººéå…¶ä¸€ï¼</p>\n",
            "tags": [
                "åµŒå…¥å¼",
                "Linux",
                "Raspberry Pi",
                "æ ‘è“æ´¾"
            ]
        },
        {
            "id": "https://to-ywz.github.io/tool/HAL%E5%BA%93%E5%87%BA%E7%8E%B0HAL_StatusTypeDef%E6%97%A0%E6%B3%95%E8%AF%86%E5%88%AB/",
            "url": "https://to-ywz.github.io/tool/HAL%E5%BA%93%E5%87%BA%E7%8E%B0HAL_StatusTypeDef%E6%97%A0%E6%B3%95%E8%AF%86%E5%88%AB/",
            "title": "HALåº“å‡ºç°HAL_StatusTypeDefæ— æ³•è¯†åˆ«",
            "date_published": "2022-11-22T05:14:07.000Z",
            "content_html": "<h1 id=\"é—®é¢˜\"><a class=\"anchor\" href=\"#é—®é¢˜\">#</a> é—®é¢˜</h1>\n<p>ä»Šå¤©é‡æ–°å†™äº†ä¸€ä¸ª gpio çš„æŠ½è±¡å±‚ï¼Œç»“æœç¼–è¯‘çš„æ—¶å€™å‡ºç°äº†ä¸€ä¸ª bug: <code>HAL_StatusTypeDef</code>  æ— æ³•è¯†åˆ«<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.5wq5i5adpug0.jpg\" alt=\"image\" /><br />\n ä¸€çœ‹è¿™ç§é—®é¢˜ï¼Œæ¶‰åŠåº“æ–‡ä»¶ä¸æ˜¯å¤´æ–‡ä»¶å¼•ç”¨é”™å°±æ˜¯ï¼Œæ— æ„ä¸­æ”¹åŠ¨äº†å®.</p>\n<h1 id=\"æ€è€ƒ\"><a class=\"anchor\" href=\"#æ€è€ƒ\">#</a> æ€è€ƒ</h1>\n<p>ç”±äºæˆ‘çš„å·¥ç¨‹æ˜¯ç›´æ¥ä» CubeMX ä¸­ç”Ÿæˆçš„æ‰€ä»¥ä¸å­˜åœ¨ä»€ä¹ˆå®æ”¹é”™çš„é—®é¢˜<br />\né‚£å°±åˆ°äº†å¤´æ–‡ä»¶çš„é—®é¢˜äº†ï¼Œé¦–å…ˆè€ƒè™‘è‡ªå·±ç¼–å†™çš„ <code>gpio</code>  æ–‡ä»¶<br />\næˆ‘çš„æºç ä¸­åªæœ‰ä¸€ä¸ªå¤´æ–‡ä»¶ä¸ HAL ç›¸å…³<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.6wfazdj3i5s0.jpg\" alt=\"image\" /><br />\n å¾ˆæ˜¾ç„¶æœ‰ä¸€åŠçš„å¯èƒ½æ˜¯  <code>stm32f4xx_hal_gpio.h</code>  æƒ¹çš„ç¥¸.<br />\n æ‰€ä»¥æˆ‘å°†  <code>stm32f4xx_hal_gpio.h</code>  æ›¿æ¢ä¸º  <code>main.h</code> <br />\n ç¼–è¯‘å  <code>0 error 0 wraning</code> , æœç„¶æ˜¯æ‰¾ä¸ªçš„é—®é¢˜.<br />\n ä½†å‡ºç°äº†æ–°çš„é—®é¢˜ï¼Œä¸ºå•¥ <code>main.h</code>  å¯ä»¥ è€Œ <code>stm32f4xx_hal_gpio.h</code>  ä¸å¯ä»¥<br />\nç»è¿‡å¤šæ¬¡è½¬è·³ï¼Œåœ¨ <code>stm32f4xx_hal_conf</code>  ä¸­ï¼Œçœ‹åˆ°äº†äº†è¿™éƒ¨åˆ† å®<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.3vtw1rk50o80.jpg\" alt=\"image\" /><br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/2023/image.1vczkfxpj4v4.jpg\" alt=\"image\" /><br />\n æˆ‘ä¸¥é‡æ€€ç–‘ï¼Œæ˜¯ä¸æ˜¯å› ä¸ºå®å¼€å…³çš„é—®é¢˜ï¼Œé™åˆ¶äº† <code>stm32f4xx_hal_gpio.h</code>  å†…éƒ¨çš„ä¸€äº›å®šä¹‰<br />\nä½†æ˜¯è¿›å…¥ <code>stm32f4xx_hal_gpio.h</code>  ä¸­æŸ¥çœ‹æ‰¾ä¸åˆ°æœ‰å®çš„å¼€å…³ï¼Œæ‰€ä»¥æˆ‘è®¤ä¸ºå¯èƒ½æ˜¯å•ç‹¬çš„ <code>stm32f4xx_hal_gpio.h</code>  æ–‡ä»¶ä¸è¶³ä»¥æ„æˆå®Œæ•´çš„æ–‡ä»¶ï¼Œç¼ºå°‘éƒ¨åˆ†æ–‡ä»¶ä¾èµ–è€Œå¯¼è‡´çš„.<br />\n è™½ç„¶å¯ä»¥è¿™ä¹ˆè§£é‡Šä½†æ˜¯ï¼Œè¿˜æ˜¯è§‰å¾—æ€ªæ€ªçš„ã€‚ç­‰ä»¥åæ‹æ¸…æ¥šäº†å†å›æ¥ç»§ç»­æ›´.<br />\n-------------------2023.2.8----------------------------</p>\n<hr />\n<p>å¤§é“äº”åï¼Œå¤©è¡å››åä¹ï¼Œäººéå…¶ä¸€ï¼</p>\n",
            "tags": [
                "å¼€å‘å·¥å…·",
                "HALåº“",
                "HALåº“"
            ]
        },
        {
            "id": "https://to-ywz.github.io/Embedded/STM32/STM32%E8%A3%B8%E6%9C%BA%E7%A7%BB%E6%A4%8DSFUD/",
            "url": "https://to-ywz.github.io/Embedded/STM32/STM32%E8%A3%B8%E6%9C%BA%E7%A7%BB%E6%A4%8DSFUD/",
            "title": "STM32è£¸æœºç§»æ¤SFUD",
            "date_published": "2021-12-12T14:18:49.000Z",
            "content_html": "<p><strong>å†™åœ¨å‰é¢:</strong> å¹³å°: STM32F407VGT6 + W25Q64FV 8MFLASH</p>\n<h1 id=\"ä¸ºä»€ä¹ˆè¦ç§»æ¤sfud\"><a class=\"anchor\" href=\"#ä¸ºä»€ä¹ˆè¦ç§»æ¤sfud\">#</a> ä¸ºä»€ä¹ˆè¦ç§»æ¤ SFUD</h1>\n<p>è®°å¾—å½“åˆå­¦æ ‡å‡†åº“è¯»å†™ FLASH çš„æ—¶å€™ï¼Œé¡µå†™å…¥ä»£ç å¯é•¿å¯é•¿äº†ï¼Œè€Œä¸”ä¸åŒçš„ flash ä¸€å¥—æ£€æµ‹çš„å®ä¸ä¸€æ ·ï¼Œæ”¹æ¥æ”¹å»ç‰¹åˆ«éº»çƒ¦.<br />\n è€Œ SFUD é©±åŠ¨åªéœ€è¦ FLASH æ”¯æŒ SFDP åè®®å³å¯ç§»æ¤ SFUD ååªéœ€å®ç°åˆå§‹åŒ–å’Œå†™æ“ä½œå°±å¯ä»¥æ„‰å¿«çš„ä½¿ç”¨ FLASH. è†œæ‹œ armlink å¤§ä½¬.<br />\n æ˜¯ JEDEC (å›ºæ€æŠ€æœ¯åä¼š) åˆ¶å®šçš„ä¸²è¡Œ Flash åŠŸèƒ½çš„å‚æ•°è¡¨æ ‡å‡†ï¼Œ<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuamVkZWMub3JnL3N0YW5kYXJkcy1kb2N1bWVudHMvZG9jcy9qZXNkMjE2Yg==\"> æœ€æ–°æ ‡å‡†</span>ï¼Œç›®å‰æ–°ç”Ÿäº§çš„ flash éƒ½æ˜¯æ”¯æŒçš„åªæœ‰ç‰¹åˆ«è€æ—§çš„èŠ¯ç‰‡æ‰ä¸æ”¯æŒ.<br />\n è€Œä¸” SFUD å¯¹äºä¸æ”¯æŒ SFDP çš„ FLASH, å¯ä»¥æ‰‹åŠ¨åœ¨ <code>/sfud/inc/sfud_flash_def.h</code>  æ–‡ä»¶ä¸­çš„å‚æ•°è¡¨é‡Œæ·»åŠ èŠ¯ç‰‡å‚æ•°.<br />\n ç®€ç›´å°±æ˜¯äººé—´ç¥å¥‡</p>\n<h1 id=\"æºç è·å–\"><a class=\"anchor\" href=\"#æºç è·å–\">#</a> æºç è·å–</h1>\n<p>å»ºè®®ç›´æ¥ä» github æˆ– gitee ä¸Šæ‹‰å–ï¼Œèƒ½ä¿è¯ä»£ç æ˜¯æœ€æ–°çš„ (3 å¹´å°±å†™äº†è¿™ä¸ªåº“ï¼Œåˆ°ç°åœ¨éƒ½è¿˜åœ¨æ›´æ–°ï¼Œäººä¸äººä¹‹é—´çš„å·®è·å•Š...).<br />\n å¦‚æœä¸æƒ³ç”¨ git æ‹‰å»çš„è¯ï¼Œå¯ä»¥ç›´æ¥ç‚¹å‡»ä¸‹é¢çš„é˜¿é‡Œäº‘é“¾æ¥è¿›è¡Œä¸‹è½½ã€‚ç™¾åº¦ç½‘ç›˜è¿™é‡Œå°±å…ˆä¸æ”¾äº† (<s>å«Œå¼ƒ</s>)<br />\nGithub<span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2FybWluay9TRlVE\"> ä¼ é€é—¨</span><br />\n Gitee<span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRlZS5jb20vQXJtaW5rL1NGVUQ=\"> ä¼ é€é—¨</span><br />\né˜¿é‡Œäº‘ç›˜<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYWxpeXVuZHJpdmUuY29tL3MvRGQyTlBmWE1SR3o=\">ä¼ é€é—¨</span></p>\n<h1 id=\"æ–‡ä»¶ç»“æ„\"><a class=\"anchor\" href=\"#æ–‡ä»¶ç»“æ„\">#</a> æ–‡ä»¶ç»“æ„</h1>\n<p><img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/before2022/20211216074525.png\" alt=\"æ ¹ç›®å½•\" /><br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/before2022/20211216074949.png\" alt=\"demo\" /><br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/before2022/20211216074707.png\" alt=\"sfud\" /></p>\n<h1 id=\"ç§»æ¤\"><a class=\"anchor\" href=\"#ç§»æ¤\">#</a> ç§»æ¤</h1>\n<p>ä¸»è¦æ˜¯å®ç° <code>/sfud/port/sfud_port.c</code>  æ–‡ä»¶ï¼Œå…¶å®æˆ‘ä»¬åªéœ€è¦å®ç°  <code>sfud_spi_port_init</code> ,  <code>spi_write_read</code> , å³å¯è‡³äºæ›´å¤šçš„éœ€æ±‚ï¼Œå¯ä»¥è§† init å‡½æ•°é‡Œçš„æ³¨é‡Šè‡ªè¡Œæ‰©å……<br />\nç”±äº sfud æœ‰ debug æœºåˆ¶ï¼Œæ‰€ä»¥éœ€è¦å„ä½è‡ªè¡Œå®ç° printf çš„é‡è½½.</p>\n<h2 id=\"sfud_spi_port_init\"><a class=\"anchor\" href=\"#sfud_spi_port_init\">#</a> sfud_spi_port_init</h2>\n<p>å…¶å®è¦å®ç°é‚£äº›å‡½æ•°åœ¨æ³¨é‡Šä¸­å·²ç»å†™çš„æ˜æ˜ç™½ç™½äº†.<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/before2022/20211216080503.png\" alt=\"initå‡½æ•°å®ç°\" /></p>\n<h3 id=\"æŠ½ä¸ªç»“æ„ä½“å‡ºæ¥\"><a class=\"anchor\" href=\"#æŠ½ä¸ªç»“æ„ä½“å‡ºæ¥\">#</a> æŠ½ä¸ªç»“æ„ä½“å‡ºæ¥</h3>\n<p>ä¸ºäº†æ–¹ä¾¿å¤„ç†è¿™è¾¹ç”¨äº†ä¸€ä¸ªç»“æ„ä½“ï¼Œç”¨äºä¿å­˜ç”¨æˆ·çš„ SPI ä¿¡æ¯ã€‚æ‡’æƒ°ï¼Œæˆ‘è¿ä¸ª Led éƒ½æƒ³ æŠ½è±¡æˆç»“æ„ä½“</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">typedef</span> <span class=\"token keyword\">struct</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    SPI_TypeDef <span class=\"token operator\">*</span>spix<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    GPIO_TypeDef <span class=\"token operator\">*</span>cs_gpiox<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token class-name\">uint16_t</span> cs_gpio_pin<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#125;</span> spi_user_data<span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span><span class=\"token class-name\">spi_user_data_t</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">static</span> spi_user_data spi1 <span class=\"token operator\">=</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">.</span>spix <span class=\"token operator\">=</span> SPI1<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>     <span class=\"token punctuation\">.</span>cs_gpiox <span class=\"token operator\">=</span> GPIOB<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>     <span class=\"token punctuation\">.</span>cs_gpio_pin <span class=\"token operator\">=</span> GPIO_Pin_0<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h3 id=\"åˆå§‹åŒ–å‡½æ•°\"><a class=\"anchor\" href=\"#åˆå§‹åŒ–å‡½æ•°\">#</a> åˆå§‹åŒ–å‡½æ•°</h3>\n<p>è¿™é‡Œå¯ä»¥æŠ½ä¸€å±‚å‡½æ•°å‡ºæ¥ï¼Œå†™ä¸€ä¸ªæŸä¸ªå‹å·çš„ FLASH åˆå§‹åŒ–å‡½æ•°ï¼Œç„¶åæ”¾åœ¨ case ä¸­è°ƒç”¨<br />\næ€ä¹ˆæ„Ÿè§‰æˆ‘æ€»å–œæ¬¢ç–¯ç‹‚å¥—å¨ƒ</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>sfud_err <span class=\"token function\">sfud_spi_port_init</span><span class=\"token punctuation\">(</span>sfud_flash <span class=\"token operator\">*</span>flash<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    sfud_err result <span class=\"token operator\">=</span> SFUD_SUCCESS<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>flash<span class=\"token operator\">-></span>index<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">case</span> SFUD_W25Q64FV_DEVICE_INDEX<span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token comment\">/* RCC åˆå§‹åŒ– */</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token function\">rcc_configuration</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>spi1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token comment\">/* GPIO åˆå§‹åŒ– */</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token function\">gpio_configuration</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>spi1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token comment\">/* SPI å¤–è®¾åˆå§‹åŒ– */</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token function\">spi_configuration</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>spi1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token comment\">/* åŒæ­¥ Flash ç§»æ¤æ‰€éœ€çš„æ¥å£åŠæ•°æ® */</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        flash<span class=\"token operator\">-></span>spi<span class=\"token punctuation\">.</span>wr <span class=\"token operator\">=</span> spi_write_read<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        flash<span class=\"token operator\">-></span>spi<span class=\"token punctuation\">.</span>lock <span class=\"token operator\">=</span> spi_lock<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        flash<span class=\"token operator\">-></span>spi<span class=\"token punctuation\">.</span>unlock <span class=\"token operator\">=</span> spi_unlock<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        flash<span class=\"token operator\">-></span>spi<span class=\"token punctuation\">.</span>user_data <span class=\"token operator\">=</span> <span class=\"token operator\">&amp;</span>spi1<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token comment\">/* about 100 microsecond delay */</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        flash<span class=\"token operator\">-></span>retry<span class=\"token punctuation\">.</span>delay <span class=\"token operator\">=</span> retry_delay_100us<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token comment\">/* adout 60 seconds timeout */</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        flash<span class=\"token operator\">-></span>retry<span class=\"token punctuation\">.</span>times <span class=\"token operator\">=</span> <span class=\"token number\">60</span> <span class=\"token operator\">*</span> <span class=\"token number\">10000</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token keyword\">return</span> result<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h3 id=\"ç¡¬ä»¶é…ç½®\"><a class=\"anchor\" href=\"#ç¡¬ä»¶é…ç½®\">#</a> ç¡¬ä»¶é…ç½®</h3>\n<p>è¿™é‡Œæˆ‘ç”¨çš„ SPI1 è½¯ä»¶ç‰‡é€‰ï¼Œå¼•è„šèµ°çš„ GPIOB3, GPIOB4, GPIOB5, GPIO0 (CS)<br />\n QSPI åœ¨ 407 ä¸Šæ²¡æœ‰ï¼Œæ‰€ä»¥æˆ‘å…ˆä¸å†™äº†ï¼Œç­‰æˆ‘æœ‰é’±ææ–°æ¿å­äº†åœ¨è€ƒè™‘å¦‚ä½•å®ç° (å…¶å®ç”¨ HAL åº“æ‰æ˜¯è¶‹åŠ¿...).</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"2\"></td><td><pre> * @brief       SPI æ—¶é’Ÿä½¿èƒ½</pre></td></tr><tr><td data-num=\"3\"></td><td><pre> *</pre></td></tr><tr><td data-num=\"4\"></td><td><pre> * @param spi   SPI ç»“æ„ä½“</pre></td></tr><tr><td data-num=\"5\"></td><td><pre> */</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">rcc_configuration</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">spi_user_data_t</span> spi<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>spi<span class=\"token operator\">-></span>spix <span class=\"token operator\">==</span> SPI1<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        RCC<span class=\"token operator\">-></span>APB2ENR <span class=\"token operator\">|=</span> RCC_APB2ENR_SPI1EN<span class=\"token punctuation\">;</span>  <span class=\"token comment\">// SPI  Clock Enable</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        RCC<span class=\"token operator\">-></span>AHB1ENR <span class=\"token operator\">|=</span> RCC_AHB1ENR_GPIOBEN<span class=\"token punctuation\">;</span> <span class=\"token comment\">// GPIO Clock Enable</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"16\"></td><td><pre> * @brief       é…ç½® SPI çš„ GPIO</pre></td></tr><tr><td data-num=\"17\"></td><td><pre> *</pre></td></tr><tr><td data-num=\"18\"></td><td><pre> * @param spi   SPI ç»“æ„ä½“</pre></td></tr><tr><td data-num=\"19\"></td><td><pre> */</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">gpio_configuration</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">spi_user_data_t</span> spi<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    GPIO_InitTypeDef GPIO_InitStructure<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>spi<span class=\"token operator\">-></span>spix <span class=\"token operator\">==</span> SPI1<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token comment\">/* SCK:PB3  MISO:PB4  MOSI:PA5 */</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        GPIO_InitStructure<span class=\"token punctuation\">.</span>GPIO_Pin <span class=\"token operator\">=</span> GPIO_Pin_5 <span class=\"token operator\">|</span> GPIO_Pin_4 <span class=\"token operator\">|</span> GPIO_Pin_3<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        GPIO_InitStructure<span class=\"token punctuation\">.</span>GPIO_Speed <span class=\"token operator\">=</span> GPIO_Speed_50MHz<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        GPIO_InitStructure<span class=\"token punctuation\">.</span>GPIO_Mode <span class=\"token operator\">=</span> GPIO_Mode_AF<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        GPIO_InitStructure<span class=\"token punctuation\">.</span>GPIO_OType <span class=\"token operator\">=</span> GPIO_OType_PP<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        <span class=\"token function\">GPIO_PinAFConfig</span><span class=\"token punctuation\">(</span>GPIOB<span class=\"token punctuation\">,</span> GPIO_PinSource3<span class=\"token punctuation\">,</span> GPIO_AF_SPI1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        <span class=\"token function\">GPIO_PinAFConfig</span><span class=\"token punctuation\">(</span>GPIOB<span class=\"token punctuation\">,</span> GPIO_PinSource4<span class=\"token punctuation\">,</span> GPIO_AF_SPI1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        <span class=\"token function\">GPIO_PinAFConfig</span><span class=\"token punctuation\">(</span>GPIOB<span class=\"token punctuation\">,</span> GPIO_PinSource5<span class=\"token punctuation\">,</span> GPIO_AF_SPI1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token function\">GPIO_Init</span><span class=\"token punctuation\">(</span>GPIOB<span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>GPIO_InitStructure<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>        <span class=\"token comment\">/* CS: PB0 */</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>        GPIO_InitStructure<span class=\"token punctuation\">.</span>GPIO_Pin <span class=\"token operator\">=</span> GPIO_Pin_0<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        GPIO_InitStructure<span class=\"token punctuation\">.</span>GPIO_Speed <span class=\"token operator\">=</span> GPIO_Speed_50MHz<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>        GPIO_InitStructure<span class=\"token punctuation\">.</span>GPIO_Mode <span class=\"token operator\">=</span> GPIO_Mode_OUT<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>        <span class=\"token function\">GPIO_Init</span><span class=\"token punctuation\">(</span>GPIOB<span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>GPIO_InitStructure<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>        <span class=\"token function\">GPIO_SetBits</span><span class=\"token punctuation\">(</span>GPIOB<span class=\"token punctuation\">,</span> GPIO_Pin_0<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre></pre></td></tr><tr><td data-num=\"46\"></td><td><pre><span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"47\"></td><td><pre> * @brief       é…ç½® SPI å·¥ä½œæ¨¡å¼</pre></td></tr><tr><td data-num=\"48\"></td><td><pre> *</pre></td></tr><tr><td data-num=\"49\"></td><td><pre> * @param spi   SPI ç»“æ„ä½“</pre></td></tr><tr><td data-num=\"50\"></td><td><pre> */</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre><span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">spi_configuration</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">spi_user_data_t</span> spi<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>    SPI_InitTypeDef SPI_InitStructure<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>    SPI_InitStructure<span class=\"token punctuation\">.</span>SPI_Direction <span class=\"token operator\">=</span> SPI_Direction_2Lines_FullDuplex<span class=\"token punctuation\">;</span> <span class=\"token comment\">// SPI è®¾ç½®ä¸ºåŒçº¿åŒå‘å…¨åŒå·¥</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>    SPI_InitStructure<span class=\"token punctuation\">.</span>SPI_Mode <span class=\"token operator\">=</span> SPI_Mode_Master<span class=\"token punctuation\">;</span>                      <span class=\"token comment\">// è®¾ç½®ä¸ºä¸» SPI</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>    SPI_InitStructure<span class=\"token punctuation\">.</span>SPI_DataSize <span class=\"token operator\">=</span> SPI_DataSize_8b<span class=\"token punctuation\">;</span>                  <span class=\"token comment\">// SPI å‘é€æ¥æ”¶ 8 ä½å¸§ç»“æ„</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>    SPI_InitStructure<span class=\"token punctuation\">.</span>SPI_CPOL <span class=\"token operator\">=</span> SPI_CPOL_Low<span class=\"token punctuation\">;</span>                         <span class=\"token comment\">// æ—¶é’Ÿæ‚¬ç©ºä½</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>    SPI_InitStructure<span class=\"token punctuation\">.</span>SPI_CPHA <span class=\"token operator\">=</span> SPI_CPHA_1Edge<span class=\"token punctuation\">;</span>                       <span class=\"token comment\">// æ•°æ®æ•è·äºç¬¬ä¸€ä¸ªæ—¶é’Ÿæ²¿</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"61\"></td><td><pre>    SPI_InitStructure<span class=\"token punctuation\">.</span>SPI_NSS <span class=\"token operator\">=</span> SPI_NSS_Soft<span class=\"token punctuation\">;</span>                          <span class=\"token comment\">// å†…éƒ¨  NSS ä¿¡å·ç”± SSI ä½æ§åˆ¶</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>    SPI_InitStructure<span class=\"token punctuation\">.</span>SPI_BaudRatePrescaler <span class=\"token operator\">=</span> SPI_BaudRatePrescaler_2<span class=\"token punctuation\">;</span> <span class=\"token comment\">// æ³¢ç‰¹ç‡é¢„åˆ†é¢‘å€¼ä¸º 2</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>    SPI_InitStructure<span class=\"token punctuation\">.</span>SPI_FirstBit <span class=\"token operator\">=</span> SPI_FirstBit_MSB<span class=\"token punctuation\">;</span>                 <span class=\"token comment\">// æ•°æ®ä¼ è¾“ä» MSB ä½å¼€å§‹</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>    SPI_InitStructure<span class=\"token punctuation\">.</span>SPI_CRCPolynomial <span class=\"token operator\">=</span> <span class=\"token number\">7</span><span class=\"token punctuation\">;</span>                           <span class=\"token comment\">// CRC å€¼è®¡ç®—çš„å¤šé¡¹å¼ï¼Œä¸ä½¿èƒ½ CRC æœ‰æ•ˆä½é…ç½®å•¥éƒ½æ— æ‰€è°“</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>    <span class=\"token function\">SPI_I2S_DeInit</span><span class=\"token punctuation\">(</span>spi<span class=\"token operator\">-></span>spix<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>    <span class=\"token function\">SPI_Init</span><span class=\"token punctuation\">(</span>spi<span class=\"token operator\">-></span>spix<span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>SPI_InitStructure<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>    <span class=\"token function\">SPI_CalculateCRC</span><span class=\"token punctuation\">(</span>spi<span class=\"token operator\">-></span>spix<span class=\"token punctuation\">,</span> DISABLE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>    <span class=\"token function\">SPI_Cmd</span><span class=\"token punctuation\">(</span>spi<span class=\"token operator\">-></span>spix<span class=\"token punctuation\">,</span> ENABLE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>æˆ‘è§‰å¾—ï¼Œè¿™ä»½ä»£ç   <code>rcc_configuration</code>  å’Œ  <code>gpio_configuration</code>  å¯ä»¥å†æŠ½ä¸€å±‚å‡ºæ¥ï¼Œåœ¨é‡Œé¢æ”¾ç½®ä¸€ä¸ª  <code>switch case</code>  è°ƒç”¨ SPIx (x ç”±ç‰‡ä¸Š SPI æ•°é‡å†³å®š) çš„åˆå§‹åŒ–.<br />\n ä½†æ˜¯ç°åœ¨åœ¨åšé¡¹ç›®ï¼Œä¹Ÿåªå¯èƒ½æœ‰ä¸€ä¸ª FLASH, åªèƒ½å…ˆè¿™æ ·å­äº†ã€‚ç­‰é¡¹ç›®ç»“æŸæˆ‘å†æ›´æ–°ä¸€ä¸‹.</p>\n<h2 id=\"spi-é”\"><a class=\"anchor\" href=\"#spi-é”\">#</a> SPI é”</h2>\n<p>è¿™ä¸€ä¸ªå¯ä»¥å®ç°ä¹Ÿå¯ä»¥ä¸å®ç°ï¼Œä¸»è¦çœ‹è‡ªå·±çš„éœ€æ±‚ï¼Œå¦‚æœçš„å†™çš„æ•°æ®å¾ˆå¤§æˆ‘å»ºè®®è¿˜æ˜¯å®ç°ä¸€ä¸‹.<br />\n å…¶å®å°±æ˜¯å…³ä¸­æ–­è¿™ç§æš´åŠ›çš„æ–¹æ³•è€Œå·²...</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">spi_lock</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> sfud_spi <span class=\"token operator\">*</span>spi<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token function\">__disable_irq</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">spi_unlock</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> sfud_spi <span class=\"token operator\">*</span>spi<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token function\">__enable_irq</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"å»¶æ—¶\"><a class=\"anchor\" href=\"#å»¶æ—¶\">#</a> å»¶æ—¶</h2>\n<p>è¿™ä¸ªæ˜¯æ³¨é‡Šé‡Œè¦æ±‚ä¸€å®šéœ€è¦å®ç°çš„ï¼Œæˆ‘è¿™é‡Œèµ°çš„æ˜¯  <code>systick</code>  å®ç°çš„ ys çº§å»¶æ—¶ã€‚åæ­£ 100us å·¦å³å³å¯ï¼Œå¯ä»¥è‡ªè¡Œå®ç° (å¤§ä¸äº† count--, ç‹—å¤´).</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">retry_delay_100us</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token comment\">// uint32_t delay = 120;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token comment\">// while (delay--)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token comment\">//     ;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token function\">delayus</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"spi_write_read\"><a class=\"anchor\" href=\"#spi_write_read\">#</a> spi_write_read</h2>\n<p>å‡½æ•°æ¥å£å¦‚ä¸‹:</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">static</span> sfud_err <span class=\"token function\">spi_write_read</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> sfud_spi <span class=\"token operator\">*</span>spi<span class=\"token punctuation\">,</span>       <span class=\"token comment\">// sfud</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>                                <span class=\"token keyword\">const</span> <span class=\"token class-name\">uint8_t</span> <span class=\"token operator\">*</span>write_buf<span class=\"token punctuation\">,</span> </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>                                <span class=\"token class-name\">size_t</span> write_size<span class=\"token punctuation\">,</span> </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>                                <span class=\"token class-name\">uint8_t</span> <span class=\"token operator\">*</span>read_buf<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>                                <span class=\"token class-name\">size_t</span> read_size<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>å¥½å¤šå‚æ•°..., å…¶å®å®ç°èµ·æ¥å’Œæˆ‘ä»¬ç›´æ¥å†™è‡ªå·±å®ç° è¿ç»­å†™ spi æ²¡ä»€ä¹ˆåŒºåˆ«.<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/before2022/20211216084441.png\" alt=\"ä¸Šé¢ä»£ç é‡Œçš„å¼ºè½¬è½¬çš„æ˜¯è¿™ä¸ªç»“æ„ä½“é‡Œçš„void ç±»å‹\" /><br />\nå”¯ä¸€è¦æ³¨æ„çš„åªæœ‰è¿™ä¸ªåœ°æ–¹ï¼Œè·å– sfud çš„æŒ‡å‘çš„ spi è®¾å¤‡ï¼Œå¦‚ä¸Šæ‰€ç¤º.<br />\n å…¶ä»–çš„æ— éå°±ï¼Œå…ˆå†™å…¥æœ‰æ•ˆæ•°æ®ï¼Œç„¶åå†å†™å…¥æ— æ•ˆæ•°æ®ä½œä¸ºæ•°æ®è¯»å–ã€‚ä¸€å…±å†™å…¥ read_size+write_size å­—èŠ‚çš„æ•°æ®</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"2\"></td><td><pre> * @brief               SPI å†™å…¥åè¯»å‡ºæ•°æ®</pre></td></tr><tr><td data-num=\"3\"></td><td><pre> *</pre></td></tr><tr><td data-num=\"4\"></td><td><pre> * @param spi           SPI ç»“æ„ä½“</pre></td></tr><tr><td data-num=\"5\"></td><td><pre> * @param write_buf     è¦å†™å…¥çš„æ•°æ®</pre></td></tr><tr><td data-num=\"6\"></td><td><pre> * @param write_size    å†™å…¥æ•°æ®å¤§å°</pre></td></tr><tr><td data-num=\"7\"></td><td><pre> * @param read_buf      è¦è¯»å‡ºçš„æ•°æ®çš„ç¼“å­˜</pre></td></tr><tr><td data-num=\"8\"></td><td><pre> * @param read_size     è¦è¯»å‡ºçš„æ•°æ®å¤§å°</pre></td></tr><tr><td data-num=\"9\"></td><td><pre> * @return sfud_err     æ‰§è¡Œç»“æœ</pre></td></tr><tr><td data-num=\"10\"></td><td><pre> */</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">static</span> sfud_err <span class=\"token function\">spi_write_read</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> sfud_spi <span class=\"token operator\">*</span>spi<span class=\"token punctuation\">,</span> <span class=\"token keyword\">const</span> <span class=\"token class-name\">uint8_t</span> <span class=\"token operator\">*</span>write_buf<span class=\"token punctuation\">,</span> <span class=\"token class-name\">size_t</span> write_size<span class=\"token punctuation\">,</span> <span class=\"token class-name\">uint8_t</span> <span class=\"token operator\">*</span>read_buf<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>                               <span class=\"token class-name\">size_t</span> read_size<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    sfud_err result <span class=\"token operator\">=</span> SFUD_SUCCESS<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token class-name\">uint8_t</span> send_data<span class=\"token punctuation\">,</span> read_data<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token class-name\">spi_user_data_t</span> spi_dev <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">spi_user_data_t</span><span class=\"token punctuation\">)</span>spi<span class=\"token operator\">-></span>user_data<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>write_size<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token function\">SFUD_ASSERT</span><span class=\"token punctuation\">(</span>write_buf<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>read_size<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token function\">SFUD_ASSERT</span><span class=\"token punctuation\">(</span>read_buf<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token function\">GPIO_ResetBits</span><span class=\"token punctuation\">(</span>spi_dev<span class=\"token operator\">-></span>cs_gpiox<span class=\"token punctuation\">,</span> spi_dev<span class=\"token operator\">-></span>cs_gpio_pin<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token comment\">/* å¼€å§‹è¯»å†™æ•°æ® */</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">size_t</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> retry_times<span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> write_size <span class=\"token operator\">+</span> read_size<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>        <span class=\"token comment\">/* å…ˆå†™ç¼“å†²åŒºä¸­çš„æ•°æ®åˆ° SPI æ€»çº¿ï¼Œæ•°æ®å†™å®Œåï¼Œå†å†™ dummy (0xFF) åˆ° SPI æ€»çº¿ */</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">&lt;</span> write_size<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>            send_data <span class=\"token operator\">=</span> <span class=\"token operator\">*</span>write_buf<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>        <span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>            send_data <span class=\"token operator\">=</span> SFUD_DUMMY_DATA<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>        <span class=\"token comment\">/* å‘é€æ•°æ® */</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>        retry_times <span class=\"token operator\">=</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>        <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token function\">SPI_I2S_GetFlagStatus</span><span class=\"token punctuation\">(</span>spi_dev<span class=\"token operator\">-></span>spix<span class=\"token punctuation\">,</span> SPI_I2S_FLAG_TXE<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> RESET<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>            <span class=\"token function\">SFUD_RETRY_PROCESS</span><span class=\"token punctuation\">(</span><span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> retry_times<span class=\"token punctuation\">,</span> result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>result <span class=\"token operator\">!=</span> SFUD_SUCCESS<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>            <span class=\"token keyword\">goto</span> exit<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>        <span class=\"token function\">SPI_I2S_SendData</span><span class=\"token punctuation\">(</span>spi_dev<span class=\"token operator\">-></span>spix<span class=\"token punctuation\">,</span> send_data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>        <span class=\"token comment\">/* æ¥æ”¶æ•°æ® */</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>        retry_times <span class=\"token operator\">=</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>        <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token function\">SPI_I2S_GetFlagStatus</span><span class=\"token punctuation\">(</span>spi_dev<span class=\"token operator\">-></span>spix<span class=\"token punctuation\">,</span> SPI_I2S_FLAG_RXNE<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> RESET<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>            <span class=\"token function\">SFUD_RETRY_PROCESS</span><span class=\"token punctuation\">(</span><span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> retry_times<span class=\"token punctuation\">,</span> result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>result <span class=\"token operator\">!=</span> SFUD_SUCCESS<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>            <span class=\"token keyword\">goto</span> exit<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>        read_data <span class=\"token operator\">=</span> <span class=\"token function\">SPI_I2S_ReceiveData</span><span class=\"token punctuation\">(</span>spi_dev<span class=\"token operator\">-></span>spix<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>        <span class=\"token comment\">/* å†™ç¼“å†²åŒºä¸­çš„æ•°æ®å‘å®Œåï¼Œå†è¯»å– SPI æ€»çº¿ä¸­çš„æ•°æ®åˆ°è¯»ç¼“å†²åŒº */</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">>=</span> write_size<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>            <span class=\"token operator\">*</span>read_buf<span class=\"token operator\">++</span> <span class=\"token operator\">=</span> read_data<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>exit<span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>    <span class=\"token function\">GPIO_SetBits</span><span class=\"token punctuation\">(</span>spi_dev<span class=\"token operator\">-></span>cs_gpiox<span class=\"token punctuation\">,</span> spi_dev<span class=\"token operator\">-></span>cs_gpio_pin<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>    <span class=\"token keyword\">return</span> result<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"é…ç½®æ–‡ä»¶\"><a class=\"anchor\" href=\"#é…ç½®æ–‡ä»¶\">#</a> é…ç½®æ–‡ä»¶</h2>\n<p>é™¤äº†è¿™äº›ä¹‹å¤–ï¼Œè¿˜éœ€è¦è‡ªè¡Œé…ç½®ä¸€ä¸‹  <code>/sfud/inc/sfud_cfg.h</code>  æ–‡ä»¶<br />\né€‰æ‹©æ˜¯å¦ä½¿ç”¨ SFDP åè®®ï¼Œæ˜¯å¦ä½¿ç”¨ FLASH ä¿¡æ¯è¡¨ï¼Œå’Œå®šä¹‰è‡ªå·±æ‰€ç”¨çš„ FLASH å¯¹åº”çš„æšä¸¾å˜é‡ä»¥åŠç»“æ„ä½“ä¿¡æ¯<br />\næˆ‘çš„é…ç½®å¦‚ä¸‹</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// #define SFUD_DEBUG_MOD             // ä¸ä½¿ç”¨ SFUD debug æ¨¡å¼</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">SFUD_USING_SFDP</span>               <span class=\"token comment\">// ä½¿ç”¨ SFDP</span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">SFUD_USING_FLASH_INFO_TABLE</span>   <span class=\"token comment\">// ä½¿ç”¨ FLASH ä¿¡æ¯è¡¨</span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">// FLASH èŠ¯ç‰‡å‹å·æšä¸¾</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">enum</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    SFUD_W25Q64FV_DEVICE_INDEX <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\">// FLASH ç›¸å…³ä¿¡æ¯å’Œ é©±åŠ¨çš„ç¡¬ä»¶ SPI</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">SFUD_FLASH_DEVICE_TABLE</span>                                                  <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token expression\"><span class=\"token punctuation\">&#123;</span>                                                                            </span><span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token expression\"><span class=\"token punctuation\">[</span>SFUD_W25Q64FV_DEVICE_INDEX<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> </span><span class=\"token string\">\"W25Q64FV\"</span><span class=\"token expression\"><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">.</span>spi<span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> </span><span class=\"token string\">\"SPI1\"</span><span class=\"token expression\"><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> </span><span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token expression\"><span class=\"token punctuation\">&#125;</span></span></span></pre></td></tr></table></figure><h1 id=\"æ¥å£å‡½æ•°\"><a class=\"anchor\" href=\"#æ¥å£å‡½æ•°\">#</a> æ¥å£å‡½æ•°</h1>\n<h2 id=\"sfud_init\"><a class=\"anchor\" href=\"#sfud_init\">#</a> sfud_init</h2>\n<p>å‡½æ•°åŸå‹å¦‚ä¸‹</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>sfud_err <span class=\"token function\">sfud_init</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>åˆå§‹åŒ–å‡½æ•°ï¼Œè¿™ä¸ªæ”¾åœ¨ä¸»å‡½æ•°è°ƒç”¨åˆ¤æ–­ä¸€ä¸‹å°±å¥½äº†ï¼ŒæˆåŠŸä¼šè¿”å›  <code>SFUD_SUCCESS</code> <br />\n å¦‚æœå¼€å¯äº† DEBUG çš„å®ï¼Œä¼šæ‰“å°ä¸€äº›è¯¦ç»†ä¿¡æ¯.<br />\n è¿™ä¸ªåˆå§‹åŒ–ä¼šåˆå§‹åŒ–è®¾å¤‡åˆ—è¡¨ä¸­çš„æ‰€æœ‰ flash é©±åŠ¨ï¼Œå¦‚æœæŒ‡å‘é©±åŠ¨ä¸€ä¸ª flash è®¾å¤‡ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨  <code>sfud_device_init</code></p>\n<h2 id=\"sfud_read\"><a class=\"anchor\" href=\"#sfud_read\">#</a> sfud_read</h2>\n<p>å‡½æ•°åŸå‹</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>sfud_err <span class=\"token function\">sfud_read</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> sfud_flash <span class=\"token operator\">*</span>flash<span class=\"token punctuation\">,</span> <span class=\"token class-name\">uint32_t</span> addr<span class=\"token punctuation\">,</span> <span class=\"token class-name\">size_t</span> size<span class=\"token punctuation\">,</span> <span class=\"token class-name\">uint8_t</span> <span class=\"token operator\">*</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>å°†æ•°æ®ä» FLASH ä¸­è¯»å‡ºï¼Œæ²¡å•¥å¥½è¯´ï¼Œä¼ ä¸ª flash è®¾å¤‡è¿›å»ï¼Œç»™ä¸ªåœ°å€ï¼Œç¼“å­˜ç©ºé—´ï¼Œè¦è¯»å–çš„æ•°æ®é‡æ²¡äº†</p>\n<h2 id=\"sfud_erase\"><a class=\"anchor\" href=\"#sfud_erase\">#</a> sfud_erase</h2>\n<p>å‡½æ•°åŸå‹</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>sfud_err <span class=\"token function\">sfud_erase</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> sfud_flash <span class=\"token operator\">*</span>flash<span class=\"token punctuation\">,</span> <span class=\"token class-name\">uint32_t</span> addr<span class=\"token punctuation\">,</span> <span class=\"token class-name\">size_t</span> size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>æ“¦é™¤å‡½æ•°ï¼Œç”¨äºå°† FLASH é‡Œçš„æ•°æ®æ“¦é™¤ä¸º dummy çš„å€¼</p>\n<h2 id=\"sfud_write\"><a class=\"anchor\" href=\"#sfud_write\">#</a> sfud_write</h2>\n<p>å‡½æ•°åŸå‹</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>sfud_err <span class=\"token function\">sfud_write</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> sfud_flash <span class=\"token operator\">*</span>flash<span class=\"token punctuation\">,</span> <span class=\"token class-name\">uint32_t</span> addr<span class=\"token punctuation\">,</span> <span class=\"token class-name\">size_t</span> size<span class=\"token punctuation\">,</span> <span class=\"token keyword\">const</span> <span class=\"token class-name\">uint8_t</span> <span class=\"token operator\">*</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>å•çº¯çš„å†™å‡½æ•°ï¼Œç›®å‰æˆ‘ä¹Ÿä¸çŸ¥é“æœ‰ä»€ä¹ˆç”¨ï¼Œä¸æ“¦é™¤å†å†™åŸºæœ¬ä¸Šå¾ˆéš¾ä¿è¯æ•°æ®çš„ç¨³å®šæ€§å’Œå‡†ç¡®æ€§</p>\n<h2 id=\"sfud_erase_write\"><a class=\"anchor\" href=\"#sfud_erase_write\">#</a> sfud_erase_write</h2>\n<p>å‡½æ•°åŸå‹</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>sfud_err <span class=\"token function\">sfud_erase_write</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> sfud_flash <span class=\"token operator\">*</span>flash<span class=\"token punctuation\">,</span> <span class=\"token class-name\">uint32_t</span> addr<span class=\"token punctuation\">,</span> <span class=\"token class-name\">size_t</span> size<span class=\"token punctuation\">,</span> <span class=\"token keyword\">const</span> <span class=\"token class-name\">uint8_t</span> <span class=\"token operator\">*</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>è¿™ä¸ªå‡½æ•°å’Œ write å‡½æ•°ä¸åŒçš„åœ°æ–¹åœ¨äºï¼Œå…ˆå†™åæ“¦ï¼Œèƒ½å®ç°æ•°æ®å†™å…¥ æœ‰æ•ˆçš„å†™å…¥ FLASH</p>\n<h2 id=\"demo\"><a class=\"anchor\" href=\"#demo\">#</a> demo</h2>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">SFUD_DEMO_TEST_BUFFER_SIZE</span> <span class=\"token expression\"><span class=\"token number\">2048</span></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">static</span> <span class=\"token class-name\">uint8_t</span> sfud_demo_test_buf<span class=\"token punctuation\">[</span>SFUD_DEMO_TEST_BUFFER_SIZE<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">sfud_demo</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint32_t</span> addr<span class=\"token punctuation\">,</span> <span class=\"token class-name\">size_t</span> size<span class=\"token punctuation\">,</span> <span class=\"token class-name\">uint8_t</span> <span class=\"token operator\">*</span>data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    sfud_err result <span class=\"token operator\">=</span> SFUD_SUCCESS<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token comment\">// åœ¨æ“ä½œä¹‹å‰éœ€è¦è·å– flash å¯¹è±¡</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">const</span> sfud_flash <span class=\"token operator\">*</span>flash <span class=\"token operator\">=</span> <span class=\"token function\">sfud_get_device_table</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token class-name\">size_t</span> i<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token comment\">// åˆå§‹åŒ– spi  </span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">sfud_init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> SFUD_SUCCESS<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token function\">sfud_demo</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span>sfud_demo_test_buf<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> sfud_demo_test_buf<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token comment\">/* æ•°æ®å¡«å…… */</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> size<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        data<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> i<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token comment\">/* æ“¦é™¤æ‰‡åŒº */</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    result <span class=\"token operator\">=</span> <span class=\"token function\">sfud_erase</span><span class=\"token punctuation\">(</span>flash<span class=\"token punctuation\">,</span> addr<span class=\"token punctuation\">,</span> size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>result <span class=\"token operator\">==</span> SFUD_SUCCESS<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Erase the %s flash data finish. Start from 0x%08X, size is %ld.\\r\\n\"</span><span class=\"token punctuation\">,</span> flash<span class=\"token operator\">-></span>name<span class=\"token punctuation\">,</span> addr<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>               size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Erase the %s flash data failed.\\r\\n\"</span><span class=\"token punctuation\">,</span> flash<span class=\"token operator\">-></span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>        <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token comment\">/* å†™å…¥æ•° */</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    result <span class=\"token operator\">=</span> <span class=\"token function\">sfud_write</span><span class=\"token punctuation\">(</span>flash<span class=\"token punctuation\">,</span> addr<span class=\"token punctuation\">,</span> size<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>result <span class=\"token operator\">==</span> SFUD_SUCCESS<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Write the %s flash data finish. Start from 0x%08X, size is %ld.\\r\\n\"</span><span class=\"token punctuation\">,</span> flash<span class=\"token operator\">-></span>name<span class=\"token punctuation\">,</span> addr<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>               size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    <span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Write the %s flash data failed.\\r\\n\"</span><span class=\"token punctuation\">,</span> flash<span class=\"token operator\">-></span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>        <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    <span class=\"token comment\">/* è¯»å‡ºæ•°æ® */</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    result <span class=\"token operator\">=</span> <span class=\"token function\">sfud_read</span><span class=\"token punctuation\">(</span>flash<span class=\"token punctuation\">,</span> addr<span class=\"token punctuation\">,</span> size<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>result <span class=\"token operator\">==</span> SFUD_SUCCESS<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Read the %s flash data success. Start from 0x%08X, size is %ld. The data is:\\r\\n\"</span><span class=\"token punctuation\">,</span> flash<span class=\"token operator\">-></span>name<span class=\"token punctuation\">,</span> addr<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>               size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Offset (h) 00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F\\r\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> size<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">%</span> <span class=\"token number\">16</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>            <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"[%08X] \"</span><span class=\"token punctuation\">,</span> addr <span class=\"token operator\">+</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>            <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%02X \"</span><span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> <span class=\"token number\">16</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> i <span class=\"token operator\">==</span> size <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>            <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\r\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\r\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>    <span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Read the %s flash data failed.\\r\\n\"</span><span class=\"token punctuation\">,</span> flash<span class=\"token operator\">-></span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>    <span class=\"token comment\">/* æ•°æ®æ ¡éªŒ */</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> size<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">!=</span> i <span class=\"token operator\">%</span> <span class=\"token number\">256</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>            <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Read and check write data has an error. Write the %s flash data failed.\\r\\n\"</span><span class=\"token punctuation\">,</span> flash<span class=\"token operator\">-></span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">==</span> size<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"The %s flash test is success.\\r\\n\"</span><span class=\"token punctuation\">,</span> flash<span class=\"token operator\">-></span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h1 id=\"end\"><a class=\"anchor\" href=\"#end\">#</a> END</h1>\n<p>ç›®å‰æˆ‘ä¹Ÿå°±åªçŸ¥é“è¿™äº›äº†ï¼Œç­‰ä»¥åä½¿ç”¨çš„æ—¶å€™å‡ºç°ä»€ä¹ˆ bug å†æ¥ç¢ç£¨ç¢ç£¨</p>\n<hr />\n<p>å¤§é“äº”åï¼Œå¤©è¡å››åä¹ï¼Œäººéå…¶ä¸€ï¼</p>\n",
            "tags": [
                "åµŒå…¥å¼",
                "STM32",
                "SFUD",
                "FLASH,SFUD"
            ]
        },
        {
            "id": "https://to-ywz.github.io/Embedded/STM32/STM32F4%E8%A3%B8%E6%9C%BA%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%A7%BB%E6%A4%8D/",
            "url": "https://to-ywz.github.io/Embedded/STM32/STM32F4%E8%A3%B8%E6%9C%BA%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%A7%BB%E6%A4%8D/",
            "title": "STM32F4è£¸æœº FatFs ç§»æ¤",
            "date_published": "2021-12-07T23:05:01.000Z",
            "content_html": "<h1 id=\"æ–‡ä»¶ç³»ç»Ÿ\"><a class=\"anchor\" href=\"#æ–‡ä»¶ç³»ç»Ÿ\">#</a> æ–‡ä»¶ç³»ç»Ÿ</h1>\n<p><strong>å†™åœ¨å‰é¢:</strong> è¿™é‡Œç›®å‰åªå®ç° SFUD+ff14b åŸºäºæ ‡å‡†åº“ï¼Œæ¿è½½ W25Q64FV 8M çš„ FLASH.</p>\n<h2 id=\"ç»´åŸºç™¾ç§‘ä»‹ç»\"><a class=\"anchor\" href=\"#ç»´åŸºç™¾ç§‘ä»‹ç»\">#</a> ç»´åŸºç™¾ç§‘ä»‹ç»</h2>\n<p>è®¡ç®—æœºçš„æ–‡ä»¶ç³»ç»Ÿæ˜¯ä¸€ç§å­˜å‚¨å’Œç»„ç»‡è®¡ç®—æœºæ•°æ®çš„æ–¹æ³•ï¼Œå®ƒä½¿å¾—å¯¹å…¶è®¿é—®å’ŒæŸ¥æ‰¾å˜å¾—å®¹æ˜“ï¼Œæ–‡ä»¶ç³»ç»Ÿä½¿ç”¨æ–‡ä»¶å’Œæ ‘å½¢ç›®å½•çš„æŠ½è±¡é€»è¾‘æ¦‚å¿µä»£æ›¿äº†ç¡¬ç›˜å’Œå…‰ç›˜ç­‰ç‰©ç†è®¾å¤‡ä½¿ç”¨æ•°æ®å—çš„æ¦‚å¿µï¼Œç”¨æˆ·ä½¿ç”¨æ–‡ä»¶ç³»ç»Ÿæ¥ä¿å­˜æ•°æ®ä¸å¿…å…³å¿ƒæ•°æ®å®é™…ä¿å­˜åœ¨ç¡¬ç›˜ï¼ˆæˆ–è€…å…‰ç›˜ï¼‰çš„åœ°å€ä¸ºå¤šå°‘çš„æ•°æ®å—ä¸Šï¼Œåªéœ€è¦è®°ä½è¿™ä¸ªæ–‡ä»¶çš„æ‰€å±ç›®å½•å’Œæ–‡ä»¶åã€‚åœ¨å†™å…¥æ–°æ•°æ®ä¹‹å‰ï¼Œç”¨æˆ·ä¸å¿…å…³å¿ƒç¡¬ç›˜ä¸Šçš„é‚£ä¸ªå—åœ°å€æ²¡æœ‰è¢«ä½¿ç”¨ï¼Œç¡¬ç›˜ä¸Šçš„å­˜å‚¨ç©ºé—´ç®¡ç†ï¼ˆåˆ†é…å’Œé‡Šæ”¾ï¼‰åŠŸèƒ½ç”±æ–‡ä»¶ç³»ç»Ÿè‡ªåŠ¨å®Œæˆï¼Œç”¨æˆ·åªéœ€è¦è®°ä½æ•°æ®è¢«å†™å…¥åˆ°äº†å“ªä¸ªæ–‡ä»¶ä¸­.</p>\n<p>å…¶å®è¿™ä¹ˆé•¿ä¸€æ®µè¯çš„æ ¸å¿ƒå°±åœ¨æœ€å‰é‚£é‡Œï¼Œæ–‡ä»¶ç³»ç»Ÿå…¶å®å°±æ˜¯ä¸€ä¸ªæŠ½è±¡çš„æ•°æ®ç±»å‹ã€‚ä½äºç‰©ç†å­˜å‚¨ä»‹è´¨ä¹‹ä¸Š.<br />\n ä¸ä¸€èˆ¬çš„ ADT ç›¸æ¯”æ–‡ä»¶ç³»ç»Ÿä»…ä»…æ˜¯æ›´åŠ åºå¤§äº†ï¼Œæ— éå°±æ˜¯ ä¸€å †æ•°æ®ç±»å‹åŠ ä¸Šå¢åˆ æŸ¥æ”¹.<br />\n è¯æ˜¯è¿™ä¹ˆè¯´ï¼Œæˆ‘æ˜¯å†™ä¸å‡ºæ¥è¿™ä¹ˆåºå¤§çš„ ADT, ç‹—å¤´.</p>\n<h2 id=\"ä¸ªäººç†è§£\"><a class=\"anchor\" href=\"#ä¸ªäººç†è§£\">#</a> ä¸ªäººç†è§£</h2>\n<p>è¨€å½’æ­£ä¼ ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨æ–‡ä»¶ç³»ç»Ÿæ—¶ï¼Œæ•°æ®éƒ½ä»¥æ–‡ä»¶çš„å½¢å¼å­˜å‚¨.<br />\n å¦‚æœæƒ³è¦ç•™ä¸‹ä¸€å—ç©ºé—´çš„è¯é‚£ä¹ˆå»ºè®®æ‰‹åŠ¨é™åˆ¶ä¸€ä¸‹ flash å¤§å°æˆ–è€…åšä¸€ä¸‹é¦–åœ°å€åç§».</p>\n<p>å†™å…¥æ–°æ–‡ä»¶æ—¶ï¼Œå…ˆåœ¨ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ç´¢å¼•ï¼Œå®ƒæŒ‡ç¤ºäº†æ–‡ä»¶å­˜æ”¾çš„ç‰©ç†åœ°å€ï¼Œå†æŠŠæ•°æ®å­˜å‚¨åˆ°è¯¥åœ°å€ä¸­<br />\néœ€è¦è¯»å–æ•°æ®æ—¶ï¼Œå¯ä»¥ä»è¯¥ç›®å½•ä¸­æ‰¾åˆ°è¯¥æ–‡ä»¶çš„ç´¢å¼•ï¼Œè¿›è€Œåœ¨ç›¸åº”çš„åœ°å€ä¸­è¯»å–æ•°æ®<br />\næ–‡ä»¶ç³»ç»Ÿçš„å­˜åœ¨ä½¿æˆ‘ä»¬åœ¨å­˜å‚¨æ•°æ®æ—¶ï¼Œä¸å†æ˜¯ç®€å•çš„å‘æŸä¸ªç‰©ç†åœ°å€ç›´æ¥è¯»å†™ï¼Œè€Œæ˜¯è¦éµå¾ªå®ƒçš„è¯»å†™æ ¼å¼<br />\nä¸€ä¸ªå®Œæ•´çš„æ–‡ä»¶ç»è¿‡ é€»è¾‘è½¬æ¢ å¯èƒ½è¢«åˆ†æˆ <strong>å¤šæ®µ</strong> å¹¶å­˜å‚¨åˆ°<strong>ä¸è¿ç»­</strong>çš„ç‰©ç†åœ°å€ï¼Œä»¥åŠä½¿ç”¨ç›®å½•æˆ–é“¾è¡¨çš„æ–¹å¼æ¥è·çŸ¥ä¸‹ä¸€æ®µçš„ä½ç½®</p>\n<p>ç®€å•æ¥è¯´ï¼Œè¿™ä¸ªè½¬æ¢éƒ¨åˆ†å¯ä»¥ç†è§£ä¸ºï¼Œå½“æˆ‘ä»¬éœ€è¦å†™å…¥ä¸€æ®µæ•°æ®æ—¶ï¼Œç”±å®ƒæ¥æ±‚è§£å‘ä»€ä¹ˆç‰©ç†åœ°å€å†™å…¥æ•°æ®ã€ä»¥ä»€ä¹ˆæ ¼å¼å†™å…¥ï¼Œä»¥åŠå†™å…¥ä¸€äº›åŸå§‹æ•°æ®ä»¥å¤–çš„ä¿¡æ¯ (å¦‚ç›®å½•)<br />\n ç±»ä¼¼äºæˆ‘ä»¬å»å¯„å¿«é€’ï¼Œé€»è¾‘å±‚å°±æ˜¯å¿«é€’ç«™ã€‚ä½ æŠŠä¸œè¥¿ç»™å¿«é€’ä¹‹åï¼Œä½ å’Œæ”¶ä»¶äººä¸éœ€è¦çŸ¥é“å¿«é€’æ˜¯æ€ä¹ˆåˆ°çš„ï¼Œåªéœ€è¦çŸ¥é“ç›®çš„åœ°å€å°±å¥½.<br />\n è¿™ä¸ª &quot;å¿«é€’ç«™&quot; çš„ä»£ç å®ç°ï¼Œæˆ‘ä»¬ä¹ æƒ¯ç§°ä¹‹ä¸ºæ–‡ä»¶ç³»ç»Ÿ</p>\n<h2 id=\"æ­è½½æ–‡ä»¶ç³»ç»Ÿçš„åŠ¨æœº\"><a class=\"anchor\" href=\"#æ­è½½æ–‡ä»¶ç³»ç»Ÿçš„åŠ¨æœº\">#</a> æ­è½½æ–‡ä»¶ç³»ç»Ÿçš„åŠ¨æœº</h2>\n<p>ä¸ºäº†è®©å•ç‰‡æœºèƒ½å¤Ÿæ›´å¥½çš„å’ŒæœåŠ¡å™¨è¿›è¡Œäº¤äº’ï¼Œæˆ‘æ‰“ç®—ç§»æ¤ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿåˆ° STM32F4 ä¸Š.<br />\n æ¿å­ä¸Šè‡ªå¸¦äº†ä¸€å— 8M çš„ FLASH, æˆ‘æ‰“ç®—è®©æ–‡ä»¶ç³»ç»Ÿå½»åº•æ¥ç®¡è¿™å— FLASH, å¦‚æœä»¥åæœ‰å¯èƒ½çš„è¯è®© æ–‡ä»¶ç³»ç»Ÿæ¥ç®¡ç‰‡ä¸Š FLASH.</p>\n<h2 id=\"ä¸ºä»€ä¹ˆæ˜¯fatfs\"><a class=\"anchor\" href=\"#ä¸ºä»€ä¹ˆæ˜¯fatfs\">#</a> ä¸ºä»€ä¹ˆæ˜¯ Fatfs</h2>\n<p>å˜¿å˜¿ï¼Œæˆ‘åªçŸ¥é“ FatFs, æ‰€ä»¥æˆ‘é€‰äº†å®ƒï¼Œä½†æ˜¯åé¢æˆ‘æ‰¾äº†ä¸€ä¸‹è¿˜æœ‰ä¸å°‘çš„é’ˆå¯¹äº FLASH çš„æ–‡ä»¶ç³»ç»Ÿ.<br />\n ä¾‹å¦‚ï¼Œesayflash, jffs2, yaffs, Cramfs, SPIFFS... ä½†æ˜¯è¿™äº›éƒ½æ˜¯é’ˆå¯¹äº FLASH çš„æ–‡ä»¶ç³»ç»Ÿï¼Œè€Œ Fatfs åˆ™æ˜¯å¯ä»¥å…¼å®¹å„ç§è®¾å¤‡çš„è¾ƒä¸ºå®Œå–„çš„æ–‡ä»¶ç³»ç»Ÿï¼Œä¾¿äºä»¥åæ‰©å±•.<br />\n(å®³ï¼Œè¯´é‚£ä¹ˆå¤šï¼Œå…¶å®ä¸»è¦è¿˜æ˜¯åªçŸ¥é“ Fatfs)</p>\n<h1 id=\"fatfs\"><a class=\"anchor\" href=\"#fatfs\">#</a> FatFS</h1>\n<p>FATFS æ˜¯é¢å‘å°å‹åµŒå…¥å¼ç³»ç»Ÿçš„ä¸€ç§é€šç”¨çš„ FAT æ–‡ä»¶ç³»ç»Ÿï¼Œå®ƒç”± <code>ANSI C</code>  è¯­è¨€ç¼–å†™ä¸”å®Œå…¨ç‹¬ç«‹äºåº•å±‚çš„ I/O ä»‹è´¨ï¼Œå› æ­¤å®ƒå¯ä»¥å¾ˆå®¹æ˜“çš„ä¸åŠ ä¿®æ”¹çš„ç§»æ¤åˆ°å…¶ä»–å¤„ç†å™¨å½“ä¸­ï¼Œå°±å¯ä»¥åˆ©ç”¨æ–‡ä»¶ç³»ç»Ÿçš„å„ç§å‡½æ•°ï¼Œå¯¹å·²æ ¼å¼åŒ–çš„ SD å¡çš„æ–‡ä»¶è¿›è¡Œè¯»å†™</p>\n<h2 id=\"æºç è·å–\"><a class=\"anchor\" href=\"#æºç è·å–\">#</a> æºç è·å–</h2>\n<p>å¯ä»¥å» Fatfs å®˜ç½‘è‡ªè¡Œä¸‹è½½<span class=\"exturl\" data-url=\"aHR0cDovL2VsbS1jaGFuLm9yZy9mc3cvZmYvMDBpbmRleF9lLmh0bWw=\">ä¼ é€é—¨</span><br />\nä¹Ÿå¯ä»¥åœ¨è¿™é‡Œèµ°é˜¿é‡Œäº‘ç›˜ä¸‹è½½<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYWxpeXVuZHJpdmUuY29tL3MvUGdXbUJGMlVNbVE=\">ä¼ é€é—¨</span><br />\nä¸ªäººå»ºè®®æ˜¯å»å®˜ç½‘ä¸‹è½½ï¼Œæˆ‘è¿™é‡Œåªæœ‰ ff14b ç‰ˆæœ¬çš„ fatfs, ä»¥åå¯èƒ½ä¼šæœ‰æ–°çš„ï¼Œæˆ‘ä¸ä¸€å®šä¼šåŒæ­¥åˆ°é˜¿é‡Œäº‘ç›˜</p>\n<h2 id=\"æ–‡ä»¶åˆ†å¸ƒ\"><a class=\"anchor\" href=\"#æ–‡ä»¶åˆ†å¸ƒ\">#</a> æ–‡ä»¶åˆ†å¸ƒ</h2>\n<p>document æ–‡ä»¶<br />\n<img data-src=\"https://s2.loli.net/2021/12/14/uHxdMZ3lXSs69h5.png\" alt=\"document\" /><br />\nsource æ–‡ä»¶å¤¹æ–‡ä»¶åˆ†å¸ƒ<br />\n<img data-src=\"https://s2.loli.net/2021/12/14/oUdQ1Jl47jf98XD.png\" alt=\"FatFs_source\" /></p>\n<h2 id=\"æ¥å£å‡½æ•°\"><a class=\"anchor\" href=\"#æ¥å£å‡½æ•°\">#</a> æ¥å£å‡½æ•°</h2>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>FRESULT <span class=\"token function\">f_open</span> <span class=\"token punctuation\">(</span>FIL<span class=\"token operator\">*</span> fp<span class=\"token punctuation\">,</span> <span class=\"token keyword\">const</span> TCHAR<span class=\"token operator\">*</span> path<span class=\"token punctuation\">,</span> BYTE mode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\t\t\t\t\t\t\t<span class=\"token comment\">/* æ‰“å¼€æˆ–åˆ›å»ºæ–‡ä»¶ */</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>FRESULT <span class=\"token function\">f_close</span> <span class=\"token punctuation\">(</span>FIL<span class=\"token operator\">*</span> fp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"token comment\">/* å…³é—­æ–‡ä»¶ */</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>FRESULT <span class=\"token function\">f_read</span> <span class=\"token punctuation\">(</span>FIL<span class=\"token operator\">*</span> fp<span class=\"token punctuation\">,</span> <span class=\"token keyword\">void</span><span class=\"token operator\">*</span> buff<span class=\"token punctuation\">,</span> UINT btr<span class=\"token punctuation\">,</span> UINT<span class=\"token operator\">*</span> br<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\t\t\t\t\t\t<span class=\"token comment\">/* è¯»å–æ–‡ä»¶ */</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>FRESULT <span class=\"token function\">f_write</span> <span class=\"token punctuation\">(</span>FIL<span class=\"token operator\">*</span> fp<span class=\"token punctuation\">,</span> <span class=\"token keyword\">const</span> <span class=\"token keyword\">void</span><span class=\"token operator\">*</span> buff<span class=\"token punctuation\">,</span> UINT btw<span class=\"token punctuation\">,</span> UINT<span class=\"token operator\">*</span> bw<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\t\t\t\t<span class=\"token comment\">/* å†™å…¥æ–‡ä»¶ */</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>FRESULT <span class=\"token function\">f_opendir</span> <span class=\"token punctuation\">(</span>DIR<span class=\"token operator\">*</span> dp<span class=\"token punctuation\">,</span> <span class=\"token keyword\">const</span> TCHAR<span class=\"token operator\">*</span> path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\t\t\t\t\t\t\t\t\t<span class=\"token comment\">/* æ‰“å¼€æ–‡ä»¶å¤¹ */</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>FRESULT <span class=\"token function\">f_closedir</span> <span class=\"token punctuation\">(</span>DIR<span class=\"token operator\">*</span> dp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"token comment\">/* å…³é—­æ–‡ä»¶å¤¹ */</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>FRESULT <span class=\"token function\">f_readdir</span> <span class=\"token punctuation\">(</span>DIR<span class=\"token operator\">*</span> dp<span class=\"token punctuation\">,</span> FILINFO<span class=\"token operator\">*</span> fno<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\t\t\t\t\t\t\t\t\t\t<span class=\"token comment\">/* è¯»å–æ–‡ä»¶å¤¹ */</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>FRESULT <span class=\"token function\">f_mkdir</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> TCHAR<span class=\"token operator\">*</span> path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\t\t\t\t\t\t\t\t\t\t\t<span class=\"token comment\">/* åˆ›å»ºæ–‡ä»¶å¤¹ */</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>FRESULT <span class=\"token function\">f_unlink</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> TCHAR<span class=\"token operator\">*</span> path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\t\t\t\t\t\t\t\t\t\t\t<span class=\"token comment\">/* åˆ é™¤å­˜åœ¨çš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ */</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>FRESULT <span class=\"token function\">f_getfree</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> TCHAR<span class=\"token operator\">*</span> path<span class=\"token punctuation\">,</span> DWORD<span class=\"token operator\">*</span> nclst<span class=\"token punctuation\">,</span> FATFS<span class=\"token operator\">*</span><span class=\"token operator\">*</span> fatfs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\t\t\t\t<span class=\"token comment\">/* è·å–å½“å‰å·å‰©ä½™ç©ºé—´ */</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>FRESULT <span class=\"token function\">f_rename</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> TCHAR<span class=\"token operator\">*</span> path_old<span class=\"token punctuation\">,</span> <span class=\"token keyword\">const</span> TCHAR<span class=\"token operator\">*</span> path_new<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\t\t\t\t<span class=\"token comment\">/* é‡å‘½åæ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ */</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>FRESULT <span class=\"token function\">f_chdir</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> TCHAR<span class=\"token operator\">*</span> path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\t\t\t\t\t\t\t\t\t\t\t<span class=\"token comment\">/* æ›´æ”¹å½“å‰è·¯å¾„ */</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>FRESULT <span class=\"token function\">f_mount</span> <span class=\"token punctuation\">(</span>FATFS<span class=\"token operator\">*</span> fs<span class=\"token punctuation\">,</span> <span class=\"token keyword\">const</span> TCHAR<span class=\"token operator\">*</span> path<span class=\"token punctuation\">,</span> BYTE opt<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\t\t\t\t\t\t<span class=\"token comment\">/* æŒ‚è½½æˆ–å¸è½½é€»è¾‘å· */</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>FRESULT <span class=\"token function\">f_mkfs</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> TCHAR<span class=\"token operator\">*</span> path<span class=\"token punctuation\">,</span> <span class=\"token keyword\">const</span> MKFS_PARM<span class=\"token operator\">*</span> opt<span class=\"token punctuation\">,</span> <span class=\"token keyword\">void</span><span class=\"token operator\">*</span> work<span class=\"token punctuation\">,</span> UINT len<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\t<span class=\"token comment\">/* æ ¼å¼åŒ– (åˆ›å»º) FAT å· */</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name function\">f_size</span><span class=\"token expression\"><span class=\"token punctuation\">(</span>fp<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>fp<span class=\"token punctuation\">)</span><span class=\"token operator\">-></span>obj<span class=\"token punctuation\">.</span>objsize<span class=\"token punctuation\">)</span>\t\t\t\t\t\t\t\t\t\t\t</span><span class=\"token comment\">/* è·å–å½“å‰æ–‡ä»¶å¤§å° */</span></span></pre></td></tr></table></figure><h2 id=\"åº•å±‚é©±åŠ¨\"><a class=\"anchor\" href=\"#åº•å±‚é©±åŠ¨\">#</a> åº•å±‚é©±åŠ¨</h2>\n<p>ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬ç§»æ¤çš„æ—¶å€™åªéœ€è¦å®ç°ä¸€ä¸‹ iodisk ä¸­çš„è¿™äº›ä¸ªå‡½æ•°å³å¯ï¼Œå¦‚æœéœ€è¦åŠ æ—¶é—´æˆ³ï¼Œè‡ªè¡Œå®ç°ï¼Œè¿™é‡Œæˆ‘ä¸ç”¨ rtc æ‰€ä»¥ä¸å®ç°æ—¶é—´æˆ³<br />\n<img data-src=\"https://s2.loli.net/2021/12/14/9roNcgKR1qdPMGS.png\" alt=\"iodisk.h\" /></p>\n<h3 id=\"sfud\"><a class=\"anchor\" href=\"#sfud\">#</a> SFUD</h3>\n<p>è¿™é‡Œä½¿ç”¨äº† ä¸€ä¸ªä¸‡èƒ½çš„ FLASH é©±åŠ¨ç»„ä»¶ SFUD. é¿å…ä»¥åä¿®æ”¹ FLASH èŠ¯ç‰‡çš„æ—¶å€™ï¼Œè¿˜å¾—åˆ°å¤„å»æ”¹ä¹Ÿå†™å…¥çš„ç›¸å…³æ–¹æ³•.<br />\n<img data-src=\"https://s2.loli.net/2021/12/14/QgGcBTos6twlqIe.png\" alt=\"sfud\" /><br />\n è¿™é‡Œä¸è¯¦ç»†è¯´æ˜ SFUD çš„ç§»æ¤ï¼Œåªåˆ—å‡ºä¸€ä¸‹ç”¨åˆ°çš„å‡½æ•°<br />\nå…³äº sfud çš„ç§»æ¤å¯ä»¥å‚è€ƒæˆ‘å¦ä¸€ç¯‡åšå®¢<span class=\"exturl\" data-url=\"aHR0cHM6Ly90by15d3oudG9wL0VtYmVkZGVkL1NUTTMyL1NUTTMyJUU4JUEzJUI4JUU2JTlDJUJBJUU3JUE3JUJCJUU2JUE0JThEU0ZVRC8=\">ä¼ é€é—¨</span> (å…¶å®ç›´æ¥å» github ä¸Šçœ‹äººå®¶çš„ readme å°±å¯ä»¥äº†)</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// ç”¨äº disk_init</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>sfud_err <span class=\"token function\">sfud_init</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">// ç”¨äºè·å– è¦å†™å…¥çš„ flash å¯¹è±¡</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>sfud_flash <span class=\"token operator\">*</span><span class=\"token function\">sfud_get_device</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">size_t</span> index<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">// ç”¨äº disk_read å‡½æ•°</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>sfud_err <span class=\"token function\">sfud_read</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> sfud_flash <span class=\"token operator\">*</span>flash<span class=\"token punctuation\">,</span> <span class=\"token class-name\">uint32_t</span> addr<span class=\"token punctuation\">,</span> <span class=\"token class-name\">size_t</span> size<span class=\"token punctuation\">,</span> <span class=\"token class-name\">uint8_t</span> <span class=\"token operator\">*</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">// ç”¨äº disk_write å‡½æ•°</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>sfud_err <span class=\"token function\">sfud_erase_write</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> sfud_flash <span class=\"token operator\">*</span>flash<span class=\"token punctuation\">,</span> <span class=\"token class-name\">uint32_t</span> addr<span class=\"token punctuation\">,</span> <span class=\"token class-name\">size_t</span> size<span class=\"token punctuation\">,</span> <span class=\"token keyword\">const</span> <span class=\"token class-name\">uint8_t</span> <span class=\"token operator\">*</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h3 id=\"disk_initialize\"><a class=\"anchor\" href=\"#disk_initialize\">#</a> disk_initialize</h3>\n<p>å¯¹æ¥äº† SUFD è¿™ä¸€æ­¥è¿˜æ˜¯å¾ˆå¥½å®ç°çš„ã€‚ç›´æ¥ sfud_init ååˆ¤æ–­ æ˜¯å¦æˆåŠŸå³å¯<br />\nè¿™è¾¹ä¸ºäº†å…¼å®¹æ€§å’Œä¾¿æ¬²æ‹“å±•ä»¥åŠå‡å°‘ä»£ç é‡ï¼Œé¢å¤–åŠ äº†ä¸€å±‚ æœ¬åœ°å‡½æ•°å‡½æ•°ï¼Œä¸‹é¢çš„æ‰€æœ‰æ¥å£å®ç°åŸºæœ¬éƒ½æ˜¯è¿™ä¸ªé€»è¾‘<br />\nä»£ç å®ç°å¦‚ä¸‹</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">static</span> FRESULT <span class=\"token function\">flash_disk_initialize</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>DSTATUS <span class=\"token function\">disk_initialize</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\tBYTE pdrv <span class=\"token comment\">/* Physical drive nmuber to identify the drive */</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\tFRESULT res<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t<span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>pdrv<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t<span class=\"token keyword\">case</span> DEV_FLASH<span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t\tsfud_norflash0 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>sfud_flash <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token function\">sfud_get_device_table</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\t\tres <span class=\"token operator\">=</span> <span class=\"token function\">flash_disk_initialize</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\t\t<span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\t<span class=\"token keyword\">default</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>\t\tres <span class=\"token operator\">=</span> FR_DISK_ERR<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\t\t<span class=\"token function\">DEBUG_LOG_F</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">,</span> <span class=\"token string\">\"!!!pdrv is not exit.\\r\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>\t\t<span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>\t<span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>res<span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> RES_OK <span class=\"token operator\">:</span> RES_PARERR<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"26\"></td><td><pre> * @brief \t\t\tFLASH åˆå§‹åŒ–å‡½æ•°</pre></td></tr><tr><td data-num=\"27\"></td><td><pre> *</pre></td></tr><tr><td data-num=\"28\"></td><td><pre> * @return FRESULT \tåˆå§‹åŒ–ç»“æœ</pre></td></tr><tr><td data-num=\"29\"></td><td><pre> */</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token keyword\">static</span> FRESULT <span class=\"token function\">flash_disk_initialize</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>SFUD_SUCCESS <span class=\"token operator\">==</span> <span class=\"token function\">sfud_init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>\t<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>\t\t<span class=\"token keyword\">return</span> FR_OK<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>\t<span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>\t<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>\t\t<span class=\"token function\">DEBUG_LOG_F</span><span class=\"token punctuation\">(</span>FR_INT_ERR<span class=\"token punctuation\">,</span> <span class=\"token string\">\"!!!disk_initialize ERR\\r\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>\t\t<span class=\"token keyword\">return</span> FR_INT_ERR<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h3 id=\"disk_write\"><a class=\"anchor\" href=\"#disk_write\">#</a> disk_write</h3>\n<p>è¿™é‡Œéœ€è¦æ³¨æ„å‡ ç‚¹</p>\n<ol>\n<li>åœ¨å†™ flash ä¹‹å‰éœ€è¦å…ˆ<strong>æ“¦é™¤</strong>ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸ä½¿ç”¨  <code>sfud_write</code>  è€Œæ˜¯ä½¿ç”¨  <code>sfud_erase_write</code> , è¿™æ ·å­å°±ä¸éœ€è¦è‡ªè¡Œå»å®ç°å…ˆæ“¦åå†™çš„é€»è¾‘äº†</li>\n<li>å¯¹äº æ–‡ä»¶ç³»ç»Ÿ æ¥è¯´ï¼Œæ“ä½œä»¥æ‰‡åŒºä¸ºå•ä½ï¼Œè€Œæˆ‘ä»¬çš„ flash çš„è¯»å†™æ“ä½œä¸€èˆ¬ä»¥ Byte ä¸ºå•ä½ï¼Œæ‰€ä»¥éœ€è¦è‡ªè¡Œä¹˜ä¸Šæ‰‡åŒºå¤§å°</li>\n</ol>\n<p>ä»£ç å®ç°å¦‚ä¸‹:</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">static</span> FRESULT <span class=\"token function\">flash_write</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> BYTE <span class=\"token operator\">*</span>buff<span class=\"token punctuation\">,</span> UINT count<span class=\"token punctuation\">,</span> LBA_t sector<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>DRESULT <span class=\"token function\">disk_write</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\tBYTE pdrv<span class=\"token punctuation\">,</span>\t\t  <span class=\"token comment\">/* Physical drive nmuber to identify the drive */</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t<span class=\"token keyword\">const</span> BYTE <span class=\"token operator\">*</span>buff<span class=\"token punctuation\">,</span> <span class=\"token comment\">/* Data to be written */</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\tLBA_t sector<span class=\"token punctuation\">,</span>\t  <span class=\"token comment\">/* Start sector in LBA */</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\tUINT count\t\t  <span class=\"token comment\">/* Number of sectors to write */</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\tFRESULT res<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t<span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>pdrv<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\t<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\t<span class=\"token keyword\">case</span> DEV_FLASH<span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\t\tres <span class=\"token operator\">=</span> <span class=\"token function\">flash_write</span><span class=\"token punctuation\">(</span>buff<span class=\"token punctuation\">,</span> count<span class=\"token punctuation\">,</span> sector<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\t\t<span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\t<span class=\"token keyword\">default</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>\t\tres <span class=\"token operator\">=</span> FR_DISK_ERR<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>\t\t<span class=\"token function\">DEBUG_LOG_D</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"!!!pdrv is not exit.\\r\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>\t\t<span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>\t<span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>res<span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> RES_OK <span class=\"token operator\">:</span> RES_ERROR<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"27\"></td><td><pre> * @brief \t\t\tFLASH å†™å‡½æ•°</pre></td></tr><tr><td data-num=\"28\"></td><td><pre> *</pre></td></tr><tr><td data-num=\"29\"></td><td><pre> * @param buff \t\tè¦å†™å…¥çš„æ•°ç»„</pre></td></tr><tr><td data-num=\"30\"></td><td><pre> * @param count \tè¦å†™å…¥çš„æ‰‡åŒºæ•°é‡</pre></td></tr><tr><td data-num=\"31\"></td><td><pre> * @param sector \tè¦å†™å…¥çš„æ‰‡åŒºçš„èµ·å§‹åœ°å€</pre></td></tr><tr><td data-num=\"32\"></td><td><pre> * @return FRESULT \tå†™æ“ä½œç»“æœ</pre></td></tr><tr><td data-num=\"33\"></td><td><pre> */</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token keyword\">static</span> FRESULT <span class=\"token function\">flash_write</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> BYTE <span class=\"token operator\">*</span>buff<span class=\"token punctuation\">,</span> UINT count<span class=\"token punctuation\">,</span> LBA_t sector<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>\tsfud_err res<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    <span class=\"token comment\">// è¿™é‡Œéœ€è¦å¯¹æ‰‡åŒºæ•°é‡è½¬ä¸ºå­—èŠ‚æ•°</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>\tres <span class=\"token operator\">=</span> <span class=\"token function\">sfud_erase_write</span><span class=\"token punctuation\">(</span>sfud_norflash0<span class=\"token punctuation\">,</span> sector <span class=\"token operator\">*</span> FLASH_SECTOR_SIZE<span class=\"token punctuation\">,</span> count <span class=\"token operator\">*</span> FLASH_SECTOR_SIZE<span class=\"token punctuation\">,</span> buff<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>SFUD_SUCCESS <span class=\"token operator\">==</span> res<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>\t<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>\t\t<span class=\"token keyword\">return</span> FR_OK<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>\t<span class=\"token function\">DEBUG_LOG_F</span><span class=\"token punctuation\">(</span>FR_DISK_ERR<span class=\"token punctuation\">,</span> <span class=\"token string\">\"!!!disk_write ERR\\r\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>\t<span class=\"token keyword\">return</span> FR_DISK_ERR<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h3 id=\"disk_read\"><a class=\"anchor\" href=\"#disk_read\">#</a> disk_read</h3>\n<p>å†™å‡½æ•°éœ€è¦æ³¨æ„çš„åœ°æ–¹å’Œè¯»å‡½æ•°ä¸€è‡´ï¼Œåˆ«æœ€åè¯»å†™äº†åŠå¤©éƒ½åªåœ¨è¯»å†™ä¸€ä¸ªå­—èŠ‚</p>\n<p>ä»£ç å®ç°å¦‚ä¸‹:</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">static</span> FRESULT <span class=\"token function\">flash_read</span><span class=\"token punctuation\">(</span>BYTE <span class=\"token operator\">*</span>buff<span class=\"token punctuation\">,</span> UINT count<span class=\"token punctuation\">,</span> LBA_t sector<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>DRESULT <span class=\"token function\">disk_read</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\tBYTE pdrv<span class=\"token punctuation\">,</span>\t  <span class=\"token comment\">/* Physical drive nmuber to identify the drive */</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\tBYTE <span class=\"token operator\">*</span>buff<span class=\"token punctuation\">,</span>\t  <span class=\"token comment\">/* Data buffer to store read data */</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\tLBA_t sector<span class=\"token punctuation\">,</span> <span class=\"token comment\">/* Start sector in LBA */</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\tUINT count\t  <span class=\"token comment\">/* Number of sectors to read */</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\tFRESULT res<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t<span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>pdrv<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\t<span class=\"token keyword\">case</span> DEV_FLASH<span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\t\tres <span class=\"token operator\">=</span> <span class=\"token function\">flash_read</span><span class=\"token punctuation\">(</span>buff<span class=\"token punctuation\">,</span> count<span class=\"token punctuation\">,</span> sector<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\t\t<span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>\t<span class=\"token keyword\">default</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\t\tres <span class=\"token operator\">=</span> FR_DISK_ERR<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>\t\t<span class=\"token function\">DEBUG_LOG_F</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">,</span> <span class=\"token string\">\"!!!pdrv is not exit.\\r\\n\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>\t\t<span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>\t<span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>res<span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> RES_OK <span class=\"token operator\">:</span> RES_ERROR<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"27\"></td><td><pre> * @brief \t\t\tFLASH è¯»å‡½æ•°</pre></td></tr><tr><td data-num=\"28\"></td><td><pre> *</pre></td></tr><tr><td data-num=\"29\"></td><td><pre> * @param buff \t\tè¯»å‡ºçš„æ•°æ®</pre></td></tr><tr><td data-num=\"30\"></td><td><pre> * @param count\t\tè¦è¯»å‡ºçš„æ‰‡åŒºæ•°é‡</pre></td></tr><tr><td data-num=\"31\"></td><td><pre> * @param sector\tæ•°æ®æ‰€åœ¨åœ°å€</pre></td></tr><tr><td data-num=\"32\"></td><td><pre> * @return FRESULT\tè¯»å–ç»“æœ</pre></td></tr><tr><td data-num=\"33\"></td><td><pre> */</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token keyword\">static</span> FRESULT <span class=\"token function\">flash_read</span><span class=\"token punctuation\">(</span>BYTE <span class=\"token operator\">*</span>buff<span class=\"token punctuation\">,</span> UINT count<span class=\"token punctuation\">,</span> LBA_t sector<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>\tsfud_err res<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>\tres <span class=\"token operator\">=</span> <span class=\"token function\">sfud_read</span><span class=\"token punctuation\">(</span>sfud_norflash0<span class=\"token punctuation\">,</span> sector <span class=\"token operator\">*</span> FLASH_SECTOR_SIZE<span class=\"token punctuation\">,</span> count <span class=\"token operator\">*</span> FLASH_SECTOR_SIZE<span class=\"token punctuation\">,</span> buff<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>SFUD_SUCCESS <span class=\"token operator\">==</span> res<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>\t<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>\t\t<span class=\"token keyword\">return</span> FR_OK<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>\t<span class=\"token function\">DEBUG_LOG_F</span><span class=\"token punctuation\">(</span>FR_DISK_ERR<span class=\"token punctuation\">,</span> <span class=\"token string\">\"!!!disk_read ERR\\r\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>\t<span class=\"token keyword\">return</span> FR_DISK_ERR<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h3 id=\"disk_ioctl\"><a class=\"anchor\" href=\"#disk_ioctl\">#</a> disk_ioctl</h3>\n<p>è¿™é‡Œæ˜¯ FatFs è·å– è®¾å¤‡æ‰‡åŒºå¤§å°ï¼Œæ‰‡åŒºæ•°é‡å’Œ å—æ•°é‡çš„çš„åœ°æ–¹ã€‚å¯¹äº FLASH çš„æ‰‡åŒºå…¶å®æ‰‹å†Œé‡Œéƒ½æœ‰ã€‚ä¸è¿‡å…¶å®æˆ‘ä»¬å¯ä»¥è‡ªè¡Œåˆ’åˆ†<br />\nä¾‹å¦‚æˆ‘çš„ä»£ç ï¼Œ8M çš„ FLASH åˆ†ä¸º 8 ä¸ªå—ï¼Œä¸€ä¸ªå— 2048 ä¸ªæ‰‡åŒºï¼Œä¸€ä¸ªæ‰‡åŒº 512 å­—èŠ‚ï¼Œæ•´ä¸ª FLASH åˆ†ä¸º 2048*8 ä¸ªæ‰‡åŒº ä¸€å…± 8M,<br />\n ä¹Ÿå¯ä»¥æŒ‰ FLASH æ‰‹å†Œä¸Šå†™çš„ ä¸€ä¸ª FLASH 1 ä¸ªå—ï¼Œ2048 ä¸ªæ‰‡åŒºï¼Œä¸€ä¸ªæ‰‡åŒº 4096 å­—èŠ‚.<br />\n è¿™é‡Œå¦‚æœä½¿ç”¨ è¶…è¿‡ 512 å¤§å°çš„æ‰‡åŒº è‡ªè¡Œå» ffconf.h ä¸­ä¿®æ”¹ FF_SS_MAX çš„å®<br />\nä»£ç å®ç°å¦‚ä¸‹:</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">FLASH_SECTOR_SIZE</span> <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token number\">512</span><span class=\"token punctuation\">)</span></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">FLASH_SECTOR_COUNT</span> <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token number\">2048</span><span class=\"token operator\">*</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span> </span><span class=\"token comment\">/* 2048*4096/1024/1024=8(MB) */</span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">FLASH_BLOCK_SIZE</span> <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">static</span> DRESULT <span class=\"token function\">flash_disk_ioctl</span><span class=\"token punctuation\">(</span>BYTE cmd<span class=\"token punctuation\">,</span> <span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>buff<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>DRESULT <span class=\"token function\">disk_ioctl</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\tBYTE pdrv<span class=\"token punctuation\">,</span> <span class=\"token comment\">/* Physical drive nmuber (0..) */</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\tBYTE cmd<span class=\"token punctuation\">,</span>  <span class=\"token comment\">/* Control code */</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t<span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>buff <span class=\"token comment\">/* Buffer to send/receive control data */</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\tDRESULT res<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\t<span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>pdrv<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\t<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>\t<span class=\"token keyword\">case</span> DEV_FLASH<span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\t\tres <span class=\"token operator\">=</span> <span class=\"token function\">flash_disk_ioctl</span><span class=\"token punctuation\">(</span>cmd<span class=\"token punctuation\">,</span> buff<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>\t\t<span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>\t<span class=\"token keyword\">default</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>\t\tres <span class=\"token operator\">=</span> RES_PARERR<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>\t\t<span class=\"token function\">DEBUG_LOG_D</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"!!!disk_ioctl ERR\\r\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>\t\t<span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>\t<span class=\"token keyword\">return</span> res<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"30\"></td><td><pre> * @brief \t\t\tè·å– FLASH æ‰‡åŒº å— æ•°æ®</pre></td></tr><tr><td data-num=\"31\"></td><td><pre> *</pre></td></tr><tr><td data-num=\"32\"></td><td><pre> * @param cmd \t\tè·å–æŒ‡ä»¤</pre></td></tr><tr><td data-num=\"33\"></td><td><pre> * @param buff \t\tå¯¹åº”æ•°ç»„</pre></td></tr><tr><td data-num=\"34\"></td><td><pre> * @return DRESULT \tæŒ‡ä»¤æ‰§è¡Œç»“æœ</pre></td></tr><tr><td data-num=\"35\"></td><td><pre> */</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token keyword\">static</span> DRESULT <span class=\"token function\">flash_disk_ioctl</span><span class=\"token punctuation\">(</span>BYTE cmd<span class=\"token punctuation\">,</span> <span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>buff<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>\t<span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>cmd<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>\t<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>\t<span class=\"token keyword\">case</span> CTRL_SYNC<span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>\t\t<span class=\"token keyword\">return</span> RES_OK<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>\t<span class=\"token keyword\">case</span> GET_SECTOR_COUNT<span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>\t\t<span class=\"token comment\">/* æ‰‡åŒºæ•°é‡ */</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>\t\t<span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>DWORD <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>buff <span class=\"token operator\">=</span> FLASH_SECTOR_COUNT<span class=\"token punctuation\">;</span> <span class=\"token comment\">// W25Q64 æœ‰ 2048 ä¸ªå¤§å°ä¸º 4K çš„æ‰‡åŒº</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>\t\t<span class=\"token keyword\">return</span> RES_OK<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>\t<span class=\"token keyword\">case</span> GET_SECTOR_SIZE<span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>\t\t<span class=\"token comment\">/* æ‰‡åŒºå¤§å° */</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>\t\t<span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>WORD <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>buff <span class=\"token operator\">=</span> FLASH_SECTOR_SIZE<span class=\"token punctuation\">;</span> <span class=\"token comment\">//spi flash çš„æ‰‡åŒºå¤§å°æ˜¯ 4096 Bytes</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>\t\t<span class=\"token keyword\">return</span> RES_OK<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>\t<span class=\"token keyword\">case</span> GET_BLOCK_SIZE<span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>\t\t<span class=\"token comment\">/* å—å¤§å° */</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>\t\t<span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>DWORD <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>buff <span class=\"token operator\">=</span> FLASH_BLOCK_SIZE<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>\t\t<span class=\"token keyword\">return</span> RES_OK<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>\t<span class=\"token keyword\">default</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>\t\t<span class=\"token keyword\">return</span> RES_PARERR<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h3 id=\"disk_status\"><a class=\"anchor\" href=\"#disk_status\">#</a> disk_status</h3>\n<p>è¿™ä¸ªå°±å¾ˆç®€å•äº†ï¼Œæƒ³å®ç°å°±å®ç°ï¼Œä¸æƒ³å®ç°å°±ç›´æ¥  <code>return FR_OK;</code>  å°±å¥½äº†<br />\nå¦‚æœæƒ³å®ç° å¯ä»¥ä½¿ç”¨ sfud_read è¯»å–ä¸€ä¸‹ flash id, åˆ¤æ–­ä¸€ä¸‹ä½œä¸ºè¿”å›å€¼å³å¯<br />\nä»£ç å®ç°å¦‚ä¸‹:</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>DSTATUS <span class=\"token function\">disk_status</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\tBYTE pdrv <span class=\"token comment\">/* Physical drive nmuber to identify the drive */</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>DEV_FLASH <span class=\"token operator\">==</span> pdrv<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t\t<span class=\"token keyword\">return</span> RES_OK<span class=\"token punctuation\">;</span> <span class=\"token comment\">// ç›´æ¥è¿”å› OK å³å¯</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t<span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t\t<span class=\"token function\">DEBUG_LOG_D</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"!!!pdrv is not exit.\\r\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t\t<span class=\"token keyword\">return</span> RES_PARERR<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h3 id=\"iodiskc-æ–‡ä»¶ä¹‹å¤–çš„ä¸œè¥¿\"><a class=\"anchor\" href=\"#iodiskc-æ–‡ä»¶ä¹‹å¤–çš„ä¸œè¥¿\">#</a> iodisk.c æ–‡ä»¶ä¹‹å¤–çš„ä¸œè¥¿</h3>\n<p>fatfs è¿˜æœ‰ä¸€ä¸ª ffconf.h æ–‡ä»¶ï¼Œè¿™é‡Œä¼šæ¶‰åŠåˆ° æ‰‡åŒºå¤§å°ï¼Œè¯»å†™åŠŸèƒ½ï¼Œä»¥åŠä¸€äº›å‡½æ•°çš„ç¦ç”¨å’Œå¯ç”¨</p>\n<p>è¿™é‡Œåªåˆ—å‡ºå¸¸ç”¨çš„ï¼Œè´´ code å¤ªå ç©ºé—´</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">FF_FS_READONLY</span>\t<span class=\"token expression\"><span class=\"token number\">0</span>       </span><span class=\"token comment\">// åªè¯»æ ‡è¯†ç¬¦ï¼Œå¦‚æœä½ çš„æ–‡ä»¶ç³»ç»Ÿåªéœ€è¦å®ç°è¯»åŠŸèƒ½å°± æ”¹ä¸º 1, disk write ç­‰å‡½æ•°å°±ä¸ä¼šè¢«ç¼–è¯‘</span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">FF_USE_MKFS</span>\t\t<span class=\"token expression\"><span class=\"token number\">1</span>       </span><span class=\"token comment\">// ä½¿ç”¨æ ¼å¼åŒ–å‡½æ•°ï¼Œæˆ‘ä»¬ FLASH å°±å¿…é¡»ä½¿ç”¨è¿™ä¸ªå‡½æ•°ï¼Œå› ä¸ºæˆ‘ä»¬åªèƒ½é€šè¿‡ FatFs æ¥æ ¼å¼åŒ– FLASH</span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">FF_USE_LABEL</span>\t<span class=\"token expression\"><span class=\"token number\">1</span>       </span><span class=\"token comment\">// æ˜¯å¦ä½¿ç”¨å·æ ‡ç­¾ï¼Œè¿™ä¸ªçœ‹ä¸ªäººä¹ æƒ¯ï¼ŒFLASH å°±ä¸€å—ï¼Œä¹Ÿæ— æ‰€è°“ä¹Ÿä¸ç”¨æ ‡ç­¾</span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">FF_USE_STRFUNC</span>\t<span class=\"token expression\"><span class=\"token number\">1</span>       </span><span class=\"token comment\">// ä½¿ç”¨ f_putc, f_getc ç­‰å‡½æ•°ï¼Œæ›´è¯¦ç»†çš„ å­çº§å®å®šä¹‰ï¼Œè‡ªè¡ŒæŸ¥çœ‹æ–‡ä»¶</span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">FF_CODE_PAGE</span>\t<span class=\"token expression\"><span class=\"token number\">932</span>     </span><span class=\"token comment\">// æ–‡ä»¶åç¼–ç æ ¼å¼ï¼Œé»˜è®¤ä¸‡å›½ç </span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">FF_USE_LFN</span>\t\t<span class=\"token expression\"><span class=\"token number\">1</span>       </span><span class=\"token comment\">// æ˜¯å¦å¯ç”¨é•¿æ–‡ä»¶å</span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">FF_MAX_LFN</span>\t\t<span class=\"token expression\"><span class=\"token number\">255</span>     </span><span class=\"token comment\">// æ–‡ä»¶åæœ€å¤§é•¿åº¦</span></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">FF_VOLUMES</span>\t\t<span class=\"token expression\"><span class=\"token number\">1</span>       </span><span class=\"token comment\">// æ–‡ä»¶ç³»ç»Ÿ ç‰©ç†å· çš„æ•°æ®é‡ï¼Œç°åœ¨åªæœ‰ä¸€ä¸ª FLASH æ‰€ä»¥æ˜¯ 1</span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">FF_MIN_SS</span>\t\t<span class=\"token expression\"><span class=\"token number\">512</span>     </span><span class=\"token comment\">// æ‰‡åŒºæœ€å°å¤§å°ï¼Œè¿™ä¸ªä¸€èˆ¬ä¸å˜åŠ¨</span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">FF_MAX_SS</span>\t\t<span class=\"token expression\"><span class=\"token number\">4096</span>    </span><span class=\"token comment\">// æ‰‡åŒºæœ€å¤§å¤§å°ï¼Œæ›´å…·æƒ…å†µè‡ªè¡Œè°ƒæ•´</span></span></pre></td></tr></table></figure><h3 id=\"å®Œæ•´ä»£ç \"><a class=\"anchor\" href=\"#å®Œæ•´ä»£ç \">#</a> å®Œæ•´ä»£ç </h3>\n<p>æ•´ä¸ª  <code>iodisk.c</code>  æ–‡ä»¶å¦‚ä¸‹</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">/*-----------------------------------------------------------------------*/</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">/* Low level disk I/O module SKELETON for FatFs     (C)ChaN, 2019        */</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*-----------------------------------------------------------------------*/</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">/* If a working storage control module is available, it should be        */</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">/* attached to the FatFs via a glue function rather than modifying it.   */</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">/* This is an example of glue functions to attach various exsisting      */</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">/* storage control modules to the FatFs module with a defined API.       */</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\">/*-----------------------------------------------------------------------*/</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"ff.h\"</span>\t\t<span class=\"token comment\">/* Obtains integer types */</span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"diskio.h\"</span> <span class=\"token comment\">/* Declarations of disk functions */</span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"sfud.h\"</span></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\">/* Definitions of physical drive number for each drive */</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\">// #define DEV_RAM 0 /* Example: Map Ramdisk to physical drive 0 */</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">DEV_FLASH</span> <span class=\"token expression\"><span class=\"token number\">0</span></span></span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token comment\">// #define DEV_MMC 1 /* Example: Map MMC/SD card to physical drive 1 */</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token comment\">// #define DEV_USB 2 /* Example: Map USB MSD to physical drive 2 */</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token comment\">// FLASH åˆ’åˆ†æ‰‡åŒºå’Œå—</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token comment\">// FLASH å¤§å° = FLASH_SECTOR_SIZE * FLASH_SECTOR_COUNT</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">FLASH_SECTOR_SIZE</span> <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token number\">512</span><span class=\"token punctuation\">)</span></span></span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">FLASH_SECTOR_COUNT</span> <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token number\">2048</span><span class=\"token operator\">*</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span></span></span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">FLASH_BLOCK_SIZE</span> <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span></span></span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token comment\">// DBEUG ä¿¡æ¯</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">DEBUG_DSTRING_FORMAT</span> <span class=\"token string\">\"[FATFS]: %s. \\r\\n\"</span></span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">DEBUG_FSTRING_FORMAT</span> <span class=\"token string\">\"[FATFS]: %s. (Error Code: %d(%s))\\r\\n\"</span></span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name function\">DEBUG_LOG_F</span><span class=\"token expression\"><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">,</span> string<span class=\"token punctuation\">)</span> <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span>DEBUG_FSTRING_FORMAT<span class=\"token punctuation\">,</span> string<span class=\"token punctuation\">,</span> res<span class=\"token punctuation\">,</span> FR_Table<span class=\"token punctuation\">[</span>res<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name function\">DEBUG_LOG_D</span><span class=\"token expression\"><span class=\"token punctuation\">(</span>string<span class=\"token punctuation\">)</span> <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span>DEBUG_DSTRING_FORMAT<span class=\"token punctuation\">,</span> string<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token comment\">/*-----------------------------------------------------------------------*/</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token comment\">/* static gloal variable */</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token comment\">/*-----------------------------------------------------------------------*/</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token comment\">// é”™è¯¯çŠ¶æ€ç </span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>FR_Table<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>\t<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>\t\t<span class=\"token string\">\"FR_OK: Succeeded\"</span><span class=\"token punctuation\">,</span>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t <span class=\"token comment\">/* (0) Succeeded */</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>\t\t<span class=\"token string\">\"FR_DISK_ERR: A hard error occurred in the low level disk I/O layer \"</span><span class=\"token punctuation\">,</span>\t\t\t <span class=\"token comment\">/* (1) A hard error occurred in the low level disk I/O layer */</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>\t\t<span class=\"token string\">\"FR_INT_ERR: Assertion failed \"</span><span class=\"token punctuation\">,</span>\t\t\t\t\t\t\t\t\t\t\t\t <span class=\"token comment\">/* (2) Assertion failed */</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>\t\t<span class=\"token string\">\"FR_NOT_READY: The physical drive cannot work \"</span><span class=\"token punctuation\">,</span>\t\t\t\t\t\t\t\t <span class=\"token comment\">/* (3) The physical drive cannot work */</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>\t\t<span class=\"token string\">\"FR_NO_FILE: Could not find the file \"</span><span class=\"token punctuation\">,</span>\t\t\t\t\t\t\t\t\t\t\t <span class=\"token comment\">/* (4) Could not find the file */</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>\t\t<span class=\"token string\">\"FR_NO_PATH: Could not find the path \"</span><span class=\"token punctuation\">,</span>\t\t\t\t\t\t\t\t\t\t\t <span class=\"token comment\">/* (5) Could not find the path */</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>\t\t<span class=\"token string\">\"FR_INVALID_NAME: The path name format is invalid \"</span><span class=\"token punctuation\">,</span>\t\t\t\t\t\t\t <span class=\"token comment\">/* (6) The path name format is invalid */</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>\t\t<span class=\"token string\">\"FR_DENIED: Access denied due to prohibited access or directory full \"</span><span class=\"token punctuation\">,</span>\t\t\t <span class=\"token comment\">/* (7) Access denied due to prohibited access or directory full */</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>\t\t<span class=\"token string\">\"FR_EXIST: Access denied due to prohibited access \"</span><span class=\"token punctuation\">,</span>\t\t\t\t\t\t\t <span class=\"token comment\">/* (8) Access denied due to prohibited access */</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>\t\t<span class=\"token string\">\"FR_INVALID_OBJECT: The file/directory object is invalid \"</span><span class=\"token punctuation\">,</span>\t\t\t\t\t\t <span class=\"token comment\">/* (9) The file/directory object is invalid */</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>\t\t<span class=\"token string\">\"FR_WRITE_PROTECTED: The physical drive is write protected \"</span><span class=\"token punctuation\">,</span>\t\t\t\t\t <span class=\"token comment\">/* (10) The physical drive is write protected */</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>\t\t<span class=\"token string\">\"FR_INVALID_DRIVE: The logical drive number is invalid \"</span><span class=\"token punctuation\">,</span>\t\t\t\t\t\t <span class=\"token comment\">/* (11) The logical drive number is invalid */</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>\t\t<span class=\"token string\">\"FR_NOT_ENABLED: The volume has no work area \"</span><span class=\"token punctuation\">,</span>\t\t\t\t\t\t\t\t\t <span class=\"token comment\">/* (12) The volume has no work area */</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>\t\t<span class=\"token string\">\"FR_NO_FILESYSTEM: There is no valid FAT volume \"</span><span class=\"token punctuation\">,</span>\t\t\t\t\t\t\t\t <span class=\"token comment\">/* (13) There is no valid FAT volume */</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>\t\t<span class=\"token string\">\"FR_MKFS_ABORTED: The f_mkfs() aborted due to any problem \"</span><span class=\"token punctuation\">,</span>\t\t\t\t\t <span class=\"token comment\">/* (14) The f_mkfs() aborted due to any parameter error */</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>\t\t<span class=\"token string\">\"FR_TIMEOUT: Could not get a grant to access the volume within defined period \"</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">/* (15) Could not get a grant to access the volume within defined period */</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>\t\t<span class=\"token string\">\"FR_LOCKED: The operation is rejected according to the file sharing policy \"</span><span class=\"token punctuation\">,</span>\t <span class=\"token comment\">/* (16) The operation is rejected according to the file sharing policy */</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>\t\t<span class=\"token string\">\"FR_NOT_ENOUGH_CORE: LFN working buffer could not be allocated \"</span><span class=\"token punctuation\">,</span>\t\t\t\t <span class=\"token comment\">/* (17) LFN working buffer could not be allocated */</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>\t\t<span class=\"token string\">\"FR_TOO_MANY_OPEN_FILES: Number of open files > FF_FS_LOCK \"</span><span class=\"token punctuation\">,</span>\t\t\t\t\t <span class=\"token comment\">/* (18) Number of open files > _FS_SHARE */</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>\t\t<span class=\"token string\">\"FR_INVALID_PARAMETER: Given parameter is invalid \"</span>\t\t\t\t\t\t\t\t <span class=\"token comment\">/* (19) Given parameter is invalid */</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre><span class=\"token comment\">//flash è®¾å¤‡å®ä¾‹</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre><span class=\"token keyword\">static</span> sfud_flash <span class=\"token operator\">*</span>sfud_norflash0<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre><span class=\"token comment\">/*-----------------------------------------------------------------------*/</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre><span class=\"token comment\">/* Get Drive Status                                                      */</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre><span class=\"token comment\">/*-----------------------------------------------------------------------*/</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>DSTATUS <span class=\"token function\">disk_status</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>\tBYTE pdrv <span class=\"token comment\">/* Physical drive nmuber to identify the drive */</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>DEV_FLASH <span class=\"token operator\">==</span> pdrv<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>\t<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>\t\t<span class=\"token keyword\">return</span> RES_OK<span class=\"token punctuation\">;</span> <span class=\"token comment\">// ç›´æ¥è¿”å› OK å³å¯</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>\t<span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>\t<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>\t\t<span class=\"token function\">DEBUG_LOG_D</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"!!!pdrv is not exit.\\r\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>\t\t<span class=\"token keyword\">return</span> RES_PARERR<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre></pre></td></tr><tr><td data-num=\"79\"></td><td><pre><span class=\"token comment\">/*-----------------------------------------------------------------------*/</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre><span class=\"token comment\">/* Inidialize a Drive                                                    */</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre><span class=\"token comment\">/*-----------------------------------------------------------------------*/</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre></pre></td></tr><tr><td data-num=\"83\"></td><td><pre><span class=\"token keyword\">static</span> FRESULT <span class=\"token function\">flash_disk_initialize</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>DSTATUS <span class=\"token function\">disk_initialize</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre>\tBYTE pdrv <span class=\"token comment\">/* Physical drive nmuber to identify the drive */</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"89\"></td><td><pre>\tFRESULT res<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"90\"></td><td><pre></pre></td></tr><tr><td data-num=\"91\"></td><td><pre>\t<span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>pdrv<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"92\"></td><td><pre>\t<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"93\"></td><td><pre>\t<span class=\"token keyword\">case</span> DEV_FLASH<span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"94\"></td><td><pre>\t\tsfud_norflash0 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>sfud_flash <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token function\">sfud_get_device_table</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"95\"></td><td><pre>\t\tres <span class=\"token operator\">=</span> <span class=\"token function\">flash_disk_initialize</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"96\"></td><td><pre>\t\t<span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"97\"></td><td><pre></pre></td></tr><tr><td data-num=\"98\"></td><td><pre>\t<span class=\"token keyword\">default</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"99\"></td><td><pre>\t\tres <span class=\"token operator\">=</span> FR_DISK_ERR<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"100\"></td><td><pre>\t\t<span class=\"token function\">DEBUG_LOG_F</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">,</span> <span class=\"token string\">\"!!!pdrv is not exit.\\r\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"101\"></td><td><pre>\t\t<span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"102\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"103\"></td><td><pre></pre></td></tr><tr><td data-num=\"104\"></td><td><pre>\t<span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>res<span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> RES_OK <span class=\"token operator\">:</span> RES_PARERR<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"105\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"106\"></td><td><pre></pre></td></tr><tr><td data-num=\"107\"></td><td><pre><span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"108\"></td><td><pre> * @brief \t\t\tFLASH åˆå§‹åŒ–å‡½æ•°</pre></td></tr><tr><td data-num=\"109\"></td><td><pre> *</pre></td></tr><tr><td data-num=\"110\"></td><td><pre> * @return FRESULT \tåˆå§‹åŒ–ç»“æœ</pre></td></tr><tr><td data-num=\"111\"></td><td><pre> */</span></pre></td></tr><tr><td data-num=\"112\"></td><td><pre><span class=\"token keyword\">static</span> FRESULT <span class=\"token function\">flash_disk_initialize</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"113\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"114\"></td><td><pre>\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>SFUD_SUCCESS <span class=\"token operator\">==</span> <span class=\"token function\">sfud_init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"115\"></td><td><pre>\t<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"116\"></td><td><pre>\t\t<span class=\"token keyword\">return</span> FR_OK<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"117\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"118\"></td><td><pre>\t<span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"119\"></td><td><pre>\t<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"120\"></td><td><pre>\t\t<span class=\"token function\">DEBUG_LOG_F</span><span class=\"token punctuation\">(</span>FR_INT_ERR<span class=\"token punctuation\">,</span> <span class=\"token string\">\"!!!disk_initialize ERR\\r\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"121\"></td><td><pre>\t\t<span class=\"token keyword\">return</span> FR_INT_ERR<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"122\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"123\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"124\"></td><td><pre></pre></td></tr><tr><td data-num=\"125\"></td><td><pre><span class=\"token comment\">/*-----------------------------------------------------------------------*/</span></pre></td></tr><tr><td data-num=\"126\"></td><td><pre><span class=\"token comment\">/* Read Sector(s)                                                        */</span></pre></td></tr><tr><td data-num=\"127\"></td><td><pre><span class=\"token comment\">/*-----------------------------------------------------------------------*/</span></pre></td></tr><tr><td data-num=\"128\"></td><td><pre></pre></td></tr><tr><td data-num=\"129\"></td><td><pre><span class=\"token keyword\">static</span> FRESULT <span class=\"token function\">flash_read</span><span class=\"token punctuation\">(</span>BYTE <span class=\"token operator\">*</span>buff<span class=\"token punctuation\">,</span> UINT count<span class=\"token punctuation\">,</span> LBA_t sector<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"130\"></td><td><pre></pre></td></tr><tr><td data-num=\"131\"></td><td><pre>DRESULT <span class=\"token function\">disk_read</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"132\"></td><td><pre>\tBYTE pdrv<span class=\"token punctuation\">,</span>\t  <span class=\"token comment\">/* Physical drive nmuber to identify the drive */</span></pre></td></tr><tr><td data-num=\"133\"></td><td><pre>\tBYTE <span class=\"token operator\">*</span>buff<span class=\"token punctuation\">,</span>\t  <span class=\"token comment\">/* Data buffer to store read data */</span></pre></td></tr><tr><td data-num=\"134\"></td><td><pre>\tLBA_t sector<span class=\"token punctuation\">,</span> <span class=\"token comment\">/* Start sector in LBA */</span></pre></td></tr><tr><td data-num=\"135\"></td><td><pre>\tUINT count\t  <span class=\"token comment\">/* Number of sectors to read */</span></pre></td></tr><tr><td data-num=\"136\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"137\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"138\"></td><td><pre>\tFRESULT res<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"139\"></td><td><pre>\t<span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>pdrv<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"140\"></td><td><pre>\t<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"141\"></td><td><pre>\t<span class=\"token keyword\">case</span> DEV_FLASH<span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"142\"></td><td><pre>\t\tres <span class=\"token operator\">=</span> <span class=\"token function\">flash_read</span><span class=\"token punctuation\">(</span>buff<span class=\"token punctuation\">,</span> count<span class=\"token punctuation\">,</span> sector<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"143\"></td><td><pre>\t\t<span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"144\"></td><td><pre></pre></td></tr><tr><td data-num=\"145\"></td><td><pre>\t<span class=\"token keyword\">default</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"146\"></td><td><pre>\t\tres <span class=\"token operator\">=</span> FR_DISK_ERR<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"147\"></td><td><pre>\t\t<span class=\"token function\">DEBUG_LOG_F</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">,</span> <span class=\"token string\">\"!!!pdrv is not exit.\\r\\n\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"148\"></td><td><pre>\t\t<span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"149\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"150\"></td><td><pre></pre></td></tr><tr><td data-num=\"151\"></td><td><pre>\t<span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>res<span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> RES_OK <span class=\"token operator\">:</span> RES_ERROR<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"152\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"153\"></td><td><pre></pre></td></tr><tr><td data-num=\"154\"></td><td><pre><span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"155\"></td><td><pre> * @brief \t\t\tFLASH è¯»å‡½æ•°</pre></td></tr><tr><td data-num=\"156\"></td><td><pre> *</pre></td></tr><tr><td data-num=\"157\"></td><td><pre> * @param buff \t\tè¯»å‡ºçš„æ•°æ®</pre></td></tr><tr><td data-num=\"158\"></td><td><pre> * @param count\t\tè¦è¯»å‡ºçš„æ‰‡åŒºæ•°é‡</pre></td></tr><tr><td data-num=\"159\"></td><td><pre> * @param sector\tæ•°æ®æ‰€åœ¨åœ°å€</pre></td></tr><tr><td data-num=\"160\"></td><td><pre> * @return FRESULT\tè¯»å–ç»“æœ</pre></td></tr><tr><td data-num=\"161\"></td><td><pre> */</span></pre></td></tr><tr><td data-num=\"162\"></td><td><pre><span class=\"token keyword\">static</span> FRESULT <span class=\"token function\">flash_read</span><span class=\"token punctuation\">(</span>BYTE <span class=\"token operator\">*</span>buff<span class=\"token punctuation\">,</span> UINT count<span class=\"token punctuation\">,</span> LBA_t sector<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"163\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"164\"></td><td><pre>\tsfud_err res<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"165\"></td><td><pre>\tres <span class=\"token operator\">=</span> <span class=\"token function\">sfud_read</span><span class=\"token punctuation\">(</span>sfud_norflash0<span class=\"token punctuation\">,</span> sector <span class=\"token operator\">*</span> FLASH_SECTOR_SIZE<span class=\"token punctuation\">,</span> count <span class=\"token operator\">*</span> FLASH_SECTOR_SIZE<span class=\"token punctuation\">,</span> buff<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"166\"></td><td><pre>\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>SFUD_SUCCESS <span class=\"token operator\">==</span> res<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"167\"></td><td><pre>\t<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"168\"></td><td><pre>\t\t<span class=\"token keyword\">return</span> FR_OK<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"169\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"170\"></td><td><pre>\t<span class=\"token function\">DEBUG_LOG_F</span><span class=\"token punctuation\">(</span>FR_DISK_ERR<span class=\"token punctuation\">,</span> <span class=\"token string\">\"!!!disk_read ERR\\r\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"171\"></td><td><pre>\t<span class=\"token keyword\">return</span> FR_DISK_ERR<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"172\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"173\"></td><td><pre></pre></td></tr><tr><td data-num=\"174\"></td><td><pre><span class=\"token comment\">/*-----------------------------------------------------------------------*/</span></pre></td></tr><tr><td data-num=\"175\"></td><td><pre><span class=\"token comment\">/* Write Sector(s)                                                       */</span></pre></td></tr><tr><td data-num=\"176\"></td><td><pre><span class=\"token comment\">/*-----------------------------------------------------------------------*/</span></pre></td></tr><tr><td data-num=\"177\"></td><td><pre></pre></td></tr><tr><td data-num=\"178\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">if</span> <span class=\"token expression\">FF_FS_READONLY <span class=\"token operator\">==</span> <span class=\"token number\">0</span></span></span></pre></td></tr><tr><td data-num=\"179\"></td><td><pre></pre></td></tr><tr><td data-num=\"180\"></td><td><pre><span class=\"token keyword\">static</span> FRESULT <span class=\"token function\">flash_write</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> BYTE <span class=\"token operator\">*</span>buff<span class=\"token punctuation\">,</span> UINT count<span class=\"token punctuation\">,</span> LBA_t sector<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"181\"></td><td><pre></pre></td></tr><tr><td data-num=\"182\"></td><td><pre>DRESULT <span class=\"token function\">disk_write</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"183\"></td><td><pre>\tBYTE pdrv<span class=\"token punctuation\">,</span>\t\t  <span class=\"token comment\">/* Physical drive nmuber to identify the drive */</span></pre></td></tr><tr><td data-num=\"184\"></td><td><pre>\t<span class=\"token keyword\">const</span> BYTE <span class=\"token operator\">*</span>buff<span class=\"token punctuation\">,</span> <span class=\"token comment\">/* Data to be written */</span></pre></td></tr><tr><td data-num=\"185\"></td><td><pre>\tLBA_t sector<span class=\"token punctuation\">,</span>\t  <span class=\"token comment\">/* Start sector in LBA */</span></pre></td></tr><tr><td data-num=\"186\"></td><td><pre>\tUINT count\t\t  <span class=\"token comment\">/* Number of sectors to write */</span></pre></td></tr><tr><td data-num=\"187\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"188\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"189\"></td><td><pre>\tFRESULT res<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"190\"></td><td><pre></pre></td></tr><tr><td data-num=\"191\"></td><td><pre>\t<span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>pdrv<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"192\"></td><td><pre>\t<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"193\"></td><td><pre>\t<span class=\"token keyword\">case</span> DEV_FLASH<span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"194\"></td><td><pre>\t\tres <span class=\"token operator\">=</span> <span class=\"token function\">flash_write</span><span class=\"token punctuation\">(</span>buff<span class=\"token punctuation\">,</span> count<span class=\"token punctuation\">,</span> sector<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"195\"></td><td><pre>\t\t<span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"196\"></td><td><pre></pre></td></tr><tr><td data-num=\"197\"></td><td><pre>\t<span class=\"token keyword\">default</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"198\"></td><td><pre>\t\tres <span class=\"token operator\">=</span> FR_DISK_ERR<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"199\"></td><td><pre>\t\t<span class=\"token function\">DEBUG_LOG_D</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"!!!pdrv is not exit.\\r\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"200\"></td><td><pre>\t\t<span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"201\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"202\"></td><td><pre>\t<span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>res<span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> RES_OK <span class=\"token operator\">:</span> RES_ERROR<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"203\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"204\"></td><td><pre></pre></td></tr><tr><td data-num=\"205\"></td><td><pre><span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"206\"></td><td><pre> * @brief \t\t\tFLASH å†™å‡½æ•°</pre></td></tr><tr><td data-num=\"207\"></td><td><pre> *</pre></td></tr><tr><td data-num=\"208\"></td><td><pre> * @param buff \t\tè¦å†™å…¥çš„æ•°ç»„</pre></td></tr><tr><td data-num=\"209\"></td><td><pre> * @param count \tè¦å†™å…¥çš„æ‰‡åŒºæ•°é‡</pre></td></tr><tr><td data-num=\"210\"></td><td><pre> * @param sector \tè¦å†™å…¥çš„æ‰‡åŒºçš„èµ·å§‹åœ°å€</pre></td></tr><tr><td data-num=\"211\"></td><td><pre> * @return FRESULT \tå†™æ“ä½œç»“æœ</pre></td></tr><tr><td data-num=\"212\"></td><td><pre> */</span></pre></td></tr><tr><td data-num=\"213\"></td><td><pre><span class=\"token keyword\">static</span> FRESULT <span class=\"token function\">flash_write</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> BYTE <span class=\"token operator\">*</span>buff<span class=\"token punctuation\">,</span> UINT count<span class=\"token punctuation\">,</span> LBA_t sector<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"214\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"215\"></td><td><pre>\tsfud_err res<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"216\"></td><td><pre></pre></td></tr><tr><td data-num=\"217\"></td><td><pre>\tres <span class=\"token operator\">=</span> <span class=\"token function\">sfud_erase_write</span><span class=\"token punctuation\">(</span>sfud_norflash0<span class=\"token punctuation\">,</span> sector <span class=\"token operator\">*</span> FLASH_SECTOR_SIZE<span class=\"token punctuation\">,</span> count <span class=\"token operator\">*</span> FLASH_SECTOR_SIZE<span class=\"token punctuation\">,</span> buff<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"218\"></td><td><pre></pre></td></tr><tr><td data-num=\"219\"></td><td><pre>\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>SFUD_SUCCESS <span class=\"token operator\">==</span> res<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"220\"></td><td><pre>\t<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"221\"></td><td><pre>\t\t<span class=\"token keyword\">return</span> FR_OK<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"222\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"223\"></td><td><pre>\t<span class=\"token function\">DEBUG_LOG_F</span><span class=\"token punctuation\">(</span>FR_DISK_ERR<span class=\"token punctuation\">,</span> <span class=\"token string\">\"!!!disk_write ERR\\r\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"224\"></td><td><pre>\t<span class=\"token keyword\">return</span> FR_DISK_ERR<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"225\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"226\"></td><td><pre></pre></td></tr><tr><td data-num=\"227\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span></pre></td></tr><tr><td data-num=\"228\"></td><td><pre></pre></td></tr><tr><td data-num=\"229\"></td><td><pre><span class=\"token comment\">/*-----------------------------------------------------------------------*/</span></pre></td></tr><tr><td data-num=\"230\"></td><td><pre><span class=\"token comment\">/* Miscellaneous Functions                                               */</span></pre></td></tr><tr><td data-num=\"231\"></td><td><pre><span class=\"token comment\">/*-----------------------------------------------------------------------*/</span></pre></td></tr><tr><td data-num=\"232\"></td><td><pre></pre></td></tr><tr><td data-num=\"233\"></td><td><pre>DWORD <span class=\"token function\">get_fattime</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"234\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"235\"></td><td><pre>\t<span class=\"token comment\">// æš‚ä¸æ·»åŠ æ—¶é—´è·å–ï¼Œéœ€è¦çš„è¯å°±æŠŠ RTC æ•°æ®ä¼ å…¥è¿™é‡Œ */</span></pre></td></tr><tr><td data-num=\"236\"></td><td><pre>\t<span class=\"token comment\">// DWORD time; /* è¿”å›å½“å‰æ—¶é—´æˆ³ */</span></pre></td></tr><tr><td data-num=\"237\"></td><td><pre>\t<span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"238\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"239\"></td><td><pre></pre></td></tr><tr><td data-num=\"240\"></td><td><pre><span class=\"token keyword\">static</span> DRESULT <span class=\"token function\">flash_disk_ioctl</span><span class=\"token punctuation\">(</span>BYTE cmd<span class=\"token punctuation\">,</span> <span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>buff<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"241\"></td><td><pre></pre></td></tr><tr><td data-num=\"242\"></td><td><pre>DRESULT <span class=\"token function\">disk_ioctl</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"243\"></td><td><pre>\tBYTE pdrv<span class=\"token punctuation\">,</span> <span class=\"token comment\">/* Physical drive nmuber (0..) */</span></pre></td></tr><tr><td data-num=\"244\"></td><td><pre>\tBYTE cmd<span class=\"token punctuation\">,</span>  <span class=\"token comment\">/* Control code */</span></pre></td></tr><tr><td data-num=\"245\"></td><td><pre>\t<span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>buff <span class=\"token comment\">/* Buffer to send/receive control data */</span></pre></td></tr><tr><td data-num=\"246\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"247\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"248\"></td><td><pre>\tDRESULT res<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"249\"></td><td><pre></pre></td></tr><tr><td data-num=\"250\"></td><td><pre>\t<span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>pdrv<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"251\"></td><td><pre>\t<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"252\"></td><td><pre>\t<span class=\"token keyword\">case</span> DEV_FLASH<span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"253\"></td><td><pre>\t\tres <span class=\"token operator\">=</span> <span class=\"token function\">flash_disk_ioctl</span><span class=\"token punctuation\">(</span>cmd<span class=\"token punctuation\">,</span> buff<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"254\"></td><td><pre>\t\t<span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"255\"></td><td><pre></pre></td></tr><tr><td data-num=\"256\"></td><td><pre>\t<span class=\"token keyword\">default</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"257\"></td><td><pre>\t\tres <span class=\"token operator\">=</span> RES_PARERR<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"258\"></td><td><pre>\t\t<span class=\"token function\">DEBUG_LOG_D</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"!!!disk_ioctl ERR\\r\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"259\"></td><td><pre>\t\t<span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"260\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"261\"></td><td><pre>\t<span class=\"token keyword\">return</span> res<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"262\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"263\"></td><td><pre></pre></td></tr><tr><td data-num=\"264\"></td><td><pre><span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"265\"></td><td><pre> * @brief \t\t\tè·å– FLASH æ‰‡åŒº å— æ•°æ®</pre></td></tr><tr><td data-num=\"266\"></td><td><pre> *</pre></td></tr><tr><td data-num=\"267\"></td><td><pre> * @param cmd \t\tè·å–æŒ‡ä»¤</pre></td></tr><tr><td data-num=\"268\"></td><td><pre> * @param buff \t\tå¯¹åº”æ•°ç»„</pre></td></tr><tr><td data-num=\"269\"></td><td><pre> * @return DRESULT \tæŒ‡ä»¤æ‰§è¡Œç»“æœ</pre></td></tr><tr><td data-num=\"270\"></td><td><pre> */</span></pre></td></tr><tr><td data-num=\"271\"></td><td><pre><span class=\"token keyword\">static</span> DRESULT <span class=\"token function\">flash_disk_ioctl</span><span class=\"token punctuation\">(</span>BYTE cmd<span class=\"token punctuation\">,</span> <span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>buff<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"272\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"273\"></td><td><pre>\t<span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>cmd<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"274\"></td><td><pre>\t<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"275\"></td><td><pre>\t<span class=\"token keyword\">case</span> CTRL_SYNC<span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"276\"></td><td><pre>\t\t<span class=\"token keyword\">return</span> RES_OK<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"277\"></td><td><pre></pre></td></tr><tr><td data-num=\"278\"></td><td><pre>\t<span class=\"token keyword\">case</span> GET_SECTOR_COUNT<span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"279\"></td><td><pre>\t\t<span class=\"token comment\">/* æ‰‡åŒºæ•°é‡ */</span></pre></td></tr><tr><td data-num=\"280\"></td><td><pre>\t\t<span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>DWORD <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>buff <span class=\"token operator\">=</span> FLASH_SECTOR_COUNT<span class=\"token punctuation\">;</span> <span class=\"token comment\">// W25Q64 æœ‰ 2048 ä¸ªå¤§å°ä¸º 4K çš„æ‰‡åŒº</span></pre></td></tr><tr><td data-num=\"281\"></td><td><pre>\t\t<span class=\"token keyword\">return</span> RES_OK<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"282\"></td><td><pre></pre></td></tr><tr><td data-num=\"283\"></td><td><pre>\t<span class=\"token keyword\">case</span> GET_SECTOR_SIZE<span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"284\"></td><td><pre>\t\t<span class=\"token comment\">/* æ‰‡åŒºå¤§å° */</span></pre></td></tr><tr><td data-num=\"285\"></td><td><pre>\t\t<span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>WORD <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>buff <span class=\"token operator\">=</span> FLASH_SECTOR_SIZE<span class=\"token punctuation\">;</span> <span class=\"token comment\">//spi flash çš„æ‰‡åŒºå¤§å°æ˜¯ 4096 Bytes</span></pre></td></tr><tr><td data-num=\"286\"></td><td><pre>\t\t<span class=\"token keyword\">return</span> RES_OK<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"287\"></td><td><pre></pre></td></tr><tr><td data-num=\"288\"></td><td><pre>\t<span class=\"token keyword\">case</span> GET_BLOCK_SIZE<span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"289\"></td><td><pre>\t\t<span class=\"token comment\">/* å—å¤§å° */</span></pre></td></tr><tr><td data-num=\"290\"></td><td><pre>\t\t<span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>DWORD <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>buff <span class=\"token operator\">=</span> FLASH_BLOCK_SIZE<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"291\"></td><td><pre>\t\t<span class=\"token keyword\">return</span> RES_OK<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"292\"></td><td><pre></pre></td></tr><tr><td data-num=\"293\"></td><td><pre>\t<span class=\"token keyword\">default</span><span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"294\"></td><td><pre>\t\t<span class=\"token keyword\">return</span> RES_PARERR<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"295\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"296\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"æµ‹è¯•å‡½æ•°\"><a class=\"anchor\" href=\"#æµ‹è¯•å‡½æ•°\">#</a> æµ‹è¯•å‡½æ•°</h2>\n<p>å†™çš„æ¯”è¾ƒéšæ„ï¼Œå› ä¸ºä¸€äº›ç‰¹æ®ŠåŸå› æ²¡æœ‰åšåˆ¤æ–­å¤„ç†ï¼Œç›´æ¥æµæ°´ï¼Œè‡ªè¡Œä¿®æ”¹</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// å…¨å±€å˜é‡</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>FATFS fs<span class=\"token punctuation\">;</span> <span class=\"token comment\">/* Filesystem object */</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>FATFS <span class=\"token operator\">*</span>fsptr <span class=\"token operator\">=</span> <span class=\"token operator\">&amp;</span>fs<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>FIL fil<span class=\"token punctuation\">;</span>                    <span class=\"token comment\">/* File object */</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>FRESULT res<span class=\"token punctuation\">;</span>                <span class=\"token comment\">/* API result code */</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>UINT bw<span class=\"token punctuation\">,</span> br<span class=\"token punctuation\">;</span>                <span class=\"token comment\">/* Bytes written */</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>BYTE work<span class=\"token punctuation\">[</span>FF_MAX_SS<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token number\">0</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* Work area (larger is better for processing time) */</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>BYTE mm<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"This is file system test file from the STM32F407VGT6.\\r\\n\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">flash_data_display</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint8_t</span> <span class=\"token operator\">*</span>buff<span class=\"token punctuation\">,</span> <span class=\"token class-name\">uint32_t</span> size<span class=\"token punctuation\">,</span> <span class=\"token class-name\">uint32_t</span> flash_add_start<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>  <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Offset (h) 00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F\\r\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">uint32_t</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> size<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>  <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">%</span> <span class=\"token number\">16</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>      <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"[%08X] \"</span><span class=\"token punctuation\">,</span> flash_add_start <span class=\"token operator\">+</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%02X \"</span><span class=\"token punctuation\">,</span> buff<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> <span class=\"token number\">16</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> i <span class=\"token operator\">==</span> size <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>      <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\r\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>  <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\r\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">file_system_test</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>  <span class=\"token keyword\">char</span> fileName<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"0:6\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>  res <span class=\"token operator\">=</span> <span class=\"token function\">f_mkfs</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"0:\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> work<span class=\"token punctuation\">,</span> <span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span>work<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>    <span class=\"token comment\">// æ ¼å¼åŒ–</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>  <span class=\"token function\">FATFS_LOG</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"34\"></td><td><pre>  res <span class=\"token operator\">=</span> <span class=\"token function\">f_mount</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>fs<span class=\"token punctuation\">,</span> <span class=\"token string\">\"0:\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                  <span class=\"token comment\">// æŒ‚è½½</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>  <span class=\"token function\">FATFS_LOG</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>  res <span class=\"token operator\">=</span> <span class=\"token function\">f_getfree</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"0:\"</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>br<span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>fsptr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>           <span class=\"token comment\">// è·å–ç©ºä½™ç©ºé—´</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>  <span class=\"token function\">FATFS_LOG</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>  <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"The free space: %dKB.\\r\\n\"</span><span class=\"token punctuation\">,</span> br<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>  <span class=\"token comment\">// æ‰“å¼€æ–‡ä»¶å‡†å¤‡å†™å…¥ï¼Œæ²¡æœ‰æ–‡ä»¶å°±åˆ›å»ºï¼Œæœ‰æ–‡ä»¶å°±è¦†ç›–</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>  res <span class=\"token operator\">=</span> <span class=\"token function\">f_open</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>fil<span class=\"token punctuation\">,</span> fileName<span class=\"token punctuation\">,</span> FA_CREATE_ALWAYS <span class=\"token operator\">|</span> FA_WRITE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>  <span class=\"token comment\">//FATFS_LOG(res);</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>  <span class=\"token comment\">//res = f_unlink(fileName);</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>  <span class=\"token comment\">// å†™å…¥</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>  res <span class=\"token operator\">=</span> <span class=\"token function\">f_write</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>fil<span class=\"token punctuation\">,</span> mm<span class=\"token punctuation\">,</span> <span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span>mm<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>bw<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>  <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Wrote %d bytes to %s file.\\r\\n\"</span><span class=\"token punctuation\">,</span> bw<span class=\"token punctuation\">,</span> fileName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>  <span class=\"token function\">FATFS_LOG</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre> </pre></td></tr><tr><td data-num=\"52\"></td><td><pre>  <span class=\"token comment\">// å†™å…¥å®Œæ¯•ï¼Œå…³é—­æ–‡ä»¶</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>  <span class=\"token function\">f_close</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>fil<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>  <span class=\"token function\">FATFS_LOG</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>  <span class=\"token comment\">// æ‰“å¼€æ–‡ä»¶å‡†å¤‡è¯»å–</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>  res <span class=\"token operator\">=</span> <span class=\"token function\">f_open</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>fil<span class=\"token punctuation\">,</span> fileName<span class=\"token punctuation\">,</span> FA_READ<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>  <span class=\"token function\">FATFS_LOG</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>  <span class=\"token comment\">// è¯»å‡º</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>  res <span class=\"token operator\">=</span> <span class=\"token function\">f_read</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>fil<span class=\"token punctuation\">,</span> readBuf<span class=\"token punctuation\">,</span> <span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span>mm<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>br<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>  <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%d bytes were read from %s.\\r\\n\"</span><span class=\"token punctuation\">,</span> br<span class=\"token punctuation\">,</span> fileName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>  <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\\r\\n\"</span><span class=\"token punctuation\">,</span> readBuf<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>  <span class=\"token function\">FATFS_LOG</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>  <span class=\"token comment\">// å…³é—­æ–‡ä»¶</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>  <span class=\"token function\">f_close</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>fil<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>  <span class=\"token function\">FATFS_LOG</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h1 id=\"end\"><a class=\"anchor\" href=\"#end\">#</a> END</h1>\n<p>ç­‰æœ‰ç©ºæˆ‘å»ç¢ç£¨ç¢ç£¨ FatFs çš„æºç ä»¥åŠå„ä¸ª API çš„ä½¿ç”¨æ–¹æ³•<br />\nè‡³äºæ ‡å‡†åº“ç›´æ¥å¯¹æ¥ FatFs, æˆ‘è§‰å¾—è¿˜æ˜¯æ²¡æœ‰å¿…è¦äº†ï¼ŒHAL éƒ½ä¸å¿…å®ç°ï¼Œç›´æ¥å¥— SFUD å³å¯<br />\næ‰¾ä¸ªæ—¶é—´æˆ‘æŠŠ æ ‡å‡†åº“ å’Œ HAL åº“ ä¸€è‡´ SFUD çš„æ•™ç¨‹å†™äº†</p>\n<hr />\n<p>å¤§é“äº”åï¼Œå¤©è¡å››åä¹ï¼Œäººéå…¶ä¸€ï¼</p>\n",
            "tags": [
                "åµŒå…¥å¼",
                "STM32",
                "æ–‡ä»¶ç³»ç»Ÿ",
                "fatfs",
                "æ–‡ä»¶ç³»ç»Ÿ,fatfs"
            ]
        },
        {
            "id": "https://to-ywz.github.io/computer-science/C/C%E8%AF%AD%E8%A8%80%E5%A3%B0%E6%98%8E%E5%8F%8D%E6%80%9D/",
            "url": "https://to-ywz.github.io/computer-science/C/C%E8%AF%AD%E8%A8%80%E5%A3%B0%E6%98%8E%E5%8F%8D%E6%80%9D/",
            "title": "Cè¯­è¨€å£°æ˜åæ€",
            "date_published": "2021-10-26T12:45:01.000Z",
            "content_html": "<p>å¯¹äº  <code>char * const *(*next)();</code>  è¿™ç§æ•°æ®ç±»å‹åˆ†æèµ·æ¥ç‰¹åˆ«éº»çƒ¦ï¼Œåœ¨è¿™é‡Œå…ˆæ‹ä¸€ä¸‹</p>\n<h1 id=\"è§„åˆ™\"><a class=\"anchor\" href=\"#è§„åˆ™\">#</a> è§„åˆ™</h1>\n<p>A. å£°æ˜å…ˆä»åå­—å¼€å§‹è¯»å–ï¼Œç„¶åæŒ‰ç…§ä¼˜å…ˆçº§é¡ºåºä¾æ¬¡è¯»å–.<br />\nB. ä¼˜å…ˆçº§ä»é«˜åˆ°ä½:</p>\n<ol>\n<li>å£°æ˜ä¸­è¢«æ‹¬å·æ‹¬èµ·æ¥çš„éƒ¨åˆ†</li>\n<li>åç¼€æ“ä½œç¬¦:\n<ul>\n<li><code>fun()</code>  ä¸­çš„ <code>()</code>  ä»£è¡¨æ˜¯ä¸€ä¸ªå‡½æ•°ï¼›</li>\n<li><code>arr[]</code>  çš„ <code>[]</code>  è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªæ•°ç»„</li>\n</ul>\n</li>\n<li>å‰ç¼€:  <code>*ptr</code>  è¡¨ç¤º &quot;æŒ‡å‘ xx çš„æŒ‡é’ˆ&quot;</li>\n</ol>\n<p>C. å¦‚æœä½¿ç”¨  <code>const</code>  æˆ– <code>volatile</code> , ç´§è·Ÿç±»å‹è¯´æ˜ç¬¦ï¼Œåˆ™ä½œç”¨äºç±»å‹è¯´æ˜ç¬¦å·ï¼›å…¶ä»–æƒ…å†µä¸‹ä½œç”¨äºå·¦è¾¹ç´§é‚»çš„  <code>*</code>  å·</p>\n<h1 id=\"ä¾‹å­\"><a class=\"anchor\" href=\"#ä¾‹å­\">#</a> ä¾‹å­</h1>\n<p>ä¸¾ä¸ªä¾‹å­  <code>char * const *(*next)();</code> <br />\n é€‚ç”¨è§„åˆ™:</p>\n<ol>\n<li>A: å˜é‡åä½  <code>next</code> , ä¸”è¢« <code>()</code>  è¿ç®—ç¬¦åŒ…å«</li>\n<li>B1: å˜é‡åè¢«  <code>()</code>  æ‹¬å·å†…éƒ¨æ˜¯  <code>(*arr)</code>  ä»£è¡¨å…¶æ˜¯æŒ‡é’ˆ</li>\n<li>B: åœ¨  <code>*</code>  å’Œ  <code>()</code>  ä¹‹é—´å†³å®š</li>\n<li>B2: B2 è§„åˆ™å‘Šè¯‰æˆ‘ä»¬ä¼˜å…ˆçº§è¾ƒé«˜çš„æ˜¯ <code>()</code> , æ‰€ä»¥ å¾—å‡º <strong> <code>next</code>  å’Œ <code>()</code>  å…ˆç»“åˆæ˜¯ä¸€ä¸ªæŒ‡å‘å‡½æ•°çš„æŒ‡é’ˆ</strong>ï¼Œæ‰€ä»¥å¾—å‡º &quot;next æ˜¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆï¼ŒæŒ‡å‘è¿”å›... çš„å‡½æ•°&quot;</li>\n<li>B3: å¤„ç†  <code>*</code> , å¾—å‡ºæŒ‡é’ˆå†…å®¹</li>\n<li>C:  <code>char * const</code> ,  <code>const</code>  å³è¾¹æ²¡æœ‰è·Ÿéšç±»å‹ç¬¦ï¼Œæ‰€ä»¥è§£é‡Šä¸º &quot;æŒ‡å‘å­—ç¬¦ä¸²çš„å¸¸é‡æŒ‡é’ˆ&quot;, æŒ‡é’ˆä¸å¯æ”¹å˜</li>\n</ol>\n<p>ç»¼ä¸Šï¼Œnext æ˜¯ &quot;ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°çš„è¿”å›ä¸€ä¸ªæŒ‡é’ˆï¼Œè¿”å›çš„æŒ‡é’ˆä¸ºä¸€ä¸ªæŒ‡å‘ char å‹æ•°æ®ç±»å‹çš„å¸¸é‡æŒ‡é’ˆ&quot;<br />\n ä¸‹å›¾æ˜¯ C è¯­è¨€å‡½æ•°å®šä¹‰çš„è§„åˆ™å›¾è§£<br />\n<img data-src=\"https://cdn.staticaly.com/gh/to-ywz/Image-Hosting@master/before2022/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20211017124630.jpg\" alt=\"å›¾ç¤º_æºäºCè¯­è¨€ä¸“å®¶ç¼–ç¨‹\" /></p>\n<h1 id=\"è¡¨æ ¼åŒ–\"><a class=\"anchor\" href=\"#è¡¨æ ¼åŒ–\">#</a> è¡¨æ ¼åŒ–</h1>\n<p>ä¸Šé¢çš„æ–¹å¼åªèƒ½è¯´æ˜¯é€»è¾‘åŒ–ï¼Œçœ‹ä¸Šå»è¿˜æ˜¯ä¸å¤Ÿæ¸…æ™°ã€‚æˆ‘æ‰“ç®—æŒ‰ç€ç¼–è¯‘åŸç†çš„è§’åº¦ç»“åˆä¸Šé¢å›¾æ¥åˆ—ä¸€ä¸ªè¡¨æ ¼ï¼ŒæŒ‰ç€ä¸Šé¢çš„è§„åˆ™ï¼Œå°±åˆ—ä¸€ä¸ªè¡¨å°±å¯ä»¥æ¨æ–­å‡ºç»“æœ.</p>\n<table>\n<thead>\n<tr>\n<th>å£°æ˜å­—ç¬¦ä¸²</th>\n<th style=\"text-align:center\">é‡‡å–çš„æ­¥éª¤</th>\n<th>ç»“æœ</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>char * const *(*<strong>next</strong>)();</td>\n<td style=\"text-align:center\">1</td>\n<td>è¡¨ç¤º  <code>nextæ˜¯...</code></td>\n</tr>\n<tr>\n<td>char * const *(*        )();</td>\n<td style=\"text-align:center\">2,3</td>\n<td>ä¸åŒ¹é…ï¼Œè½¬åˆ°ä¸‹ä¸€æ­¥ã€‚è¡¨ç¤º  <code>nextæ˜¯...</code></td>\n</tr>\n<tr>\n<td>char * const *(*        )();</td>\n<td style=\"text-align:center\">4</td>\n<td>ä¸åŒ¹é…ï¼Œè½¬åˆ°ä¸‹ä¸€æ­¥.</td>\n</tr>\n<tr>\n<td>char * const *(*        )();</td>\n<td style=\"text-align:center\">5</td>\n<td>ä¸ * å·åŒ¹é…ã€‚è¡¨ç¤º  <code>æŒ‡å‘...çš„æŒ‡é’ˆ</code></td>\n</tr>\n<tr>\n<td>char * const *<strong>(     )</strong>();</td>\n<td style=\"text-align:center\">4</td>\n<td>&quot;(&quot; &quot;)&quot; åŒ¹é…ï¼Œè½¬åˆ°ç¬¬ 2 æ­¥</td>\n</tr>\n<tr>\n<td>char * const *        <strong>()</strong>;</td>\n<td style=\"text-align:center\">2</td>\n<td>ä¸åŒ¹é…ï¼Œè½¬åˆ°ä¸‹ä¸€æ­¥</td>\n</tr>\n<tr>\n<td>char * const *        <strong>()</strong>;</td>\n<td style=\"text-align:center\">3</td>\n<td>è¡¨ç¤º  <code>è¿”å›...çš„å‡½æ•°</code></td>\n</tr>\n<tr>\n<td>char * const *              ;</td>\n<td style=\"text-align:center\">4</td>\n<td>ä¸åŒ¹é…ï¼Œè½¬åˆ°ä¸‹ä¸€æ­¥</td>\n</tr>\n<tr>\n<td>char * const *              ;</td>\n<td style=\"text-align:center\">5</td>\n<td>è¡¨ç¤º <code>æŒ‡å‘..çš„æŒ‡é’ˆ</code></td>\n</tr>\n<tr>\n<td>char * <strong>const</strong>            ;</td>\n<td style=\"text-align:center\">5</td>\n<td>è¡¨ç¤º <code>åªè¯»çš„...</code></td>\n</tr>\n<tr>\n<td>char *                      ;</td>\n<td style=\"text-align:center\">5</td>\n<td>è¡¨ç¤º <code>æŒ‡å‘...çš„æŒ‡é’ˆ</code></td>\n</tr>\n<tr>\n<td>char                        ;</td>\n<td style=\"text-align:center\">6</td>\n<td>è¡¨ç¤º <code>char</code></td>\n</tr>\n</tbody>\n</table>\n<hr />\n<p>å¤§é“äº”åï¼Œå¤©è¡å››åä¹ï¼Œäººéå…¶ä¸€ï¼</p>\n",
            "tags": [
                "è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯",
                "Cè¯­è¨€",
                "å£°æ˜,å­¦ä¹ ç¬”è®°"
            ]
        }
    ]
}